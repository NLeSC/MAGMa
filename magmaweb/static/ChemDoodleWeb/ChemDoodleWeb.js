//
// ChemDoodle Web Components 4.5.0
//
// http://web.chemdoodle.com
//
// Copyright 2009 iChemLabs, LLC.  All rights reserved.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// As a special exception to the GPL, any HTML file in a public website
// or any free web service which merely makes function calls to this
// code, and for that purpose includes it by reference, shall be deemed
// a separate work for copyright law purposes. If you modify this code,
// you may extend this exception to your version of the code, but you
// are not obligated to do so. If you do not wish to do so, delete this
// exception statement from your version.
//
// As an additional exception to the GPL, you may distribute this
// packed form of the code without the copy of the GPL license normally
// required, provided you include this license notice and a URL through
// which recipients can access the corresponding unpacked source code.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact> for
// alternate licensing options.
//
var ChemDoodle=function(){var b={};b.structures={};b.iChemLabs={};b.informatics={};b.io={};b.getVersion=function(){return"4.5.0"};return b}();
(function(b,a,l,g,h){a.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/ICL_servlets/WebHQ1";a.inRelay=false;a.asynchronous=true;a.INFO={userAgent:navigator.userAgent,v_cwc:b.getVersion(),v_jQuery:h.version,v_jQuery_ui:h.ui?h.ui.version:"N/A"};a.contactServer=function(d,j,c,f){if(this.inRelay)alert("Already connecting to the server, please wait for the first request to finish.");else{a.inRelay=true;h.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:d,content:j,info:a.INFO}),url:this.SERVER_URL,
success:function(e){a.inRelay=false;o=JSON.parse(e);o.message&&alert(o.message);c!=null&&o.content&&!o.stop&&c(o.content);o.stop&&f!=null&&f()},error:function(){a.inRelay=false;alert("Server connectivity failed. Please try again or update this browser to the latest version. (XHR2 not supported)");f!=null&&f()},beforeSend:function(e){e.withCredentials=true},async:a.asynchronous})}};a.optimize=function(d,j,c,f){this.contactServer("optimize",{mol:l.toJSONDummy(d),dimension:j},function(e){e=l.fromJSONDummy(e.mol);
if(j==2){for(var k=0,m=e.atoms.length;k<m;k++){d.atoms[k].x=e.atoms[k].x;d.atoms[k].y=e.atoms[k].y}c()}else if(j==3){k=0;for(m=e.atoms.length;k<m;k++){e.atoms[k].x/=20;e.atoms[k].y/=20;e.atoms[k].z/=20}c(e)}},f)};a.readSMILES=function(d,j,c){this.contactServer("readSMILES",{smiles:d},function(f){j(l.fromJSONDummy(f.mol))},c)};a.writeSMILES=function(d,j,c){this.contactServer("writeSMILES",{mol:l.toJSONDummy(d)},function(f){j(f.smiles)},c)};a.saveFile=function(d,j,c,f){this.contactServer("saveFile",
{mol:l.toJSONDummy(d),ext:j},function(e){c(e.link)},f)};a.getMoleculeFromDatabase=function(d,j,c,f,e){this.contactServer("getMoleculeFromDatabase",{database:d,dimension:f?f:2,query:j},function(k){if(f==3)for(var m=0,q=k.mol.a.length;m<q;m++){k.mol.a[m].x/=20;k.mol.a[m].y/=-20;k.mol.a[m].z/=20}c(l.fromJSONDummy(k.mol))},e)};a.getMoleculeFromContent=function(d,j,c,f){this.contactServer("getMoleculeFromContent",{content:d,format:j},function(e){for(var k=false,m=0,q=e.mol.a.length;m<q;m++)if(e.mol.a[m].z!=
0){k=true;break}if(k){m=0;for(q=e.mol.a.length;m<q;m++){e.mol.a[m].x/=20;e.mol.a[m].y/=20;e.mol.a[m].z/=20}}c(ChemDoodle.io.fromJSONDummy(e.mol))},f)};a.calculate=function(d,j,c,f){this.contactServer("calculate",{mol:l.toJSONDummy(d),descriptors:j},function(e){c(e)},f)};a.simulate1HNMR=function(d,j,c){this.contactServer("simulateNMR",{mol:l.toJSONDummy(d),nucleus:"H",isotope:1},function(f){j(b.readJCAMP(f.jcamp))},c)};a.simulate13CNMR=function(d,j,c){this.contactServer("simulateNMR",{mol:l.toJSONDummy(d),
nucleus:"C",isotope:13},function(f){j(b.readJCAMP(f.jcamp))},c)};a.simulateMassParentPeak=function(d,j,c){this.contactServer("simulateMassParentPeak",{mol:l.toJSONDummy(d)},function(f){j(b.readJCAMP(f.jcamp))},c)};a.getOptimizedPDBStructure=function(d,j,c,f){this.contactServer("getOptimizedPDBStructure",{id:d,withAtoms:j},function(e){var k=null;k=e.mol?l.fromJSONDummy(e.mol):new g.Molecule;k.chains=l.fromJSONChains(e.ribbons);k.fromJSON=true;c(k)},f)};a.getAd=function(d,j){this.contactServer("getAd",
{},function(c){d(c.image_url,c.target_url)},j)};a.kekulize=function(d,j,c){this.contactServer("kekulize",{mol:l.toJSONDummy(d)},function(f){j(l.fromJSONDummy(f.mol))},c)};a.isGraphIsomorphism=function(d,j,c,f){this.contactServer("isGraphIsomorphism",{arrow:l.toJSONDummy(d),target:l.toJSONDummy(j)},function(e){c(e.value)},f)};a.isSubgraphIsomorphism=function(d,j,c,f){this.contactServer("isSubgraphIsomorphism",{arrow:l.toJSONDummy(d),target:l.toJSONDummy(j)},function(e){c(e.value)},f)};a.readIUPACName=
function(d,j,c){this.contactServer("readIUPACName",{iupac:d},function(f){j(l.fromJSONDummy(f.mol))},c)};a.generateImage=function(d,j,c,f){this.contactServer("generateImage",{mol:l.toJSONDummy(d),ext:j},function(e){c(e.link)},f)};a.getZeoliteFromIZA=function(d,j,c,f,e,k){this.contactServer("getZeoliteFromIZA",{query:d},function(m){j(ChemDoodle.readCIF(m.cif,c,f,e))},k)}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery);
ChemDoodle.extensions=function(b,a,l){var g={};g.stringStartsWith=function(h,d){return h.match("^"+d)==d};g.vec3AngleFrom=function(h,d){var j=a.length(h),c=a.length(d);j=a.dot(h,d)/j/c;return l.acos(j)};g.contextHashTo=function(h,d,j,c,f,e,k){var m=0,q=(new b.Point(d,j)).distance(new b.Point(c,f)),p=false,n=d,t=j;d=c-d;for(j=f-j;m<q;){if(p)if(m+k>q){h.moveTo(c,f);break}else{var v=k/q;n+=v*d;t+=v*j;h.moveTo(n,t);m+=k}else if(m+e>q){h.lineTo(c,f);break}else{v=e/q;n+=v*d;t+=v*j;h.lineTo(n,t);m+=e}p=
!p}};g.contextRoundRect=function(h,d,j,c,f,e){h.beginPath();h.moveTo(d+e,j);h.lineTo(d+c-e,j);h.quadraticCurveTo(d+c,j,d+c,j+e);h.lineTo(d+c,j+f-e);h.quadraticCurveTo(d+c,j+f,d+c-e,j+f);h.lineTo(d+e,j+f);h.quadraticCurveTo(d,j+f,d,j+f-e);h.lineTo(d,j+e);h.quadraticCurveTo(d,j,d+e,j);h.closePath()};g.contextEllipse=function(h,d,j,c,f){var e=c/2*0.5522848,k=f/2*0.5522848,m=d+c,q=j+f;c=d+c/2;f=j+f/2;h.beginPath();h.moveTo(d,f);h.bezierCurveTo(d,f-k,c-e,j,c,j);h.bezierCurveTo(c+e,j,m,f-k,m,f);h.bezierCurveTo(m,
f+k,c+e,q,c,q);h.bezierCurveTo(c-e,q,d,f+k,d,f);h.closePath()};return g}(ChemDoodle.structures,vec3,Math);
ChemDoodle.math=function(b,a,l){var g={},h={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};g.angleBetweenLargest=function(d){if(d.length==0)return 0;if(d.length==1)return d[0]+l.PI;for(var j=0,c=0,f=0,e=d.length-1;f<e;f++){var k=d[f+1]-d[f];if(k>j){j=k;c=(d[f+1]+d[f])/2}}f=d[0]+l.PI*
2-d[d.length-1];if(f>j){c=d[0]-f/2;if(c<0)c+=l.PI*2}return c};g.isBetween=function(d,j,c){return d>=j&&d<=c};g.getRGB=function(d,j){var c=[0,0,0];if(h[d.toLowerCase()]!=null)d=h[d.toLowerCase()];if(d.charAt(0)=="#"){if(d.length==4)d="#"+d.charAt(1)+d.charAt(1)+d.charAt(2)+d.charAt(2)+d.charAt(3)+d.charAt(3);return[parseInt(d.substring(1,3),16)/255*j,parseInt(d.substring(3,5),16)/255*j,parseInt(d.substring(5,7),16)/255*j]}else if(b.stringStartsWith(d,"rgb")){var f=d.replace(/rgb\(|\)/g,"").split(",");
if(f.length!=3)return c;return[parseInt(f[0])/255*j,parseInt(f[1])/255*j,parseInt(f[2])/255*j]}return c};g.distanceFromPointToLineInclusive=function(d,j,c){var f=j.distance(c);c=j.angle(c);c=l.PI/2-c;new a.Point(d.x-j.x,d.y-j.x);new a.Point;c=j.angle(d)+c;d=j.distance(d);pcopRot=new a.Point(d*l.cos(c),-d*l.sin(c));if(g.isBetween(-pcopRot.y,0,f))return l.abs(pcopRot.x);return-1};g.hsl2rgb=function(d,j,c){if(j==0)c=j=d=c;else{var f=function(m,q,p){if(p<0)p+=1;if(p>1)p-=1;if(p<1/6)return m+(q-m)*6*p;
if(p<0.5)return q;if(p<2/3)return m+(q-m)*(2/3-p)*6;return m},e=c<0.5?c*(1+j):c+j-c*j,k=2*c-e;c=f(k,e,d+1/3);j=f(k,e,d);d=f(k,e,d-1/3)}return[c*255,j*255,d*255]};return g}(ChemDoodle.extensions,ChemDoodle.structures,Math);
ChemDoodle.featureDetection=function(b,a,l,g){var h={};h.supports_canvas=function(){return!!l.createElement("canvas").getContext};h.supports_canvas_text=function(){if(!h.supports_canvas())return false;return typeof l.createElement("canvas").getContext("2d").fillText=="function"};h.supports_webgl=function(){var d=l.createElement("canvas");try{if(d.getContext("webgl"))return true;if(d.getContext("experimental-webgl"))return true}catch(j){}return false};h.supports_xhr2=function(){return a.support.cors};
h.supports_touch=function(){return"ontouchstart"in g};h.supports_gesture=function(){return"ongesturestart"in g};return h}(ChemDoodle.iChemLabs,jQuery,document,window);
ChemDoodle.ELEMENT=function(){function b(l,g,h){this.symbol=l;this.name=g;this.atomicNumber=h;return true}var a=[];a.H=new b("H","Hydrogen",1);a.He=new b("He","Helium",2);a.Li=new b("Li","Lithium",3);a.Be=new b("Be","Beryllium",4);a.B=new b("B","Boron",5);a.C=new b("C","Carbon",6);a.N=new b("N","Nitrogen",7);a.O=new b("O","Oxygen",8);a.F=new b("F","Fluorine",9);a.Ne=new b("Ne","Neon",10);a.Na=new b("Na","Sodium",11);a.Mg=new b("Mg","Magnesium",12);a.Al=new b("Al","Aluminum",13);a.Si=new b("Si","Silicon",
14);a.P=new b("P","Phosphorus",15);a.S=new b("S","Sulfur",16);a.Cl=new b("Cl","Chlorine",17);a.Ar=new b("Ar","Argon",18);a.K=new b("K","Potassium",19);a.Ca=new b("Ca","Calcium",20);a.Sc=new b("Sc","Scandium",21);a.Ti=new b("Ti","Titanium",22);a.V=new b("V","Vanadium",23);a.Cr=new b("Cr","Chromium",24);a.Mn=new b("Mn","Manganese",25);a.Fe=new b("Fe","Iron",26);a.Co=new b("Co","Cobalt",27);a.Ni=new b("Ni","Nickel",28);a.Cu=new b("Cu","Copper",29);a.Zn=new b("Zn","Zinc",30);a.Ga=new b("Ga","Gallium",
31);a.Ge=new b("Ge","Germanium",32);a.As=new b("As","Arsenic",33);a.Se=new b("Se","Selenium",34);a.Br=new b("Br","Bromine",35);a.Kr=new b("Kr","Krypton",36);a.Rb=new b("Rb","Rubidium",37);a.Sr=new b("Sr","Strontium",38);a.Y=new b("Y","Yttrium",39);a.Zr=new b("Zr","Zirconium",40);a.Nb=new b("Nb","Niobium",41);a.Mo=new b("Mo","Molybdenum",42);a.Tc=new b("Tc","Technetium",43);a.Ru=new b("Ru","Ruthenium",44);a.Rh=new b("Rh","Rhodium",45);a.Pd=new b("Pd","Palladium",46);a.Ag=new b("Ag","Silver",47);a.Cd=
new b("Cd","Cadmium",48);a.In=new b("In","Indium",49);a.Sn=new b("Sn","Tin",50);a.Sb=new b("Sb","Antimony",51);a.Te=new b("Te","Tellurium",52);a.I=new b("I","Iodine",53);a.Xe=new b("Xe","Xenon",54);a.Cs=new b("Cs","Cesium",55);a.Ba=new b("Ba","Barium",56);a.La=new b("La","Lanthanum",57);a.Ce=new b("Ce","Cerium",58);a.Pr=new b("Pr","Praseodymium",59);a.Nd=new b("Nd","Neodymium",60);a.Pm=new b("Pm","Promethium",61);a.Sm=new b("Sm","Samarium",62);a.Eu=new b("Eu","Europium",63);a.Gd=new b("Gd","Gadolinium",
64);a.Tb=new b("Tb","Terbium",65);a.Dy=new b("Dy","Dysprosium",66);a.Ho=new b("Ho","Holmium",67);a.Er=new b("Er","Erbium",68);a.Tm=new b("Tm","Thulium",69);a.Yb=new b("Yb","Ytterbium",70);a.Lu=new b("Lu","Lutetium",71);a.Hf=new b("Hf","Hafnium",72);a.Ta=new b("Ta","Tantalum",73);a.W=new b("W","Tungsten",74);a.Re=new b("Re","Rhenium",75);a.Os=new b("Os","Osmium",76);a.Ir=new b("Ir","Iridium",77);a.Pt=new b("Pt","Platinum",78);a.Au=new b("Au","Gold",79);a.Hg=new b("Hg","Mercury",80);a.Tl=new b("Tl",
"Thallium",81);a.Pb=new b("Pb","Lead",82);a.Bi=new b("Bi","Bismuth",83);a.Po=new b("Po","Polonium",84);a.At=new b("At","Astatine",85);a.Rn=new b("Rn","Radon",86);a.Fr=new b("Fr","Francium",87);a.Ra=new b("Ra","Radium",88);a.Ac=new b("Ac","Actinium",89);a.Th=new b("Th","Thorium",90);a.Pa=new b("Pa","Protactinium",91);a.U=new b("U","Uranium",92);a.Np=new b("Np","Neptunium",93);a.Pu=new b("Pu","Plutonium",94);a.Am=new b("Am","Americium",95);a.Cm=new b("Cm","Curium",96);a.Bk=new b("Bk","Berkelium",97);
a.Cf=new b("Cf","Californium",98);a.Es=new b("Es","Einsteinium",99);a.Fm=new b("Fm","Fermium",100);a.Md=new b("Md","Mendelevium",101);a.No=new b("No","Nobelium",102);a.Lr=new b("Lr","Lawrencium",103);a.Rf=new b("Rf","Rutherfordium",104);a.Db=new b("Db","Dubnium",105);a.Sg=new b("Sg","Seaborgium",106);a.Bh=new b("Bh","Bohrium",107);a.Hs=new b("Hs","Hassium",108);a.Mt=new b("Mt","Meitnerium",109);a.Ds=new b("Ds","Darmstadtium",110);a.Rg=new b("Rg","Roentgenium",111);a.Cn=new b("Cn","Copernicium",112);
a.Uut=new b("Uut","Ununtrium",113);a.Uuq=new b("Uuq","Ununquadium",114);a.Uup=new b("Uup","Ununpentium",115);a.Uuh=new b("Uuh","Ununhexium",116);a.Uus=new b("Uus","Ununseptium",117);a.Uuo=new b("Uuo","Ununoctium",118);a.H.jmolColor="#FFFFFF";a.He.jmolColor="#D9FFFF";a.Li.jmolColor="#CC80FF";a.Be.jmolColor="#C2FF00";a.B.jmolColor="#FFB5B5";a.C.jmolColor="#909090";a.N.jmolColor="#3050F8";a.O.jmolColor="#FF0D0D";a.F.jmolColor="#90E050";a.Ne.jmolColor="#B3E3F5";a.Na.jmolColor="#AB5CF2";a.Mg.jmolColor=
"#8AFF00";a.Al.jmolColor="#BFA6A6";a.Si.jmolColor="#F0C8A0";a.P.jmolColor="#FF8000";a.S.jmolColor="#FFFF30";a.Cl.jmolColor="#1FF01F";a.Ar.jmolColor="#80D1E3";a.K.jmolColor="#8F40D4";a.Ca.jmolColor="#3DFF00";a.Sc.jmolColor="#E6E6E6";a.Ti.jmolColor="#BFC2C7";a.V.jmolColor="#A6A6AB";a.Cr.jmolColor="#8A99C7";a.Mn.jmolColor="#9C7AC7";a.Fe.jmolColor="#E06633";a.Co.jmolColor="#F090A0";a.Ni.jmolColor="#50D050";a.Cu.jmolColor="#C88033";a.Zn.jmolColor="#7D80B0";a.Ga.jmolColor="#C28F8F";a.Ge.jmolColor="#668F8F";
a.As.jmolColor="#BD80E3";a.Se.jmolColor="#FFA100";a.Br.jmolColor="#A62929";a.Kr.jmolColor="#5CB8D1";a.Rb.jmolColor="#702EB0";a.Sr.jmolColor="#00FF00";a.Y.jmolColor="#94FFFF";a.Zr.jmolColor="#94E0E0";a.Nb.jmolColor="#73C2C9";a.Mo.jmolColor="#54B5B5";a.Tc.jmolColor="#3B9E9E";a.Ru.jmolColor="#248F8F";a.Rh.jmolColor="#0A7D8C";a.Pd.jmolColor="#006985";a.Ag.jmolColor="#C0C0C0";a.Cd.jmolColor="#FFD98F";a.In.jmolColor="#A67573";a.Sn.jmolColor="#668080";a.Sb.jmolColor="#9E63B5";a.Te.jmolColor="#D47A00";a.I.jmolColor=
"#940094";a.Xe.jmolColor="#429EB0";a.Cs.jmolColor="#57178F";a.Ba.jmolColor="#00C900";a.La.jmolColor="#70D4FF";a.Ce.jmolColor="#FFFFC7";a.Pr.jmolColor="#D9FFC7";a.Nd.jmolColor="#C7FFC7";a.Pm.jmolColor="#A3FFC7";a.Sm.jmolColor="#8FFFC7";a.Eu.jmolColor="#61FFC7";a.Gd.jmolColor="#45FFC7";a.Tb.jmolColor="#30FFC7";a.Dy.jmolColor="#1FFFC7";a.Ho.jmolColor="#00FF9C";a.Er.jmolColor="#00E675";a.Tm.jmolColor="#00D452";a.Yb.jmolColor="#00BF38";a.Lu.jmolColor="#00AB24";a.Hf.jmolColor="#4DC2FF";a.Ta.jmolColor="#4DA6FF";
a.W.jmolColor="#2194D6";a.Re.jmolColor="#267DAB";a.Os.jmolColor="#266696";a.Ir.jmolColor="#175487";a.Pt.jmolColor="#D0D0E0";a.Au.jmolColor="#FFD123";a.Hg.jmolColor="#B8B8D0";a.Tl.jmolColor="#A6544D";a.Pb.jmolColor="#575961";a.Bi.jmolColor="#9E4FB5";a.Po.jmolColor="#AB5C00";a.At.jmolColor="#754F45";a.Rn.jmolColor="#428296";a.Fr.jmolColor="#420066";a.Ra.jmolColor="#007D00";a.Ac.jmolColor="#70ABFA";a.Th.jmolColor="#00BAFF";a.Pa.jmolColor="#00A1FF";a.U.jmolColor="#008FFF";a.Np.jmolColor="#0080FF";a.Pu.jmolColor=
"#006BFF";a.Am.jmolColor="#545CF2";a.Cm.jmolColor="#785CE3";a.Bk.jmolColor="#8A4FE3";a.Cf.jmolColor="#A136D4";a.Es.jmolColor="#B31FD4";a.Fm.jmolColor="#B31FBA";a.Md.jmolColor="#B30DA6";a.No.jmolColor="#BD0D87";a.Lr.jmolColor="#C70066";a.Rf.jmolColor="#CC0059";a.Db.jmolColor="#D1004F";a.Sg.jmolColor="#D90045";a.Bh.jmolColor="#E00038";a.Hs.jmolColor="#E6002E";a.Mt.jmolColor="#EB0026";a.Ds.jmolColor="#000000";a.Rg.jmolColor="#000000";a.Cn.jmolColor="#000000";a.Uut.jmolColor="#000000";a.Uuq.jmolColor=
"#000000";a.Uup.jmolColor="#000000";a.Uuh.jmolColor="#000000";a.Uus.jmolColor="#000000";a.Uuo.jmolColor="#000000";a.H.covalentRadius=0.31;a.He.covalentRadius=0.28;a.Li.covalentRadius=1.28;a.Be.covalentRadius=0.96;a.B.covalentRadius=0.84;a.C.covalentRadius=0.76;a.N.covalentRadius=0.71;a.O.covalentRadius=0.66;a.F.covalentRadius=0.57;a.Ne.covalentRadius=0.58;a.Na.covalentRadius=1.66;a.Mg.covalentRadius=1.41;a.Al.covalentRadius=1.21;a.Si.covalentRadius=1.11;a.P.covalentRadius=1.07;a.S.covalentRadius=
1.05;a.Cl.covalentRadius=1.02;a.Ar.covalentRadius=1.06;a.K.covalentRadius=2.03;a.Ca.covalentRadius=1.76;a.Sc.covalentRadius=1.7;a.Ti.covalentRadius=1.6;a.V.covalentRadius=1.53;a.Cr.covalentRadius=1.39;a.Mn.covalentRadius=1.39;a.Fe.covalentRadius=1.32;a.Co.covalentRadius=1.26;a.Ni.covalentRadius=1.24;a.Cu.covalentRadius=1.32;a.Zn.covalentRadius=1.22;a.Ga.covalentRadius=1.22;a.Ge.covalentRadius=1.2;a.As.covalentRadius=1.19;a.Se.covalentRadius=1.2;a.Br.covalentRadius=1.2;a.Kr.covalentRadius=1.16;a.Rb.covalentRadius=
2.2;a.Sr.covalentRadius=1.95;a.Y.covalentRadius=1.9;a.Zr.covalentRadius=1.75;a.Nb.covalentRadius=1.64;a.Mo.covalentRadius=1.54;a.Tc.covalentRadius=1.47;a.Ru.covalentRadius=1.46;a.Rh.covalentRadius=1.42;a.Pd.covalentRadius=1.39;a.Ag.covalentRadius=1.45;a.Cd.covalentRadius=1.44;a.In.covalentRadius=1.42;a.Sn.covalentRadius=1.39;a.Sb.covalentRadius=1.39;a.Te.covalentRadius=1.38;a.I.covalentRadius=1.39;a.Xe.covalentRadius=1.4;a.Cs.covalentRadius=2.44;a.Ba.covalentRadius=2.15;a.La.covalentRadius=2.07;a.Ce.covalentRadius=
2.04;a.Pr.covalentRadius=2.03;a.Nd.covalentRadius=2.01;a.Pm.covalentRadius=1.99;a.Sm.covalentRadius=1.98;a.Eu.covalentRadius=1.98;a.Gd.covalentRadius=1.96;a.Tb.covalentRadius=1.94;a.Dy.covalentRadius=1.92;a.Ho.covalentRadius=1.92;a.Er.covalentRadius=1.89;a.Tm.covalentRadius=1.9;a.Yb.covalentRadius=1.87;a.Lu.covalentRadius=1.87;a.Hf.covalentRadius=1.75;a.Ta.covalentRadius=1.7;a.W.covalentRadius=1.62;a.Re.covalentRadius=1.51;a.Os.covalentRadius=1.44;a.Ir.covalentRadius=1.41;a.Pt.covalentRadius=1.36;
a.Au.covalentRadius=1.36;a.Hg.covalentRadius=1.32;a.Tl.covalentRadius=1.45;a.Pb.covalentRadius=1.46;a.Bi.covalentRadius=1.48;a.Po.covalentRadius=1.4;a.At.covalentRadius=1.5;a.Rn.covalentRadius=1.5;a.Fr.covalentRadius=2.6;a.Ra.covalentRadius=2.21;a.Ac.covalentRadius=2.15;a.Th.covalentRadius=2.06;a.Pa.covalentRadius=2;a.U.covalentRadius=1.96;a.Np.covalentRadius=1.9;a.Pu.covalentRadius=1.87;a.Am.covalentRadius=1.8;a.Cm.covalentRadius=1.69;a.Bk.covalentRadius=0;a.Cf.covalentRadius=0;a.Es.covalentRadius=
0;a.Fm.covalentRadius=0;a.Md.covalentRadius=0;a.No.covalentRadius=0;a.Lr.covalentRadius=0;a.Rf.covalentRadius=0;a.Db.covalentRadius=0;a.Sg.covalentRadius=0;a.Bh.covalentRadius=0;a.Hs.covalentRadius=0;a.Mt.covalentRadius=0;a.Ds.covalentRadius=0;a.Rg.covalentRadius=0;a.Cn.covalentRadius=0;a.Uut.covalentRadius=0;a.Uuq.covalentRadius=0;a.Uup.covalentRadius=0;a.Uuh.covalentRadius=0;a.Uus.covalentRadius=0;a.Uuo.covalentRadius=0;a.H.vdWRadius=1.2;a.He.vdWRadius=1.4;a.Li.vdWRadius=1.82;a.Be.vdWRadius=0;a.B.vdWRadius=
0;a.C.vdWRadius=1.7;a.N.vdWRadius=1.55;a.O.vdWRadius=1.52;a.F.vdWRadius=1.47;a.Ne.vdWRadius=1.54;a.Na.vdWRadius=2.27;a.Mg.vdWRadius=1.73;a.Al.vdWRadius=0;a.Si.vdWRadius=2.1;a.P.vdWRadius=1.8;a.S.vdWRadius=1.8;a.Cl.vdWRadius=1.75;a.Ar.vdWRadius=1.88;a.K.vdWRadius=2.75;a.Ca.vdWRadius=0;a.Sc.vdWRadius=0;a.Ti.vdWRadius=0;a.V.vdWRadius=0;a.Cr.vdWRadius=0;a.Mn.vdWRadius=0;a.Fe.vdWRadius=0;a.Co.vdWRadius=0;a.Ni.vdWRadius=1.63;a.Cu.vdWRadius=1.4;a.Zn.vdWRadius=1.39;a.Ga.vdWRadius=1.87;a.Ge.vdWRadius=0;a.As.vdWRadius=
1.85;a.Se.vdWRadius=1.9;a.Br.vdWRadius=1.85;a.Kr.vdWRadius=2.02;a.Rb.vdWRadius=0;a.Sr.vdWRadius=0;a.Y.vdWRadius=0;a.Zr.vdWRadius=0;a.Nb.vdWRadius=0;a.Mo.vdWRadius=0;a.Tc.vdWRadius=0;a.Ru.vdWRadius=0;a.Rh.vdWRadius=0;a.Pd.vdWRadius=1.63;a.Ag.vdWRadius=1.72;a.Cd.vdWRadius=1.58;a.In.vdWRadius=1.93;a.Sn.vdWRadius=2.17;a.Sb.vdWRadius=0;a.Te.vdWRadius=2.06;a.I.vdWRadius=1.98;a.Xe.vdWRadius=2.16;a.Cs.vdWRadius=0;a.Ba.vdWRadius=0;a.La.vdWRadius=0;a.Ce.vdWRadius=0;a.Pr.vdWRadius=0;a.Nd.vdWRadius=0;a.Pm.vdWRadius=
0;a.Sm.vdWRadius=0;a.Eu.vdWRadius=0;a.Gd.vdWRadius=0;a.Tb.vdWRadius=0;a.Dy.vdWRadius=0;a.Ho.vdWRadius=0;a.Er.vdWRadius=0;a.Tm.vdWRadius=0;a.Yb.vdWRadius=0;a.Lu.vdWRadius=0;a.Hf.vdWRadius=0;a.Ta.vdWRadius=0;a.W.vdWRadius=0;a.Re.vdWRadius=0;a.Os.vdWRadius=0;a.Ir.vdWRadius=0;a.Pt.vdWRadius=1.75;a.Au.vdWRadius=1.66;a.Hg.vdWRadius=1.55;a.Tl.vdWRadius=1.96;a.Pb.vdWRadius=2.02;a.Bi.vdWRadius=0;a.Po.vdWRadius=0;a.At.vdWRadius=0;a.Rn.vdWRadius=0;a.Fr.vdWRadius=0;a.Ra.vdWRadius=0;a.Ac.vdWRadius=0;a.Th.vdWRadius=
0;a.Pa.vdWRadius=0;a.U.vdWRadius=1.86;a.Np.vdWRadius=0;a.Pu.vdWRadius=0;a.Am.vdWRadius=0;a.Cm.vdWRadius=0;a.Bk.vdWRadius=0;a.Cf.vdWRadius=0;a.Es.vdWRadius=0;a.Fm.vdWRadius=0;a.Md.vdWRadius=0;a.No.vdWRadius=0;a.Lr.vdWRadius=0;a.Rf.vdWRadius=0;a.Db.vdWRadius=0;a.Sg.vdWRadius=0;a.Bh.vdWRadius=0;a.Hs.vdWRadius=0;a.Mt.vdWRadius=0;a.Ds.vdWRadius=0;a.Rg.vdWRadius=0;a.Cn.vdWRadius=0;a.Uut.vdWRadius=0;a.Uuq.vdWRadius=0;a.Uup.vdWRadius=0;a.Uuh.vdWRadius=0;a.Uus.vdWRadius=0;a.Uuo.vdWRadius=0;a.H.valency=1;a.He.valency=
0;a.Li.valency=1;a.Be.valency=2;a.B.valency=3;a.C.valency=4;a.N.valency=3;a.O.valency=2;a.F.valency=1;a.Ne.valency=0;a.Na.valency=1;a.Mg.valency=0;a.Al.valency=0;a.Si.valency=4;a.P.valency=3;a.S.valency=2;a.Cl.valency=1;a.Ar.valency=0;a.K.valency=0;a.Ca.valency=0;a.Sc.valency=0;a.Ti.valency=1;a.V.valency=1;a.Cr.valency=2;a.Mn.valency=3;a.Fe.valency=2;a.Co.valency=1;a.Ni.valency=1;a.Cu.valency=0;a.Zn.valency=0;a.Ga.valency=0;a.Ge.valency=4;a.As.valency=3;a.Se.valency=2;a.Br.valency=1;a.Kr.valency=
0;a.Rb.valency=0;a.Sr.valency=0;a.Y.valency=0;a.Zr.valency=0;a.Nb.valency=1;a.Mo.valency=2;a.Tc.valency=3;a.Ru.valency=2;a.Rh.valency=1;a.Pd.valency=0;a.Ag.valency=0;a.Cd.valency=0;a.In.valency=0;a.Sn.valency=4;a.Sb.valency=3;a.Te.valency=2;a.I.valency=1;a.Xe.valency=0;a.Cs.valency=0;a.Ba.valency=0;a.La.valency=0;a.Ce.valency=0;a.Pr.valency=0;a.Nd.valency=0;a.Pm.valency=0;a.Sm.valency=0;a.Eu.valency=0;a.Gd.valency=0;a.Tb.valency=0;a.Dy.valency=0;a.Ho.valency=0;a.Er.valency=0;a.Tm.valency=0;a.Yb.valency=
0;a.Lu.valency=0;a.Hf.valency=0;a.Ta.valency=1;a.W.valency=2;a.Re.valency=3;a.Os.valency=2;a.Ir.valency=3;a.Pt.valency=0;a.Au.valency=1;a.Hg.valency=0;a.Tl.valency=0;a.Pb.valency=4;a.Bi.valency=3;a.Po.valency=2;a.At.valency=1;a.Rn.valency=0;a.Fr.valency=0;a.Ra.valency=0;a.Ac.valency=0;a.Th.valency=0;a.Pa.valency=0;a.U.valency=0;a.Np.valency=0;a.Pu.valency=0;a.Am.valency=0;a.Cm.valency=0;a.Bk.valency=0;a.Cf.valency=0;a.Es.valency=0;a.Fm.valency=0;a.Md.valency=0;a.No.valency=0;a.Lr.valency=0;a.Rf.valency=
0;a.Db.valency=0;a.Sg.valency=0;a.Bh.valency=0;a.Hs.valency=0;a.Mt.valency=0;a.Ds.valency=0;a.Rg.valency=0;a.Cn.valency=0;a.Uut.valency=0;a.Uuq.valency=0;a.Uup.valency=0;a.Uuh.valency=0;a.Uus.valency=0;a.Uuo.valency=0;a.H.mass=1;a.He.mass=4;a.Li.mass=7;a.Be.mass=9;a.B.mass=11;a.C.mass=12;a.N.mass=14;a.O.mass=16;a.F.mass=19;a.Ne.mass=20;a.Na.mass=23;a.Mg.mass=24;a.Al.mass=27;a.Si.mass=28;a.P.mass=31;a.S.mass=32;a.Cl.mass=35;a.Ar.mass=40;a.K.mass=39;a.Ca.mass=40;a.Sc.mass=45;a.Ti.mass=48;a.V.mass=51;
a.Cr.mass=52;a.Mn.mass=55;a.Fe.mass=56;a.Co.mass=59;a.Ni.mass=58;a.Cu.mass=63;a.Zn.mass=64;a.Ga.mass=69;a.Ge.mass=74;a.As.mass=75;a.Se.mass=80;a.Br.mass=79;a.Kr.mass=84;a.Rb.mass=85;a.Sr.mass=88;a.Y.mass=89;a.Zr.mass=90;a.Nb.mass=93;a.Mo.mass=98;a.Tc.mass=0;a.Ru.mass=102;a.Rh.mass=103;a.Pd.mass=106;a.Ag.mass=107;a.Cd.mass=114;a.In.mass=115;a.Sn.mass=120;a.Sb.mass=121;a.Te.mass=130;a.I.mass=127;a.Xe.mass=132;a.Cs.mass=133;a.Ba.mass=138;a.La.mass=139;a.Ce.mass=140;a.Pr.mass=141;a.Nd.mass=142;a.Pm.mass=
0;a.Sm.mass=152;a.Eu.mass=153;a.Gd.mass=158;a.Tb.mass=159;a.Dy.mass=164;a.Ho.mass=165;a.Er.mass=166;a.Tm.mass=169;a.Yb.mass=174;a.Lu.mass=175;a.Hf.mass=180;a.Ta.mass=181;a.W.mass=184;a.Re.mass=187;a.Os.mass=192;a.Ir.mass=193;a.Pt.mass=195;a.Au.mass=197;a.Hg.mass=202;a.Tl.mass=205;a.Pb.mass=208;a.Bi.mass=209;a.Po.mass=0;a.At.mass=0;a.Rn.mass=0;a.Fr.mass=0;a.Ra.mass=0;a.Ac.mass=0;a.Th.mass=232;a.Pa.mass=231;a.U.mass=238;a.Np.mass=0;a.Pu.mass=0;a.Am.mass=0;a.Cm.mass=0;a.Bk.mass=0;a.Cf.mass=0;a.Es.mass=
0;a.Fm.mass=0;a.Md.mass=0;a.No.mass=0;a.Lr.mass=0;a.Rf.mass=0;a.Db.mass=0;a.Sg.mass=0;a.Bh.mass=0;a.Hs.mass=0;a.Mt.mass=0;a.Ds.mass=0;a.Rg.mass=0;a.Cn.mass=0;a.Uut.mass=0;a.Uuq.mass=0;a.Uup.mass=0;a.Uuh.mass=0;a.Uus.mass=0;a.Uuo.mass=0;return a}();
ChemDoodle.SYMBOLS=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es",
"Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Uut","Uuq","Uup","Uuh","Uus","Uuo"];
ChemDoodle.RESIDUE=function(){function b(l,g){this.symbol=l;this.name=g;return true}var a=[];a.Ala=new b("Ala","Alanine");a.Arg=new b("Arg","Arginine");a.Asn=new b("Asn","Asparagine");a.Asp=new b("Asp","Aspartic Acid");a.Cys=new b("Cys","Cysteine");a.Gln=new b("Gln","Glutamine");a.Glu=new b("Glu","Glutamic Acid");a.Gly=new b("Gly","Glycine");a.His=new b("His","Histidine");a.Ile=new b("Ile","Isoleucine");a.Leu=new b("Leu","Leucine");a.Lys=new b("Lys","Lysine");a.Met=new b("Met","Methionine");a.Phe=
new b("Phe","Phenylalanine");a.Pro=new b("Pro","Proline");a.Ser=new b("Ser","Serine");a.Thr=new b("Thr","Threonine");a.Trp=new b("Trp","Tryptophan");a.Tyr=new b("Tyr","Tyrosine");a.Val=new b("Val","Valine");a.Asx=new b("Asx","Asparagine/Aspartic Acid");a.Glx=new b("Glx","Glutamine/Glutamic Acid");a["*"]=new b("*","Other");a.A=new b("A","Adenine");a.G=new b("G","Guanine");a.I=new b("I","");a.C=new b("C","Cytosine");a.T=new b("T","Thymine");a.U=new b("U","Uracil");a.Ala.polar=false;a.Arg.polar=true;
a.Asn.polar=true;a.Asp.polar=true;a.Cys.polar=true;a.Gln.polar=true;a.Glu.polar=true;a.Gly.polar=false;a.His.polar=true;a.Ile.polar=false;a.Leu.polar=false;a.Lys.polar=true;a.Met.polar=false;a.Phe.polar=false;a.Pro.polar=false;a.Ser.polar=true;a.Thr.polar=true;a.Trp.polar=true;a.Tyr.polar=true;a.Val.polar=false;a.Asx.polar=true;a.Glx.polar=true;a.Ala.aminoColor="#C8C8C8";a.Arg.aminoColor="#145AFF";a.Asn.aminoColor="#00DCDC";a.Asp.aminoColor="#E60A0A";a.Cys.aminoColor="#E6E600";a.Gln.aminoColor="#00DCDC";
a.Glu.aminoColor="#E60A0A";a.Gly.aminoColor="#EBEBEB";a.His.aminoColor="#8282D2";a.Ile.aminoColor="#0F820F";a.Leu.aminoColor="#0F820F";a.Lys.aminoColor="#145AFF";a.Met.aminoColor="#E6E600";a.Phe.aminoColor="#3232AA";a.Pro.aminoColor="#DC9682";a.Ser.aminoColor="#FA9600";a.Thr.aminoColor="#FA9600";a.Trp.aminoColor="#B45AB4";a.Tyr.aminoColor="#3232AA";a.Val.aminoColor="#0F820F";a.Asx.aminoColor="#FF69B4";a.Glx.aminoColor="#FF69B4";a["*"].aminoColor="#BEA06E";a.A.aminoColor="#BEA06E";a.G.aminoColor="#BEA06E";
a.I.aminoColor="#BEA06E";a.C.aminoColor="#BEA06E";a.T.aminoColor="#BEA06E";a.U.aminoColor="#BEA06E";a.Ala.shapelyColor="#8CFF8C";a.Arg.shapelyColor="#00007C";a.Asn.shapelyColor="#FF7C70";a.Asp.shapelyColor="#A00042";a.Cys.shapelyColor="#FFFF70";a.Gln.shapelyColor="#FF4C4C";a.Glu.shapelyColor="#660000";a.Gly.shapelyColor="#FFFFFF";a.His.shapelyColor="#7070FF";a.Ile.shapelyColor="#004C00";a.Leu.shapelyColor="#455E45";a.Lys.shapelyColor="#4747B8";a.Met.shapelyColor="#B8A042";a.Phe.shapelyColor="#534C52";
a.Pro.shapelyColor="#525252";a.Ser.shapelyColor="#FF7042";a.Thr.shapelyColor="#B84C00";a.Trp.shapelyColor="#4F4600";a.Tyr.shapelyColor="#8C704C";a.Val.shapelyColor="#FF8CFF";a.Asx.shapelyColor="#FF00FF";a.Glx.shapelyColor="#FF00FF";a["*"].shapelyColor="#FF00FF";a.A.shapelyColor="#A0A0FF";a.G.shapelyColor="#FF7070";a.I.shapelyColor="#80FFFF";a.C.shapelyColor="#FF8C4B";a.T.shapelyColor="#A0FFA0";a.U.shapelyColor="#FF8080";return a}();
(function(b){b.Queue=function(){var a=[],l=0;this.getSize=function(){return a.length-l};this.isEmpty=function(){return a.length==0};this.enqueue=function(g){a.push(g)};this.dequeue=function(){var g=undefined;if(a.length){g=a[l];if(++l*2>=a.length){a=a.slice(l);l=0}}return g};this.getOldestElement=function(){var g=undefined;if(a.length)g=a[l];return g}}})(ChemDoodle.structures);
(function(b,a){b.Point=function(l,g){this.x=l?l:0;this.y=g?g:0;this.sub=function(h){this.x-=h.x;this.y-=h.y};this.add=function(h){this.x+=h.x;this.y+=h.y};this.distance=function(h){return a.sqrt(a.pow(h.x-this.x,2)+a.pow(h.y-this.y,2))};this.angleForStupidCanvasArcs=function(h){var d=h.x-this.x;h=h.y-this.y;var j=0;for(j=d==0?h==0?0:h>0?a.PI/2:3*a.PI/2:h==0?d>0?0:a.PI:d<0?a.atan(h/d)+a.PI:h<0?a.atan(h/d)+2*a.PI:a.atan(h/d);j<0;)j+=a.PI*2;j%=a.PI*2;return j};this.angle=function(h){var d=h.x-this.x;
h=this.y-h.y;var j=0;for(j=d==0?h==0?0:h>0?a.PI/2:3*a.PI/2:h==0?d>0?0:a.PI:d<0?a.atan(h/d)+a.PI:h<0?a.atan(h/d)+2*a.PI:a.atan(h/d);j<0;)j+=a.PI*2;j%=a.PI*2;return j};return true}})(ChemDoodle.structures,Math);
(function(b,a,l,g,h){l.Atom=function(d,j,c,f){this.x=j?j:0;this.y=c?c:0;this.z=f?f:0;this.charge=0;this.mass=-1;this.angleOfLeastInterference=this.bondNumber=this.coordinationNumber=0;this.isHidden=false;this.label=d?d.replace(/\s/g,""):"C";this.altLabel=null;if(!b[this.label])this.label="C";this.isSelected=this.isHover=this.isLone=false;this.add3D=function(e){this.x+=e.x;this.y+=e.y;this.z+=e.z};this.sub3D=function(e){this.x-=e.x;this.y-=e.y;this.z-=e.z};this.distance3D=function(e){return g.sqrt(g.pow(e.x-
this.x,2)+g.pow(e.y-this.y,2)+g.pow(e.z-this.z,2))};this.draw=function(e,k){if(this.specs)k=this.specs;var m=k.getFontString(k.atoms_font_size_2D,k.atoms_font_families_2D,k.atoms_font_bold_2D,k.atoms_font_italic_2D);e.font=m;e.fillStyle=k.atoms_color;if(k.atoms_useJMOLColors)e.fillStyle=b[this.label].jmolColor;if(this.isLone||k.atoms_circles_2D){e.beginPath();e.arc(this.x,this.y,k.atoms_circleDiameter_2D/2,0,g.PI*2,false);e.fill();if(k.atoms_circleBorderWidth_2D>0){e.lineWidth=k.atoms_circleBorderWidth_2D;
e.strokeStyle="black";e.stroke(this.x,this.y,0,g.PI*2,k.atoms_circleDiameter_2D/2)}}else if(this.isLabelVisible(k)){e.textAlign="center";e.textBaseline="middle";if(this.altLabel)e.fillText(this.altLabel,this.x,this.y);else{e.fillText(this.label,this.x,this.y);if(this.mass!=-1){var q=e.measureText(this.label).width,p=k.getFontString(k.atoms_font_size_2D*0.7,k.atoms_font_families_2D,k.atoms_font_bold_2D,k.atoms_font_italic_2D),n=e.font;e.font=p;p=e.measureText(this.mass).width;e.fillText(this.mass,
this.x-p-0.5,this.y-k.atoms_font_size_2D*0.3);e.font=n}n=this.getImplicitHydrogenCount();if(k.atoms_implicitHydrogens_2D&&n>0){q=e.measureText(this.label).width;var t=e.measureText("H").width;if(n>1){var v=q/2+t/2,r=0;p=k.getFontString(k.atoms_font_size_2D*0.8,k.atoms_font_families_2D,k.atoms_font_bold_2D,k.atoms_font_italic_2D);e.font=p;var x=e.measureText(n).width;if(this.bondNumber==1){if(this.angleOfLeastInterference>g.PI/2&&this.angleOfLeastInterference<3*g.PI/2)v=-q/2-x-t/2}else if(!(this.angleOfLeastInterference<=
g.PI/4))if(this.angleOfLeastInterference<3*g.PI/4){v=0;r=-k.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=5*g.PI/4)v=-q/2-x-t/2;else if(this.angleOfLeastInterference<7*g.PI/4){v=0;r=k.atoms_font_size_2D*0.9}e.font=m;e.fillText("H",this.x+v,this.y+r);e.font=p;e.fillText(n,this.x+v+t/2+x/2,this.y+r+k.atoms_font_size_2D*0.3)}else{v=q/2+t/2;r=0;if(this.bondNumber==1){if(this.angleOfLeastInterference>g.PI/2&&this.angleOfLeastInterference<3*g.PI/2)v=-q/2-t/2}else if(!(this.angleOfLeastInterference<=
g.PI/4))if(this.angleOfLeastInterference<3*g.PI/4){v=0;r=-k.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=5*g.PI/4)v=-q/2-t/2;else if(this.angleOfLeastInterference<7*g.PI/4){v=0;r=k.atoms_font_size_2D*0.9}e.fillText("H",this.x+v,this.y+r)}}}if(this.charge!=null&&this.charge!=0){m=this.charge.toFixed(0);if(m=="1")m="+";else if(m=="-1")m="\u2013";else if(a.stringStartsWith(m,"-"))m=m.substring(1)+"\u2013";else m+="+";p=this.angleOfLeastInterference;q=k.atoms_font_size_2D;if(this.isLabelVisible(k)&&
n>0)p+=g.PI/4;e.textAlign="center";e.textBaseline="middle";e.fillText(m,this.x+q*g.cos(p),this.y-q*g.sin(p))}}};this.drawDecorations=function(e){if(this.isHover||this.isSelected){e.strokeStyle=this.isHover?"#885110":"#0060B2";e.lineWidth=1.2;e.beginPath();e.arc(this.x,this.y,this.isHover?7:15,0,g.PI*2,false);e.stroke()}};this.render=function(e,k){if(this.specs)k=this.specs;var m=h.translate(e.modelViewMatrix,[this.x,this.y,this.z],[]),q=k.atoms_useVDWDiameters_3D?b[this.label].vdWRadius*k.atoms_vdwMultiplier_3D:
k.atoms_sphereDiameter_3D/2;if(q==0)q=1;h.scale(m,[q,q,q]);e.material.setDiffuseColor(k.atoms_useJMOLColors?b[this.label].jmolColor:k.atoms_color);e.setMatrixUniforms(m);e.drawElements(e.TRIANGLES,(this.renderAsStar?e.starBuffer:e.sphereBuffer).vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)};this.isLabelVisible=function(e){return e.atoms_displayAllCarbonLabels_2D||this.label!="C"||this.altLabel||this.mass!=-1||this.isHidden&&e.atoms_showHiddenCarbons_2D||e.atoms_displayTerminalCarbonLabels_2D&&this.bondNumber==
1};this.getImplicitHydrogenCount=function(){if(this.label=="H"||b[this.label]==null)return 0;var e=b[this.label].valency,k=e-this.coordinationNumber;if(this.charge>0){e=4-e;if(this.charge<=e)k+=this.charge;else k=4-this.coordinationNumber-this.charge+e}else k+=this.charge;return k<0?0:k};return true};l.Atom.prototype=new l.Point(0,0)})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4);
(function(b,a,l,g,h,d){l.Bond=function(j,c,f){this.a1=j;this.a2=c;this.bondOrder=f?f:1;this.stereo=l.Bond.STEREO_NONE;this.isHover=false;this.ring=null;this.getCenter=function(){return new l.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};this.getLength=function(){return this.a1.distance(this.a2)};this.getLength3D=function(){return this.a1.distance3D(this.a2)};this.contains=function(e){return e==this.a1||e==this.a2};this.getNeighbor=function(e){if(e==this.a1)return this.a2;else if(e==this.a2)return this.a1;
return null};this.draw=function(e,k){if(this.specs)k=this.specs;var m=this.a1.x,q=this.a2.x,p=this.a1.y,n=this.a2.y,t=q-m,v=n-p;if(k.atoms_display&&!k.atoms_circles_2D&&this.a1.isLabelVisible(k)){m+=t*k.bonds_atomLabelBuffer_2D;p+=v*k.bonds_atomLabelBuffer_2D}if(k.atoms_display&&!k.atoms_circles_2D&&this.a2.isLabelVisible(k)){q-=t*k.bonds_atomLabelBuffer_2D;n-=v*k.bonds_atomLabelBuffer_2D}if(k.bonds_clearOverlaps_2D){var r=m+t*0.15,x=p+v*0.15,u=q-t*0.15,w=n-v*0.15;e.strokeStyle=k.backgroundColor;
e.lineWidth=k.bonds_width_2D+k.bonds_overlapClearWidth_2D*2;e.lineCap="round";e.beginPath();e.moveTo(r,x);e.lineTo(u,w);e.closePath();e.stroke()}e.strokeStyle=k.bonds_color;e.fillStyle=k.bonds_color;e.lineWidth=k.bonds_width_2D;e.lineCap=k.bonds_ends_2D;if(k.bonds_useJMOLColors){r=e.createLinearGradient(m,p,q,n);x=b[this.a1.label].jmolColor;u=b[this.a2.label].jmolColor;r.addColorStop(0,x);if(!k.bonds_colorGradient){r.addColorStop(0.5,x);r.addColorStop(0.51,u)}r.addColorStop(1,u);e.strokeStyle=r;e.fillStyle=
r}switch(this.bondOrder){case 0.5:e.beginPath();e.moveTo(m,p);a.contextHashTo(e,m,p,q,n,k.bonds_hashSpacing_2D,k.bonds_hashSpacing_2D);e.stroke();break;case 1:if(this.stereo==l.Bond.STEREO_PROTRUDING||this.stereo==l.Bond.STEREO_RECESSED){var z=k.bonds_width_2D/2;v=this.a1.distance(this.a2)*k.bonds_wedgeThickness_2D/2;r=this.a1.angle(this.a2)+g.PI/2;x=g.cos(r);r=g.sin(r);t=m-x*z;u=p+r*z;w=m+x*z;z=p-r*z;var A=q+x*v,C=n-r*v;x=q-x*v;r=n+r*v;e.beginPath();e.moveTo(t,u);e.lineTo(w,z);e.lineTo(A,C);e.lineTo(x,
r);e.closePath();if(this.stereo==l.Bond.STEREO_PROTRUDING)e.fill();else{e.save();e.clip();e.lineWidth=v*2;e.lineCap="butt";e.beginPath();e.moveTo(m,p);a.contextHashTo(e,m,p,q,n,k.bonds_hashWidth_2D,k.bonds_hashSpacing_2D);e.stroke();e.restore()}}else if(this.stereo==l.Bond.STEREO_AMBIGUOUS){e.beginPath();e.moveTo(m,p);n=g.floor(g.sqrt(t*t+v*v)/k.bonds_wavyLength_2D);m=m;p=p;r=this.a1.angle(this.a2)+g.PI/2;x=g.cos(r);r=g.sin(r);q=t/n;v=v/n;for(A=0;A<n;A++){m+=q;p+=v;t=k.bonds_wavyLength_2D*x+m-q*0.5;
w=k.bonds_wavyLength_2D*-r+p-v*0.5;u=k.bonds_wavyLength_2D*-x+m-q*0.5;z=k.bonds_wavyLength_2D*r+p-v*0.5;A%2==0?e.quadraticCurveTo(t,w,m,p):e.quadraticCurveTo(u,z,m,p)}e.stroke();break}else{e.beginPath();e.moveTo(m,p);e.lineTo(q,n);e.stroke()}break;case 1.5:e.beginPath();e.moveTo(m,p);e.lineTo(q,n);e.stroke();break;case 2:if(this.stereo==l.Bond.STEREO_AMBIGUOUS){v=this.a1.distance(this.a2)*k.bonds_saturationWidth_2D/2;r=this.a1.angle(this.a2)+g.PI/2;t=m-g.cos(r)*v;u=p+g.sin(r)*v;w=m+g.cos(r)*v;z=p-
g.sin(r)*v;A=q+g.cos(r)*v;C=n-g.sin(r)*v;x=q-g.cos(r)*v;r=n+g.sin(r)*v;e.beginPath();e.moveTo(t,u);e.lineTo(A,C);e.moveTo(w,z);e.lineTo(x,r);e.stroke()}else if(!k.bonds_symmetrical_2D&&(this.ring!=null||this.a1.label=="C"&&this.a2.label=="C")){e.beginPath();e.moveTo(m,p);e.lineTo(q,n);x=0;u=this.a1.distance(this.a2);t=this.a1.angle(this.a2);r=t+g.PI/2;v=u*k.bonds_saturationWidth_2D;w=k.bonds_saturationAngle_2D;if(w<g.PI/2)x=-(v/g.tan(w));if(g.abs(x)<u/2){w=m-g.cos(t)*x;m=q+g.cos(t)*x;q=p+g.sin(t)*
x;p=n-g.sin(t)*x;t=w-g.cos(r)*v;u=q+g.sin(r)*v;w=w+g.cos(r)*v;z=q-g.sin(r)*v;A=m-g.cos(r)*v;C=p+g.sin(r)*v;x=m+g.cos(r)*v;r=p-g.sin(r)*v;if(this.ring==null||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>g.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-g.PI){e.moveTo(t,u);e.lineTo(A,C)}else{e.moveTo(w,z);e.lineTo(x,r)}e.stroke()}}else{v=this.a1.distance(this.a2)*k.bonds_saturationWidth_2D/2;
r=this.a1.angle(this.a2)+g.PI/2;t=m-g.cos(r)*v;u=p+g.sin(r)*v;w=m+g.cos(r)*v;z=p-g.sin(r)*v;A=q+g.cos(r)*v;C=n-g.sin(r)*v;x=q-g.cos(r)*v;r=n+g.sin(r)*v;e.beginPath();e.moveTo(t,u);e.lineTo(x,r);e.moveTo(w,z);e.lineTo(A,C);e.stroke()}break;case 3:v=this.a1.distance(this.a2)*k.bonds_saturationWidth_2D;r=this.a1.angle(this.a2)+g.PI/2;t=m-g.cos(r)*v;u=p+g.sin(r)*v;w=m+g.cos(r)*v;z=p-g.sin(r)*v;A=q+g.cos(r)*v;C=n-g.sin(r)*v;x=q-g.cos(r)*v;r=n+g.sin(r)*v;e.beginPath();e.moveTo(t,u);e.lineTo(x,r);e.moveTo(w,
z);e.lineTo(A,C);e.moveTo(m,p);e.lineTo(q,n);e.stroke();break}};this.drawDecorations=function(e){if(this.isHover||this.isSelected){var k=2*g.PI,m=(this.a1.angleForStupidCanvasArcs(this.a2)+g.PI/2)%k;e.strokeStyle=this.isHover?"#885110":"#0060B2";e.lineWidth=1.2;e.beginPath();var q=(m+g.PI)%k;q%=g.PI*2;e.arc(this.a1.x,this.a1.y,7,m,q,false);e.stroke();e.beginPath();m+=g.PI;q=(m+g.PI)%k;e.arc(this.a2.x,this.a2.y,7,m,q,false);e.stroke()}};this.render=function(e,k){if(this.specs)k=this.specs;var m=1.001*
this.a1.distance3D(this.a2)/(k.bonds_useJMOLColors?2:1);if(m==0)return false;m=[k.bonds_cylinderDiameter_3D/2,m,k.bonds_cylinderDiameter_3D/2];var q=h.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),p=null,n=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];if(k.bonds_useJMOLColors){d.scale(n,0.5);p=h.translate(e.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[])}var t=[0],v=null;if(k.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:t=[-k.bonds_cylinderDiameter_3D,
k.bonds_cylinderDiameter_3D];break;case 3:t=[-1.2*k.bonds_cylinderDiameter_3D,0,1.2*k.bonds_cylinderDiameter_3D];break}if(t.length>1){v=[0,0,1];var r=h.inverse(e.rotationMatrix,[]);h.multiplyVec3(r,v);v=d.cross(n,v,[]);d.normalize(v)}}var x=[0,1,0];r=0;var u=null;if(this.a1.x==this.a2.x&&this.a1.z==this.a2.z){u=[0,0,1];if(this.a2.y<this.a1.y)r=g.PI}else{r=a.vec3AngleFrom(x,n);u=d.cross(x,n,[])}n=0;for(x=t.length;n<x;n++){var w=h.set(q,[]);t[n]!=0&&h.translate(w,d.scale(v,t[n],[]));r!=0&&h.rotate(w,
r,u);h.scale(w,m);e.material.setDiffuseColor(k.bonds_useJMOLColors?b[this.a1.label].jmolColor:k.bonds_color);e.setMatrixUniforms(w);k.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems);if(k.bonds_useJMOLColors){h.set(p,w);t[n]!=0&&h.translate(w,d.scale(v,t[n],[]));h.rotate(w,r+g.PI,u);h.scale(w,m);e.material.setDiffuseColor(b[this.a2.label].jmolColor);e.setMatrixUniforms(w);k.bonds_renderAsLines_3D?
e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}}};return true};l.Bond.STEREO_NONE="none";l.Bond.STEREO_PROTRUDING="protruding";l.Bond.STEREO_RECESSED="recessed";l.Bond.STEREO_AMBIGUOUS="ambiguous"})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4,vec3);
(function(b,a){b.Ring=function(){this.atoms=[];this.bonds=[];this.center=null;this.setupBonds=function(){for(var l=0,g=this.bonds.length;l<g;l++)this.bonds[l].ring=this;this.center=this.getCenter()};this.getCenter=function(){for(var l=minY=Infinity,g=maxY=-Infinity,h=0,d=this.atoms.length;h<d;h++){l=a.min(this.atoms[h].x,l);minY=a.min(this.atoms[h].y,minY);g=a.max(this.atoms[h].x,g);maxY=a.max(this.atoms[h].y,maxY)}return new b.Point((g+l)/2,(maxY+minY)/2)};return true}})(ChemDoodle.structures,Math);
(function(b,a,l,g,h){l.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[];this.findRings=true;this.draw=function(d,j){if(this.specs)j=this.specs;if(j.bonds_display)for(var c=0,f=this.bonds.length;c<f;c++)this.bonds[c].draw(d,j);if(j.atoms_display){c=0;for(f=this.atoms.length;c<f;c++)this.atoms[c].draw(d,j)}};this.render=function(d,j){if(this.specs)j=this.specs;var c=this.atoms.length>0&&this.atoms[0].hetatm!=undefined;if(c){if(j.macro_displayBonds){if(this.bonds.length>0){if(j.bonds_renderAsLines_3D){d.lineWidth(this.residueSpecs?
this.residueSpecs.bonds_width_2D:j.bonds_width_2D);d.lineBuffer.bindBuffers(d)}else d.cylinderBuffer.bindBuffers(d);d.material.setTempColors(j.bonds_materialAmbientColor_3D,null,j.bonds_materialSpecularColor_3D,j.bonds_materialShininess_3D)}for(var f=0,e=this.bonds.length;f<e;f++){var k=this.bonds[f];if(!k.a1.hetatm&&(j.macro_atomToLigandDistance==-1||k.a1.closestDistance!=undefined&&j.macro_atomToLigandDistance>=k.a1.closestDistance&&j.macro_atomToLigandDistance>=k.a2.closestDistance))k.render(d,
this.residueSpecs?this.residueSpecs:j)}}if(j.macro_displayAtoms){if(this.atoms.length>0){d.sphereBuffer.bindBuffers(d);d.material.setTempColors(j.atoms_materialAmbientColor_3D,null,j.atoms_materialSpecularColor_3D,j.atoms_materialShininess_3D)}f=0;for(e=this.atoms.length;f<e;f++){var m=this.atoms[f];if(!m.hetatm&&(j.macro_atomToLigandDistance==-1||m.closestDistance!=undefined&&j.macro_atomToLigandDistance>=m.closestDistance))m.render(d,this.residueSpecs?this.residueSpecs:j)}}}if(j.bonds_display){if(this.bonds.length>
0){if(j.bonds_renderAsLines_3D){d.lineWidth(j.bonds_width_2D);d.lineBuffer.bindBuffers(d)}else d.cylinderBuffer.bindBuffers(d);d.material.setTempColors(j.bonds_materialAmbientColor_3D,null,j.bonds_materialSpecularColor_3D,j.bonds_materialShininess_3D)}f=0;for(e=this.bonds.length;f<e;f++){k=this.bonds[f];if(!c||k.a1.hetatm)k.render(d,j)}}if(j.atoms_display){f=0;for(e=this.atoms.length;f<e;f++){m=this.atoms[f];m.bondNumber=0;m.renderAsStar=false}f=0;for(e=this.bonds.length;f<e;f++){k=this.bonds[f];
k.a1.bondNumber++;k.a2.bondNumber++}if(this.atoms.length>0){d.sphereBuffer.bindBuffers(d);d.material.setTempColors(j.atoms_materialAmbientColor_3D,null,j.atoms_materialSpecularColor_3D,j.atoms_materialShininess_3D)}k=[];f=0;for(e=this.atoms.length;f<e;f++){m=this.atoms[f];if(!c||m.hetatm&&(j.macro_showWater||!m.isWater))if(j.atoms_nonBondedAsStars_3D&&m.bondNumber==0){m.renderAsStar=true;k.push(m)}else m.render(d,j)}if(k.length>0){d.starBuffer.bindBuffers(d);f=0;for(e=k.length;f<e;f++)k[f].render(d,
j)}}if(this.chains){d.setMatrixUniforms(d.modelViewMatrix);if(j.proteins_displayRibbon){d.material.setTempColors(j.proteins_materialAmbientColor_3D,null,j.proteins_materialSpecularColor_3D,j.proteins_materialShininess_3D);c=0;for(m=this.ribbons.length;c<m;c++)if(j.proteins_useShapelyColors||j.proteins_useAminoColors||j.proteins_usePolarityColors){k=j.proteins_ribbonCartoonize?this.cartoons[c]:this.ribbons[c];k.front.bindBuffers(d);f=0;for(e=k.front.segments.length;f<e;f++)k.front.segments[f].render(d,
j);k.back.bindBuffers(d);f=0;for(e=k.back.segments.length;f<e;f++)k.back.segments[f].render(d,j)}else if(j.proteins_ribbonCartoonize){k=this.cartoons[c];k.front.bindBuffers(d);f=0;for(e=k.front.cartoonSegments.length;f<e;f++)k.front.cartoonSegments[f].render(d,j);k.back.bindBuffers(d);f=0;for(e=k.back.cartoonSegments.length;f<e;f++)k.back.cartoonSegments[f].render(d,j)}else{k=this.ribbons[c];k.front.render(d,j);k.back.render(d,j)}}if(j.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace=
{nodes:[],edges:[]};c=0;for(m=this.chains.length;c<m;c++){var q=this.chains[c];if(!(q.length>2&&g[q[2].name]&&g[q[2].name].aminoColor=="#BEA06E")&&q.length>0){f=1;for(e=q.length-2;f<e;f++){k=q[f].cp1;k.chainColor=q.chainColor;this.alphaCarbonTrace.nodes.push(k);k=new l.Bond(q[f].cp1,q[f+1].cp1);k.residueName=q[f].name;k.chainColor=q.chainColor;this.alphaCarbonTrace.edges.push(k);if(f==q.length-3){k=q[f+1].cp1;k.chainColor=q.chainColor;this.alphaCarbonTrace.nodes.push(k)}}}}}if(this.alphaCarbonTrace.nodes.length>
0){c=new l.VisualSpecifications;c.atoms_display=true;c.bonds_display=true;c.atoms_sphereDiameter_3D=j.proteins_backboneThickness;c.bonds_cylinderDiameter_3D=j.proteins_backboneThickness;c.bonds_useJMOLColors=false;c.atoms_color=j.proteins_backboneColor;c.bonds_color=j.proteins_backboneColor;c.atoms_useVDWDiameters_3D=false;d.material.setTempColors(j.proteins_materialAmbientColor_3D,null,j.proteins_materialSpecularColor_3D,j.proteins_materialShininess_3D);d.material.setDiffuseColor(j.proteins_backboneColor);
f=0;for(e=this.alphaCarbonTrace.nodes.length;f<e;f++){k=this.alphaCarbonTrace.nodes[f];if(j.macro_colorByChain)c.atoms_color=k.chainColor;d.sphereBuffer.bindBuffers(d);k.render(d,c)}f=0;for(e=this.alphaCarbonTrace.edges.length;f<e;f++){m=this.alphaCarbonTrace.edges[f];k=null;q=g[m.residueName]?g[m.residueName]:g["*"];if(j.macro_colorByChain)k=m.chainColor;else if(j.proteins_useShapelyColors)k=q.shapelyColor;else if(j.proteins_useAminoColors)k=q.aminoColor;else if(j.proteins_usePolarityColors)k=q.polar?
"#C10000":"#FFFFFF";if(k!=null)c.bonds_color=k;d.cylinderBuffer.bindBuffers(d);m.render(d,c)}}}if(j.nucleics_display){d.material.setTempColors(j.nucleics_materialAmbientColor_3D,null,j.nucleics_materialSpecularColor_3D,j.nucleics_materialShininess_3D);c=0;for(m=this.tubes.length;c<m;c++){d.setMatrixUniforms(d.modelViewMatrix);k=this.tubes[c];k.render(d,j)}}}if(j.crystals_displayUnitCell&&this.unitCell){d.setMatrixUniforms(d.modelViewMatrix);this.unitCell.bindBuffers(d);d.material.setDiffuseColor(j.crystals_unitCellColor);
d.lineWidth(j.crystals_unitCellLineWidth);d.drawElements(d.LINES,this.unitCell.vertexIndexBuffer.numItems,d.UNSIGNED_SHORT,0)}if(this.surface&&j.surfaces_display){d.setMatrixUniforms(d.modelViewMatrix);this.surface.bindBuffers(d);d.material.setTempColors(j.surfaces_materialAmbientColor_3D,j.surfaces_color,j.surfaces_materialSpecularColor_3D,j.surfaces_materialShininess_3D);j.surfaces_style=="Dot"?d.drawArrays(d.POINTS,0,this.surface.vertexPositionBuffer.numItems):d.drawElements(d.TRIANGLES,this.surface.vertexIndexBuffer.numItems,
d.UNSIGNED_SHORT,0)}};this.getCenter3D=function(){if(this.atoms.length==1)return new l.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var d=minY=minZ=Infinity,j=maxY=maxZ=-Infinity;if(this.chains)for(var c=0,f=this.chains.length;c<f;c++)for(var e=this.chains[c],k=0,m=e.length;k<m;k++){var q=e[k];d=h.min(q.cp1.x,d);minY=h.min(q.cp1.y,minY);minZ=h.min(q.cp1.z,minZ);j=h.max(q.cp1.x,j);maxY=h.max(q.cp1.y,maxY);maxZ=h.max(q.cp1.z,maxZ);d=h.min(q.cp2.x,d);minY=h.min(q.cp2.y,minY);minZ=h.min(q.cp2.z,
minZ);j=h.max(q.cp2.x,j);maxY=h.max(q.cp2.y,maxY);maxZ=h.max(q.cp2.z,maxZ)}c=0;for(f=this.atoms.length;c<f;c++){d=h.min(this.atoms[c].x,d);minY=h.min(this.atoms[c].y,minY);minZ=h.min(this.atoms[c].z,minZ);j=h.max(this.atoms[c].x,j);maxY=h.max(this.atoms[c].y,maxY);maxZ=h.max(this.atoms[c].z,maxZ)}return new l.Atom("C",(j+d)/2,(maxY+minY)/2,(maxZ+minZ)/2)};this.getCenter=function(){if(this.atoms.length==1)return new l.Point(this.atoms[0].x,this.atoms[0].y);for(var d=minY=Infinity,j=maxY=-Infinity,
c=0,f=this.atoms.length;c<f;c++){d=h.min(this.atoms[c].x,d);minY=h.min(this.atoms[c].y,minY);j=h.max(this.atoms[c].x,j);maxY=h.max(this.atoms[c].y,maxY)}return new l.Point((j+d)/2,(maxY+minY)/2)};this.getDimension=function(){if(this.atoms.length==1)return new l.Point(0,0);var d=minY=Infinity,j=maxY=-Infinity;if(this.chains){for(var c=0,f=this.chains.length;c<f;c++)for(var e=this.chains[c],k=0,m=e.length;k<m;k++){var q=e[k];d=h.min(q.cp1.x,d);minY=h.min(q.cp1.y,minY);j=h.max(q.cp1.x,j);maxY=h.max(q.cp1.y,
maxY);d=h.min(q.cp2.x,d);minY=h.min(q.cp2.y,minY);j=h.max(q.cp2.x,j);maxY=h.max(q.cp2.y,maxY)}d-=30;minY-=30;minZ-=30;j+=30;maxY+=30;maxZ+=30}c=0;for(f=this.atoms.length;c<f;c++){d=h.min(this.atoms[c].x,d);minY=h.min(this.atoms[c].y,minY);j=h.max(this.atoms[c].x,j);maxY=h.max(this.atoms[c].y,maxY)}return new l.Point(j-d,maxY-minY)};this.check=function(){if(this.findRings){this.rings=(new b.informatics.SSSRFinder(this)).rings;for(var d=0,j=this.bonds.length;d<j;d++)this.bonds[d].ring=null;d=0;for(j=
this.rings.length;d<j;d++)this.rings[d].setupBonds()}d=0;for(j=this.atoms.length;d<j;d++){this.atoms[d].isLone=false;if(this.atoms[d].label=="C"){for(var c=0,f=0,e=this.bonds.length;f<e;f++)if(this.bonds[f].a1==this.atoms[d]||this.bonds[f].a2==this.atoms[d])c++;if(c==0)this.atoms[d].isLone=true}}c=false;d=0;for(j=this.atoms.length;d<j;d++)if(this.atoms[d].z!=0)c=true;if(c){this.sortAtomsByZ();this.sortBondsByZ()}this.setupMetaData()};this.getAngles=function(d){for(var j=[],c=0,f=this.bonds.length;c<
f;c++)this.bonds[c].contains(d)&&j.push(d.angle(this.bonds[c].getNeighbor(d)));j.sort();return j};this.getCoordinationNumber=function(d){for(var j=0,c=0,f=d.length;c<f;c++)j+=d[c].bondOrder;return j};this.getBonds=function(d){for(var j=[],c=0,f=this.bonds.length;c<f;c++)this.bonds[c].contains(d)&&j.push(this.bonds[c]);return j};this.sortAtomsByZ=function(){for(var d=1,j=this.atoms.length;d<j;d++)for(var c=d;c>0&&this.atoms[c].z<this.atoms[c-1].z;){var f=this.atoms[c];this.atoms[c]=this.atoms[c-1];
this.atoms[c-1]=f;c--}};this.sortBondsByZ=function(){for(var d=1,j=this.bonds.length;d<j;d++)for(var c=d;c>0&&this.bonds[c].a1.z+this.bonds[c].a2.z<this.bonds[c-1].a1.z+this.bonds[c-1].a2.z;){var f=this.bonds[c];this.bonds[c]=this.bonds[c-1];this.bonds[c-1]=f;c--}};this.setupMetaData=function(){for(var d=0,j=this.atoms.length;d<j;d++){var c=this.atoms[d],f=this.getBonds(c),e=this.getAngles(c);c.isHidden=f.length==2&&h.abs(h.abs(e[1]-e[0])-h.PI)<h.PI/30&&f[0].bondOrder==f[1].bondOrder;c.angleOfLeastInterference=
b.math.angleBetweenLargest(e)%(h.PI*2);c.coordinationNumber=this.getCoordinationNumber(f);c.bondNumber=f.length}};this.scaleToAverageBondLength=function(d){var j=this.getAverageBondLength();if(j!=0){d=d/j;j=0;for(var c=this.atoms.length;j<c;j++){this.atoms[j].x*=d;this.atoms[j].y*=d}}};this.getAverageBondLength=function(){if(this.bonds.length==0)return 0;for(var d=0,j=0,c=this.bonds.length;j<c;j++)d+=this.bonds[j].getLength();d/=this.bonds.length;return d};return true}})(ChemDoodle,ChemDoodle.math,
ChemDoodle.structures,ChemDoodle.RESIDUE,Math);
(function(b,a,l,g){var h=[6/a.pow(10,3),0,0,0,6/a.pow(10,3),2/a.pow(10,2),0,0,1/a.pow(10,3),1/a.pow(10,2),0.1,0,0,0,0,1],d=l.multiply([-1/6,0.5,-0.5,1/6,0.5,-1,0.5,0,-0.5,0,0.5,0,1/6,2/3,1/6,0],h,[]);b.Residue=function(j){this.Ns=9;this.resSeq=j;this.setup=function(c){var f=[c.x-this.cp1.x,c.y-this.cp1.y,c.z-this.cp1.z],e=g.cross(f,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=g.cross(e,f,[]);g.normalize(e);g.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=
[];c=[(c.x+this.cp1.x)/2,(c.y+this.cp1.y)/2,(c.z+this.cp1.z)/2];if(this.helix){g.scale(e,1.5);g.add(c,e)}this.guidePointsSmall[0]=new b.Atom("",c[0]-this.D[0]/2,c[1]-this.D[1]/2,c[2]-this.D[2]/2);for(e=1;e<this.Ns;e++)this.guidePointsSmall[e]=new b.Atom("",this.guidePointsSmall[0].x+this.D[0]*e/this.Ns,this.guidePointsSmall[0].y+this.D[1]*e/this.Ns,this.guidePointsSmall[0].z+this.D[2]*e/this.Ns);g.scale(this.D,4);this.guidePointsLarge[0]=new b.Atom("",c[0]-this.D[0]/2,c[1]-this.D[1]/2,c[2]-this.D[2]/
2);for(e=1;e<this.Ns;e++)this.guidePointsLarge[e]=new b.Atom("",this.guidePointsLarge[0].x+this.D[0]*e/this.Ns,this.guidePointsLarge[0].y+this.D[1]*e/this.Ns,this.guidePointsLarge[0].z+this.D[2]*e/this.Ns)};this.getGuidePointSet=function(c){if(c==0)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;else if(c==1)return this.guidePointsSmall;else if(c==2)return this.guidePointsLarge};this.computeLineSegments=function(c,f,e,k){this.split=f.helix!=this.helix||f.sheet!=this.sheet;
this.lineSegments=this.innerCompute(0,c,f,e,false);if(k)this.lineSegmentsCartoon=this.innerCompute(f.helix||f.sheet?2:1,c,f,e,true)};this.innerCompute=function(c,f,e,k,m){var q=[],p=this.getGuidePointSet(c);f=f.getGuidePointSet(c);e=e.getGuidePointSet(c);for(var n=k.getGuidePointSet(c),t=0,v=this.guidePointsLarge.length;t<v;t++){for(var r=l.multiply([f[t].x,f[t].y,f[t].z,1,p[t].x,p[t].y,p[t].z,1,e[t].x,e[t].y,e[t].z,1,n[t].x,n[t].y,n[t].z,1],d,[]),x=[],u=0;u<10;u++){for(c=3;c>0;c--)for(k=0;k<4;k++)r[c*
4+k]+=r[(c-1)*4+k];x[u]=new b.Atom("",r[12]/r[15],r[13]/r[15],r[14]/r[15])}q[t]=x}if(m&&this.arrow)for(c=0;c<10;c++){m=1.5-1.3*c/10;p=a.floor(this.Ns/2);f=q[p];k=0;for(e=q.length;k<e;k++)if(k!=p){n=f[c];t=q[k][c];v=[t.x-n.x,t.y-n.y,t.z-n.z];g.scale(v,m);t.x=n.x+v[0];t.y=n.y+v[1];t.z=n.z+v[2]}}return q}}})(ChemDoodle.structures,Math,mat4,vec3);
(function(b,a,l,g,h){a.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.yUnit=this.xUnit=this.title=null;this.continuous=true;this.integrationSensitivity=0.01;var d=0,j=false;this.draw=function(c,f,e,k){var m=5,q=0,p=0;c.fillStyle=f.text_color;c.textAlign="center";c.textBaseline="alphabetic";c.font=f.getFontString(f.text_font_size,f.text_font_families);if(this.xUnit){p+=f.text_font_size;c.fillText(this.xUnit,e/2,k-2)}if(this.yUnit&&f.plots_showYAxis){q+=f.text_font_size;
c.save();c.translate(f.text_font_size,k/2);c.rotate(-h.PI/2);c.fillText(this.yUnit,0,0);c.restore()}if(this.title!=null){m+=f.text_font_size;c.fillText(this.title,e/2,f.text_font_size)}p+=5+f.text_font_size;if(f.plots_showYAxis)q+=5+c.measureText("1000").width;if(f.plots_showGrid){c.strokeStyle=f.plots_gridColor;c.lineWidth=f.plots_gridLineWidth;c.strokeRect(q,m,e-q,k-p-m)}c.textAlign="center";c.textBaseline="top";for(var n=this.maxX-this.minX,t=n/100,v=0.0010;v<t||n/v>25;)v*=10;var r=0,x=f.plots_flipXAxis?
e:0;for(n=h.round(this.minX/v)*v;n<=this.maxX;n+=v/2){t=this.getTransformedX(n,f,e,q);if(t>q){c.strokeStyle="black";c.lineWidth=1;if(r%2==0){c.beginPath();c.moveTo(t,k-p);c.lineTo(t,k-p+2);c.stroke();for(var u=n.toFixed(5);u.charAt(u.length-1)=="0";)u=u.substring(0,u.length-1);if(u.charAt(u.length-1)==".")u=u.substring(0,u.length-1);var w=c.measureText(u).width;if(f.plots_flipXAxis)w*=-1;var z=t-w/2;if(f.plots_flipXAxis?z<x:z>x){c.fillText(u,t,k-p+2);x=t+w/2}if(f.plots_showGrid){c.strokeStyle=f.plots_gridColor;
c.lineWidth=f.plots_gridLineWidth;c.beginPath();c.moveTo(t,k-p);c.lineTo(t,m);c.stroke()}}else{c.beginPath();c.moveTo(t,k-p);c.lineTo(t,k-p+2);c.stroke()}}r++}if(f.plots_showYAxis||f.plots_showGrid){t=1/f.scale;c.textAlign="right";c.textBaseline="middle";for(n=0;n<=10;n++){u=t/10*n;v=m+(k-p-m)*(1-u*f.scale);if(f.plots_showGrid){c.strokeStyle=f.plots_gridColor;c.lineWidth=f.plots_gridLineWidth;c.beginPath();c.moveTo(q,v);c.lineTo(e,v);c.stroke()}if(f.plots_showYAxis){c.strokeStyle="black";c.lineWidth=
1;c.beginPath();c.moveTo(q,v);c.lineTo(q-3,v);c.stroke();u=u*100;r=h.max(0,3-h.floor(u).toString().length);u=u.toFixed(r);if(r>0)for(;u.charAt(u.length-1)=="0";)u=u.substring(0,u.length-1);if(u.charAt(u.length-1)==".")u=u.substring(0,u.length-1);c.fillText(u,q-3,v)}}}c.strokeStyle="black";c.lineWidth=1;c.beginPath();c.moveTo(e,k-p);c.lineTo(q,k-p);f.plots_showYAxis&&c.lineTo(q,m);c.stroke();if(this.dataDisplay.length>0){c.textAlign="left";c.textBaseline="top";n=t=0;for(u=this.dataDisplay.length;n<
u;n++)if(this.dataDisplay[n].value){c.fillText([this.dataDisplay[n].display,": ",this.dataDisplay[n].value].join(""),q+10,m+10+t*(f.text_font_size+5));t++}else if(this.dataDisplay[n].tag){v=0;for(r=this.metadata.length;v<r;v++)if(b.stringStartsWith(this.metadata[v],this.dataDisplay[n].tag)){r=this.metadata[v];if(this.dataDisplay[n].display){r=g.inArray("=",this.metadata[v]);r=[this.dataDisplay[n].display,": ",r>-1?this.metadata[v].substring(r+2):this.metadata[v]].join("")}c.fillText(r,q+10,m+10+t*
(f.text_font_size+5));t++;break}}}c.strokeStyle=f.plots_color;c.lineWidth=f.plots_width;r=[];c.beginPath();if(this.continuous){x=false;n=0;for(u=this.data.length;n<u;n++){t=this.getTransformedX(this.data[n].x,f,e,q);if(t>=q&&t<e){v=this.getTransformedY(this.data[n].y,f,k,p,m);f.plots_showIntegration&&h.abs(this.data[n].y)>this.integrationSensitivity&&r.push(new a.Point(this.data[n].x,this.data[n].y));if(!x){c.moveTo(t,v);x=true}c.lineTo(t,v)}else if(x)break}}else{n=0;for(u=this.data.length;n<u;n++){t=
this.getTransformedX(this.data[n].x,f,e,q);if(t>=q&&t<e){c.moveTo(t,k-p);c.lineTo(t,this.getTransformedY(this.data[n].y,f,k,p,m))}}}c.stroke();if(f.plots_showIntegration&&r.length>1){c.strokeStyle=f.plots_integrationColor;c.lineWidth=f.plots_integrationLineWidth;c.beginPath();n=r[1].x>r[0].x;if(this.flipXAxis&&!n||!this.flipXAxis&&n){for(n=r.length-2;n>=0;n--)r[n].y+=r[n+1].y;x=r[0].y}else{n=1;for(u=r.length;n<u;n++)r[n].y+=r[n-1].y;x=r[r.length-1].y}n=0;for(u=r.length;n<u;n++){t=this.getTransformedX(r[n].x,
f,e,q);v=this.getTransformedY(r[n].y/f.scale/x,f,k,p,m);n==0?c.moveTo(t,v):c.lineTo(t,v)}c.stroke()}d=q;j=f.plots_flipXAxis};this.getTransformedY=function(c,f,e,k,m){return m+(e-k-m)*(1-c*f.scale)};this.getTransformedX=function(c,f,e,k){c=k+(c-this.minX)/(this.maxX-this.minX)*(e-k);if(f.plots_flipXAxis)c=e+k-c;return c};this.getInverseTransformedX=function(c,f,e){if(j)c=f+e-c;return(c-e)*(this.maxX-this.minX)/(f-e)+this.minX};this.setup=function(){for(var c=Number.MAX_VALUE,f=Number.MIN_VALUE,e=Number.MIN_VALUE,
k=0,m=this.data.length;k<m;k++){c=h.min(c,this.data[k].x);f=h.max(f,this.data[k].x);e=h.max(e,this.data[k].y)}if(this.continuous){this.minX=c;this.maxX=f}else{this.minX=c-1;this.maxX=f+1}k=0;for(m=this.data.length;k<m;k++)this.data[k].y/=e};this.zoom=function(c,f,e,k){c=this.getInverseTransformedX(c,e,d);f=this.getInverseTransformedX(f,e,d);this.minX=h.min(c,f);this.maxX=h.max(c,f);if(k){k=Number.MIN_VALUE;f=0;for(e=this.data.length;f<e;f++)if(l.isBetween(this.data[f].x,this.minX,this.maxX))k=h.max(k,
this.data[f].y);return 1/k}};this.translate=function(c,f){var e=c/(f-d)*(this.maxX-this.minX)*(j?1:-1);this.minX+=e;this.maxX+=e};this.alertMetadata=function(){alert(this.metadata.join("\n"))};return true}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math);
(function(b){b._Mesh=function(){return true};b._Mesh.prototype.storeData=function(a,l,g){this.positionData=a;this.normalData=l;this.indexData=g};b._Mesh.prototype.setupBuffers=function(a){this.vertexPositionBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer);a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.positionData),a.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=a.createBuffer();
a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer);a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.normalData),a.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;if(this.indexData){this.vertexIndexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),a.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=this.indexData.length}};
b._Mesh.prototype.bindBuffers=function(a){this.vertexPositionBuffer||this.setupBuffers(a);a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer);a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,false,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer);a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,a.FLOAT,false,0,0);this.vertexIndexBuffer&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures,
Math);(function(b,a){b.Cylinder=function(l,g,h){for(var d=[],j=[],c=0;c<h;c++){var f=c*2*a.PI/h,e=a.cos(f);f=a.sin(f);j.push(e,0,f);d.push(l*e,0,l*f);j.push(e,0,f);d.push(l*e,g,l*f)}j.push(1,0,0);d.push(l,0,0);j.push(1,0,0);d.push(l,g,0);this.storeData(d,j);return true};b.Cylinder.prototype=new b._Mesh})(ChemDoodle.structures,Math);
(function(b,a){b.Sphere=function(l,g,h){for(var d=[],j=[],c=0;c<=g;c++){var f=c*a.PI/g,e=a.sin(f),k=a.cos(f);for(f=0;f<=h;f++){var m=f*2*a.PI/h,q=a.sin(m);m=a.cos(m)*e;var p=k;q=q*e;j.push(m,p,q);d.push(l*m,l*p,l*q)}}l=[];h+=1;for(c=0;c<g;c++)for(f=0;f<h;f++){e=c*h+f%h;k=e+h;l.push(e);l.push(k);l.push(e+1);if(f<h-1){l.push(k);l.push(k+1);l.push(e+1)}}this.storeData(d,j,l);return true};b.Sphere.prototype=new b._Mesh})(ChemDoodle.structures,Math);
(function(b,a,l,g){function h(d,j,c){this.name=j;this.entire=d;this.getColor=function(f){return f.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(b[this.name]?this.name:"*",f):this.helix?d.front?f.proteins_ribbonCartoonHelixPrimaryColor:f.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?f.proteins_ribbonCartoonSheetColor:d.front?f.proteins_primaryColor:f.proteins_secondaryColor};this.getResidueColor=function(f,e){var k=b[f];if(e.proteins_useShapelyColors)return k.shapelyColor;
else if(e.proteins_useAminoColors)return k.aminoColor;else if(e.proteins_usePolarityColors)return k.polar?"#C10000":"#FFFFFF";return"#FFFFFF"};this.render=function(f,e){if(!this.vertexIndexBuffer){this.vertexIndexBuffer=f.createBuffer();f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);f.bufferData(f.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),f.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=c.length}f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);
f.material.setDiffuseColor(this.getColor(e));f.drawElements(f.TRIANGLES,this.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)}}a.Ribbon=function(d,j,c){var f=d[0].lineSegments.length,e=d[0].lineSegments[0].length,k=[],m=[];this.front=j>0;for(var q=0,p=d.length-1;q<p;q++)for(var n=d[q],t=0;t<f;t++)for(var v=c?n.lineSegmentsCartoon[t]:n.lineSegments[t],r=t==0,x=false,u=0;u<e;u++){var w=v[u],z=q,A=u+1;if(q==d.length-2&&u==e-1)A--;else if(u==e-1){z++;A=0}A=c?d[z].lineSegmentsCartoon[t][A]:d[z].lineSegments[t][A];
z=false;var C=t+1;if(t==f-1){C-=2;z=true}C=c?n.lineSegmentsCartoon[C][u]:n.lineSegments[C][u];A=[A.x-w.x,A.y-w.y,A.z-w.z];C=[C.x-w.x,C.y-w.y,C.z-w.z];var D=g.cross(A,C,[]);if(u==0){g.normalize(A);g.scale(A,-1);m.push(A[0],A[1],A[2]);k.push(w.x,w.y,w.z)}if(r||x){g.normalize(C);g.scale(C,-1);m.push(C[0],C[1],C[2]);k.push(w.x,w.y,w.z);if(r&&u==e-1){r=false;u=-1}}else{g.normalize(D);if(z&&!this.front||!z&&this.front)g.scale(D,-1);m.push(D[0],D[1],D[2]);g.scale(D,l.abs(j));k.push(w.x+D[0],w.y+D[1],w.z+
D[2]);if(t==f-1&&u==e-1){x=true;u=-1}}if(u==-1||u==e-1){g.normalize(A);m.push(A[0],A[1],A[2]);k.push(w.x,w.y,w.z)}}f+=2;e+=2;this.segments=[];var G;if(c){this.cartoonSegments=[];G=[]}j=[];q=0;for(p=d.length-1;q<p;q++){if(q>0&&G)if(d[q].split){t=new h(this,null,G);if(d[q].helix)t.helix=true;if(d[q].sheet)t.sheet=true;this.cartoonSegments.push(t);G=[]}c=q*f*e;n=[];t=0;for(v=f-1;t<v;t++){r=c+t*e;for(u=0;u<e;u++){x=1;if(q==d.length-2)x=0;else if(u==e-1)x=f*e-u;x=[r+u,r+e+u,r+e+u+x,r+u,r+u+x,r+e+u+x];
if(u!=e-1)for(w=0;w<6;w++)n.push(x[w]);if(u==e-2&&q<d.length-3){w=f*e-u;x[2]+=w;x[4]+=w;x[5]+=w}for(w=0;w<6;w++)j.push(x[w]);if(G)for(w=0;w<6;w++)G.push(x[w])}}this.segments.push(new h(this,d[q+1].name,n))}G&&this.cartoonSegments.push(new h(this,null,G));this.storeData(k,m,j);this.render=function(B,I){this.bindBuffers(B);var E=I.macro_colorByChain?this.chainColor:null;E||(E=this.front?I.proteins_primaryColor:I.proteins_secondaryColor);B.material.setDiffuseColor(E);B.drawElements(B.TRIANGLES,this.vertexIndexBuffer.numItems,
B.UNSIGNED_SHORT,0)};return true};a.Ribbon.prototype=new a._Mesh})(ChemDoodle.RESIDUE,ChemDoodle.structures,Math,vec3);
(function(b,a,l){a.Light=function(g,h,d){this.diffuseRGB=b.getRGB(g,1);this.specularRGB=b.getRGB(h,1);this.direction=d;this.lightScene=function(j){j.uniform3f(j.getUniformLocation(j.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]);j.uniform3f(j.getUniformLocation(j.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var c=l.create(this.direction);l.normalize(c);l.negate(c);j.uniform3f(j.getUniformLocation(j.program,
"u_light.direction"),c[0],c[1],c[2]);var f=[0,0,0];c=[f[0]+c[0],f[1]+c[1],f[2]+c[2]];f=l.length(c);if(f==0)c=[0,0,1];else l.scale(1/f);j.uniform3f(j.getUniformLocation(j.program,"u_light.half_vector"),c[0],c[1],c[2])};return true}})(ChemDoodle.math,ChemDoodle.structures,vec3);(function(b){b.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0]);return true};b.Line.prototype=new b._Mesh})(ChemDoodle.structures);
(function(b,a){a.Material=function(l){var g=l.getUniformLocation(l.program,"u_material.ambient_color"),h=l.getUniformLocation(l.program,"u_material.diffuse_color"),d=l.getUniformLocation(l.program,"u_material.specular_color"),j=l.getUniformLocation(l.program,"u_material.shininess"),c=l.getUniformLocation(l.program,"u_material.alpha");this.setTempColors=function(f,e,k,m){if(!this.aCache||this.aCache!=f){this.aCache=f;f=b.getRGB(f,1);l.uniform3f(g,f[0],f[1],f[2])}if(e!=null&&(!this.dCache||this.dCache!=
e)){this.dCache=e;f=b.getRGB(e,1);l.uniform3f(h,f[0],f[1],f[2])}if(!this.sCache||this.sCache!=k){this.sCache=k;f=b.getRGB(k,1);l.uniform3f(d,f[0],f[1],f[2])}if(!this.snCache||this.snCache!=m){this.snCache=m;l.uniform1f(j,m)}this.alCache=1;l.uniform1f(c,1)};this.setDiffuseColor=function(f){if(!this.dCache||this.dCache!=f){this.dCache=f;f=b.getRGB(f,1);l.uniform3f(h,f[0],f[1],f[2])}};this.setAlpha=function(f){if(!this.alCache||this.alCache!=f){this.alCache=f;l.uniform1f(c,f)}};return true}})(ChemDoodle.math,
ChemDoodle.structures);
(function(b,a,l){b.MolecularSurface=function(g,h,d,j,c){function f(B,I,E,K){var L=B.index;if(B.contained){L=-1;for(var M=Infinity,F=0,H=I.length;F<H;F++)for(var N=I[F],J=0,P=N.length;J<P;J++){var Q=N[J];if(!Q.contained&&Q.index!=E&&Q.index!=K){var O=Q.distance3D(B);if(O<M){L=Q.index;M=O}}}}return L}for(var e=[],k=[],m=[],q=[],p=0;p<=h;p++){var n=p*l.PI/h,t=l.sin(n),v=l.cos(n);for(n=0;n<=d;n++){var r=n*2*l.PI/d;q.push(l.cos(r)*t,v,l.sin(r)*t)}}t=[];p=0;for(n=g.atoms.length;p<n;p++){v=[];var x=g.atoms[p],
u=a[x.label][c]+j,w=[];r=0;for(var z=g.atoms.length;r<z;r++)if(r!=p){var A=g.atoms[r];A.index=r;x.distance3D(A)<u+a[A.label][c]+j&&w.push(A)}r=0;for(z=q.length;r<z;r+=3){for(var C=new b.Atom("C",x.x+u*q[r],x.y+u*q[r+1],x.z+u*q[r+2]),D=0,G=w.length;D<G;D++){A=w[D];if(C.distance3D(A)<a[A.label][c]+j){C.contained=true;break}}v.push(C)}t.push(v)}g=[];d++;for(p=0;p<h;p++)for(n=0;n<d;n++){c=p*d+n%d;j=c+d;g.push(c);g.push(j);g.push(c+1);if(n<d-1){g.push(j);g.push(j+1);g.push(c+1)}}p=D=0;for(n=t.length;p<
n;p++){v=t[p];r=0;for(z=v.length;r<z;r++){C=v[r];if(!C.contained){C.index=D;D++;e.push(C.x,C.y,C.z);k.push(q[r*3],q[r*3+1],q[r*3+2])}}r=0;for(z=g.length;r<z;r+=3){c=v[g[r]];j=v[g[r+1]];C=v[g[r+2]];!c.contained&&!j.contained&&!C.contained&&m.push(c.index,j.index,C.index)}}q=[];p=0;for(n=t.length;p<n;p++){v=t[p];r=0;for(z=g.length;r<z;r+=3){c=v[g[r]];j=v[g[r+1]];C=v[g[r+2]];w=[];D=0;for(G=t.length;D<G;D++)D!=p&&w.push(t[D]);if(!(c.contained&&j.contained&&C.contained)&&(c.contained||j.contained||C.contained)){h=
f(c,w,-1,-1);d=f(j,w,h,-1);w=f(C,w,h,d);if(h!=-1&&d!=-1&&w!=-1){j=false;D=0;for(G=q.length;D<G;D+=3){c=q[D];C=q[D+1];x=q[D+2];u=d==c||d==C||d==x;A=w==c||w==C||w==x;if((h==c||h==C||h==x)&&u&&A){j=true;break}}j||q.push(h,d,w)}}}}m=m.concat(q);this.storeData(e,k,m);return true};b.MolecularSurface.prototype=new b._Mesh})(ChemDoodle.structures,ChemDoodle.ELEMENT,Math);
(function(b,a){b.Shader=function(){this.init=function(l){var g=this.getShader(l,"vertex-shader");if(g==null)g=this.loadDefaultVertexShader(l);var h=this.getShader(l,"fragment-shader");if(h==null)h=this.loadDefaultFragmentShader(l);l.attachShader(l.program,g);l.attachShader(l.program,h);l.linkProgram(l.program);l.getProgramParameter(l.program,l.LINK_STATUS)||alert("Could not initialize shaders: "+l.getProgramInfoLog(program));l.useProgram(l.program);this.vertexPositionAttribute=l.getAttribLocation(l.program,
"a_vertex_position");l.enableVertexAttribArray(this.vertexPositionAttribute);this.vertexNormalAttribute=l.getAttribLocation(l.program,"a_vertex_normal");l.enableVertexAttribArray(this.vertexNormalAttribute)};this.getShader=function(l,g){var h=a.getElementById(g);if(!h)return null;for(var d=[],j=h.firstChild;j;){j.nodeType==3&&d.push(j.textContent);j=j.nextSibling}if(h.type=="x-shader/x-fragment")j=l.createShader(l.FRAGMENT_SHADER);else if(h.type=="x-shader/x-vertex")j=l.createShader(l.VERTEX_SHADER);
else return null;l.shaderSource(j,d.join(""));l.compileShader(j);if(!l.getShaderParameter(j,l.COMPILE_STATUS)){alert(h.type+" "+l.getShaderInfoLog(j));return null}return j};this.loadDefaultVertexShader=function(l){var g=[];g.push("struct Light");g.push("{");g.push("vec3 diffuse_color;");g.push("vec3 specular_color;");g.push("vec3 direction;");g.push("vec3 half_vector;");g.push("};");g.push("struct Material");g.push("{");g.push("vec3 ambient_color;");g.push("vec3 diffuse_color;");g.push("vec3 specular_color;");
g.push("float shininess;");g.push("float alpha;");g.push("};");g.push("attribute vec3 a_vertex_position;");g.push("attribute vec3 a_vertex_normal;");g.push("uniform Light u_light;");g.push("uniform Material u_material;");g.push("uniform mat4 u_model_view_matrix;");g.push("uniform mat4 u_projection_matrix;");g.push("uniform mat3 u_normal_matrix;");g.push("varying vec4 v_diffuse;");g.push("varying vec4 v_ambient;");g.push("varying vec3 v_normal;");g.push("varying vec3 v_light_direction;");g.push("void main(void)");
g.push("{");g.push("if(length(a_vertex_normal)==0.0){");g.push("v_normal = a_vertex_normal;");g.push("}else{");g.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);");g.push("}");g.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);");g.push("v_light_direction = u_light.direction;");g.push("v_ambient = vec4(u_material.ambient_color, 1.0);");g.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;");g.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);");
g.push("}");var h=l.createShader(l.VERTEX_SHADER);l.shaderSource(h,g.join(""));l.compileShader(h);if(!l.getShaderParameter(h,l.COMPILE_STATUS)){alert("Vertex shader failed to compile: "+l.getShaderInfoLog(h));return null}return h};this.loadDefaultFragmentShader=function(l){var g=[];g.push("precision mediump float;\n");g.push("struct Light");g.push("{");g.push("vec3 diffuse_color;");g.push("vec3 specular_color;");g.push("vec3 direction;");g.push("vec3 half_vector;");g.push("};");g.push("struct Material");
g.push("{");g.push("vec3 ambient_color;");g.push("vec3 diffuse_color;");g.push("vec3 specular_color;");g.push("float shininess;");g.push("float alpha;");g.push("};");g.push("uniform Light u_light;");g.push("uniform Material u_material;");g.push("varying vec4 v_diffuse;");g.push("varying vec4 v_ambient;");g.push("varying vec3 v_normal;");g.push("varying vec3 v_light_direction;");g.push("void main(void)");g.push("{");g.push("if(length(v_normal)==0.0){");g.push("gl_FragColor = vec4(v_diffuse.rgba);");
g.push("}else{");g.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);");g.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);");g.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);");g.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);");g.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);");g.push("gl_FragColor = color+v_ambient;");g.push("gl_FragColor.a*=u_material.alpha;");g.push("}");g.push("}");
var h=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(h,g.join(""));l.compileShader(h);if(!l.getShaderParameter(h,l.COMPILE_STATUS)){alert("Fragment shader failed to compile: "+l.getShaderInfoLog(h));return null}return h};return true}})(ChemDoodle.structures,document);
(function(b,a){b.Shape=function(l,g){for(var h=l.length,d=[],j=[],c=new b.Point,f=0,e=h;f<e;f++){var k=f+1;if(f==e-1)k=0;var m=l[f];k=l[k];for(var q=a.cross([0,0,1],[k.x-m.x,k.y-m.y,0]),p=0;p<2;p++){d.push(m.x,m.y,g/2);d.push(m.x,m.y,-g/2);d.push(k.x,k.y,g/2);d.push(k.x,k.y,-g/2)}for(p=0;p<4;p++)j.push(q[0],q[1],q[2]);j.push(0,0,1);j.push(0,0,-1);j.push(0,0,1);j.push(0,0,-1);c.add(m)}c.x/=h;c.y/=h;j.push(0,0,1);d.push(c.x,c.y,g/2);j.push(0,0,-1);d.push(c.x,c.y,-g/2);c=[];m=h*8;f=0;for(e=h;f<e;f++){h=
f*8;c.push(h);c.push(h+1);c.push(h+3);c.push(h);c.push(h+2);c.push(h+3);c.push(h+4);c.push(h+6);c.push(m);c.push(h+5);c.push(h+7);c.push(m+1)}this.storeData(d,j,c);return true};b.Shape.prototype=new b._Mesh})(ChemDoodle.structures,vec3);
(function(b,a,l){b.Star=function(){for(var g=[0.8944,0.4472,0,0.2764,0.4472,0.8506,0.2764,0.4472,-0.8506,-0.7236,0.4472,0.5257,-0.7236,0.4472,-0.5257,-0.3416,0.4472,0,-0.1056,0.4472,0.3249,-0.1056,0.4472,-0.3249,0.2764,0.4472,0.2008,0.2764,0.4472,-0.2008,-0.8944,-0.4472,0,-0.2764,-0.4472,0.8506,-0.2764,-0.4472,-0.8506,0.7236,-0.4472,0.5257,0.7236,-0.4472,-0.5257,0.3416,-0.4472,0,0.1056,-0.4472,0.3249,0.1056,-0.4472,-0.3249,-0.2764,-0.4472,0.2008,-0.2764,-0.4472,-0.2008,-0.5527,0.1058,0,-0.1708,0.1058,
0.5527,-0.1708,0.1058,-0.5527,0.4471,0.1058,0.3249,0.4471,0.1058,-0.3249,0.5527,-0.1058,0,0.1708,-0.1058,0.5527,0.1708,-0.1058,-0.5527,-0.4471,-0.1058,0.3249,-0.4471,-0.1058,-0.3249,0,1,0,0,-1,0],h=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,
10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],j=[],c=[],f=0,e=h.length;f<e;f+=3){var k=h[f]*3,m=h[f+1]*3,q=h[f+2]*3;k=[g[k],g[k+1],g[k+2]];m=[g[m],g[m+1],g[m+2]];q=[g[q],g[q+1],g[q+2]];var p=l.cross([q[0]-m[0],q[1]-m[1],q[2]-m[2]],[k[0]-m[0],k[1]-m[1],k[2]-m[2]],[]);l.normalize(p);d.push(k[0],k[1],k[2],m[0],m[1],m[2],q[0],q[1],q[2]);j.push(p[0],p[1],p[2],p[0],
p[1],p[2],p[0],p[1],p[2]);c.push(f,f+1,f+2)}this.storeData(d,j,c);return true};b.Star.prototype=new b._Mesh})(ChemDoodle.structures,Math,vec3);
(function(b,a,l,g,h,d){var j=function(c,f,e){var k=g.sqrt(f[1]*f[1]+f[2]*f[2]),m=[1,0,0,0,0,f[2]/k,-f[1]/k,0,0,f[1]/k,f[2]/k,0,0,0,0,1],q=[1,0,0,0,0,f[2]/k,f[1]/k,0,0,-f[1]/k,f[2]/k,0,0,0,0,1],p=[k,0,-f[0],0,0,1,0,0,f[0],0,k,0,0,0,0,1];f=[k,0,f[0],0,0,1,0,0,-f[0],0,k,0,0,0,0,1];e=[g.cos(e),-g.sin(e),0,0,g.sin(e),g.cos(e),0,0,0,0,1,0,0,0,0,1];var n=h.multiply(m,h.multiply(p,h.multiply(e,h.multiply(f,q,[]))));this.rotate=function(){return h.multiplyVec3(n,c)}};l.Tube=function(c,f,e){var k=c[0].lineSegments[0].length,
m=[],q=[];this.ends=[];this.ends.push(c[0].lineSegments[0][0]);this.ends.push(c[c.length-2].lineSegments[0][0]);for(var p=[1,0,0],n=0,t=c.length-1;n<t;n++)for(var v=c[n],r=Infinity,x=new l.Atom("",c[n+1].cp1.x,c[n+1].cp1.y,c[n+1].cp1.z),u=0;u<k;u++){var w=v.lineSegments[0][u],z=null;z=u==k-1?n==c.length-2?v.lineSegments[0][u-1]:c[n+1].lineSegments[0][0]:v.lineSegments[0][u+1];z=[z.x-w.x,z.y-w.y,z.z-w.z];d.normalize(z);n==c.length-2&&u==k-1&&d.scale(z,-1);var A=vec3.cross(z,p,[]);d.normalize(A);d.scale(A,
f/2);A=new j(A,z,2*Math.PI/e);z=0;for(var C=e;z<C;z++){var D=A.rotate();if(z==g.floor(e/4))p=[D[0],D[1],D[2]];q.push(D[0],D[1],D[2]);m.push(w.x+D[0],w.y+D[1],w.z+D[2])}if(x!=null){z=w.distance3D(x);if(z<r){r=z;c[n+1].pPoint=w}}}p=[];n=0;for(t=c.length-2;n<t;n++){v=n*k*e;u=0;for(r=k;u<r;u++){x=v+u*e;for(z=0;z<e;z++){if(z==e-1)nextRes=n==c.length-2?0:-z;w=x+z;p.push(w);p.push(w+e);p.push(w+e+1);p.push(w);p.push(w+1);p.push(w+e+1)}}}this.storeData(m,q,p);e=[new l.Point(2,0)];for(n=0;n<60;n++){k=n/60*
g.PI;e.push(new l.Point(2*g.cos(k),-2*g.sin(k)))}e.push(new l.Point(-2,0),new l.Point(-2,4),new l.Point(2,4));var G=new l.Shape(e,1);this.render=function(B,I){this.bindBuffers(B);B.material.setDiffuseColor(I.macro_colorByChain?this.chainColor:I.nucleics_tubeColor);B.drawElements(B.TRIANGLES,this.vertexIndexBuffer.numItems,B.UNSIGNED_SHORT,0);B.sphereBuffer.bindBuffers(B);for(var E=0;E<2;E++){var K=this.ends[E];K=h.translate(B.modelViewMatrix,[K.x,K.y,K.z],[]);var L=f/2;h.scale(K,[L,L,L]);B.setMatrixUniforms(K);
B.drawElements(B.TRIANGLES,B.sphereBuffer.vertexIndexBuffer.numItems,B.UNSIGNED_SHORT,0)}B.cylinderBuffer.bindBuffers(B);E=1;for(L=c.length-1;E<L;E++){var M=c[E],F=M.pPoint,H=new l.Atom("",M.cp2.x,M.cp2.y,M.cp2.z);K=1.001*F.distance3D(H);M=[f/4,K,f/4];K=h.translate(B.modelViewMatrix,[F.x,F.y,F.z],[]);var N=[0,1,0],J=0,P=null,Q=[H.x-F.x,H.y-F.y,H.z-F.z];if(F.x==H.x&&F.z==H.z){P=[0,0,1];if(F.y<F.y)J=g.PI}else{J=b.vec3AngleFrom(N,Q);P=d.cross(N,Q,[])}J!=0&&h.rotate(K,J,P);h.scale(K,M);B.setMatrixUniforms(K);
B.drawArrays(B.TRIANGLE_STRIP,0,B.cylinderBuffer.vertexPositionBuffer.numItems)}G.bindBuffers(B);!I.nucleics_useShapelyColors&&!I.macro_colorByChain&&B.material.setDiffuseColor(I.nucleics_baseColor);E=1;for(L=c.length-1;E<L;E++){M=c[E];H=M.cp2;K=h.translate(B.modelViewMatrix,[H.x,H.y,H.z],[]);N=[0,1,0];J=0;F=M.cp3;Q=[F.x-H.x,F.y-H.y,F.z-H.z];if(H.x==F.x&&H.z==F.z){P=[0,0,1];if(H.y<H.y)J=g.PI}else{J=b.vec3AngleFrom(N,Q);P=d.cross(N,Q,[])}J!=0&&h.rotate(K,J,P);H=[1,0,0];J=h.rotate(h.identity([]),J,
P);h.multiplyVec3(J,H);J=M.cp4;F=M.cp5;if(!(J.y==F.y&&J.z==F.z)){J=[F.x-J.x,F.y-J.y,F.z-J.z];F=b.vec3AngleFrom(H,J);if(d.dot(Q,d.cross(H,J))<0)F*=-1;h.rotateY(K,F)}if(I.nucleics_useShapelyColors&&!I.macro_colorByChain)a[M.name]?B.material.setDiffuseColor(a[M.name].shapelyColor):B.material.setDiffuseColor(a["*"].shapelyColor);B.setMatrixUniforms(K);B.drawElements(B.TRIANGLES,G.vertexIndexBuffer.numItems,B.UNSIGNED_SHORT,0)}};return true};l.Tube.prototype=new l._Mesh})(ChemDoodle.extensions,ChemDoodle.RESIDUE,
ChemDoodle.structures,Math,mat4,vec3);
(function(b){b.UnitCell=function(a){var l=[],g=[],h=function(j,c,f,e){l.push(j[0],j[1],j[2]);l.push(c[0],c[1],c[2]);l.push(f[0],f[1],f[2]);l.push(e[0],e[1],e[2]);for(j=0;j<4;j++)g.push(0,0,0)};h(a.o,a.x,a.xy,a.y);h(a.o,a.y,a.yz,a.z);h(a.o,a.z,a.xz,a.x);h(a.yz,a.y,a.xy,a.xyz);h(a.xyz,a.xz,a.z,a.yz);h(a.xy,a.x,a.xz,a.xyz);a=[];for(h=0;h<6;h++){var d=h*4;a.push(d,d+1,d+1,d+2,d+2,d+3,d+3,d)}this.storeData(l,g,a);return true};b.UnitCell.prototype=new b._Mesh})(ChemDoodle.structures,vec3);
(function(b,a,l){b.Plate=function(g){this.lanes=Array(g);i=0;for(ii=g;i<ii;i++)this.lanes[i]=[];this.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(h,d){return h-d})};this.draw=function(h){var d=h.canvas.width,j=h.canvas.height;this.origin=9*j/10;this.front=j/10;this.laneLength=this.origin-this.front;h.strokeStyle="#000000";h.beginPath();h.moveTo(0,this.front);a.contextHashTo(h,0,this.front,d,this.front,3,3);h.closePath();h.stroke();h.beginPath();h.moveTo(0,this.origin);
h.lineTo(d,this.origin);h.closePath();h.stroke();i=0;for(ii=this.lanes.length;i<ii;i++){j=(i+1)*d/(ii+1);h.beginPath();h.moveTo(j,this.origin);h.lineTo(j,this.origin+3);h.closePath();h.stroke();s=0;for(ss=this.lanes[i].length;s<ss;s++){var c=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":h.beginPath();h.arc(j,c,3,0,2*l.PI,false);h.closePath();break;case "expanded":h.beginPath();h.arc(j,c,7,0,2*l.PI,false);h.closePath();break;case "trailing":break;case "widened":a.contextOval(h,
j-18,c-10,36,10);break;case "cresent":h.beginPath();h.arc(j,c,9,0,l.PI,true);h.closePath();break}switch(this.lanes[i][s].style){case "solid":h.fillStyle="#000000";h.fill();break;case "transparent":h.stroke();break;case "gradient":break}}}};return true};b.Plate.Spot=function(g,h,d){this.type=g;this.rf=h;this.style=d?d:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(b,a,l){b.default_backgroundColor="#FFFFFF";b.default_scale=1;b.default_rotateAngle=0;b.default_bondLength_2D=20;b.default_angstromsPerBondLength=1.25;b.default_lightDirection_3D=[-0.1,-0.1,-1];b.default_lightDiffuseColor_3D="#FFFFFF";b.default_lightSpecularColor_3D="#FFFFFF";b.default_projectionPerspective_3D=true;b.default_projectionPerspectiveVerticalFieldOfView_3D=45;b.default_projectionOrthoWidth_3D=40;b.default_projectionWidthHeightRatio_3D=1;b.default_projectionFrontCulling_3D=0.1;
b.default_projectionBackCulling_3D=1E4;b.default_atoms_display=true;b.default_atoms_color="#000000";b.default_atoms_font_size_2D=12;b.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"];b.default_atoms_font_bold_2D=false;b.default_atoms_font_italic_2D=false;b.default_atoms_circles_2D=false;b.default_atoms_circleDiameter_2D=10;b.default_atoms_circleBorderWidth_2D=1;b.default_atoms_useJMOLColors=false;b.default_atoms_resolution_3D=60;b.default_atoms_sphereDiameter_3D=0.8;b.default_atoms_useVDWDiameters_3D=
false;b.default_atoms_vdwMultiplier_3D=1;b.default_atoms_materialAmbientColor_3D="#000000";b.default_atoms_materialSpecularColor_3D="#555555";b.default_atoms_materialShininess_3D=32;b.default_atoms_implicitHydrogens_2D=true;b.default_atoms_displayTerminalCarbonLabels_2D=false;b.default_atoms_showHiddenCarbons_2D=true;b.default_atoms_displayAllCarbonLabels_2D=false;b.default_atoms_nonBondedAsStars_3D=false;b.default_bonds_display=true;b.default_bonds_color="#000000";b.default_bonds_width_2D=1;b.default_bonds_saturationWidth_2D=
0.2;b.default_bonds_ends_2D="round";b.default_bonds_useJMOLColors=false;b.default_bonds_colorGradient=false;b.default_bonds_saturationAngle_2D=l.PI/3;b.default_bonds_symmetrical_2D=false;b.default_bonds_clearOverlaps_2D=false;b.default_bonds_overlapClearWidth_2D=0.5;b.default_bonds_atomLabelBuffer_2D=0.25;b.default_bonds_wedgeThickness_2D=0.22;b.default_bonds_hashWidth_2D=1;b.default_bonds_hashSpacing_2D=2.5;b.default_bonds_showBondOrders_3D=false;b.default_bonds_resolution_3D=60;b.default_bonds_renderAsLines_3D=
false;b.default_bonds_cylinderDiameter_3D=0.3;b.default_bonds_materialAmbientColor_3D="#222222";b.default_bonds_materialSpecularColor_3D="#555555";b.default_bonds_materialShininess_3D=32;b.default_proteins_displayRibbon=true;b.default_proteins_displayBackbone=false;b.default_proteins_backboneThickness=1.5;b.default_proteins_backboneColor="#CCCCCC";b.default_proteins_ribbonCartoonize=false;b.default_proteins_useShapelyColors=false;b.default_proteins_useAminoColors=false;b.default_proteins_usePolarityColors=
false;b.default_proteins_primaryColor="#FF0D0D";b.default_proteins_secondaryColor="#FFFF30";b.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740";b.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF";b.default_proteins_ribbonCartoonSheetColor="#E8BB99";b.default_proteins_ribbonThickness=0.2;b.default_proteins_materialAmbientColor_3D="#222222";b.default_proteins_materialSpecularColor_3D="#555555";b.default_proteins_materialShininess_3D=32;b.default_nucleics_display=true;b.default_nucleics_tubeColor=
"#CCCCCC";b.default_nucleics_baseColor="#C10000";b.default_nucleics_useShapelyColors=true;b.default_nucleics_tubeThickness=1.5;b.default_nucleics_tubeResolution_3D=60;b.default_nucleics_materialAmbientColor_3D="#222222";b.default_nucleics_materialSpecularColor_3D="#555555";b.default_nucleics_materialShininess_3D=32;b.default_macro_displayAtoms=false;b.default_macro_displayBonds=false;b.default_macro_atomToLigandDistance=-1;b.default_macro_showWater=false;b.default_macro_colorByChain=false;b.default_surfaces_display=
true;b.default_surfaces_style="Dot";b.default_surfaces_color="#E9B862";b.default_surfaces_materialAmbientColor_3D="#000000";b.default_surfaces_materialSpecularColor_3D="#000000";b.default_surfaces_materialShininess_3D=32;b.default_crystals_displayUnitCell=true;b.default_crystals_unitCellColor="green";b.default_crystals_unitCellLineWidth=1;b.default_plots_color="#000000";b.default_plots_width=1;b.default_plots_showIntegration=false;b.default_plots_integrationColor="#c10000";b.default_plots_integrationLineWidth=
1;b.default_plots_showGrid=false;b.default_plots_gridColor="gray";b.default_plots_gridLineWidth=0.5;b.default_plots_showYAxis=true;b.default_plots_flipXAxis=false;b.default_text_font_size=12;b.default_text_font_families=["Helvetica","Arial","Dialog"];b.default_text_color="#000000";a.VisualSpecifications=function(){this.backgroundColor=b.default_backgroundColor;this.scale=b.default_scale;this.rotateAngle=b.default_rotateAngle;this.bondLength=b.default_bondLength_2D;this.angstromsPerBondLength=b.default_angstromsPerBondLength;
this.lightDirection_3D=b.default_lightDirection_3D;this.lightDiffuseColor_3D=b.default_lightDiffuseColor_3D;this.lightSpecularColor_3D=b.default_lightSpecularColor_3D;this.projectionPerspective_3D=b.default_projectionPerspective_3D;this.projectionPerspectiveVerticalFieldOfView_3D=b.default_projectionPerspectiveVerticalFieldOfView_3D;this.projectionOrthoWidth_3D=b.default_projectionOrthoWidth_3D;this.projectionWidthHeightRatio_3D=b.default_projectionWidthHeightRatio_3D;this.projectionFrontCulling_3D=
b.default_projectionFrontCulling_3D;this.projectionBackCulling_3D=b.default_projectionBackCulling_3D;this.atoms_display=b.default_atoms_display;this.atoms_color=b.default_atoms_color;this.atoms_font_size_2D=b.default_atoms_font_size_2D;this.atoms_font_families_2D=[];for(var g=0,h=b.default_atoms_font_families_2D.length;g<h;g++)this.atoms_font_families_2D[g]=b.default_atoms_font_families_2D[g];this.atoms_font_bold_2D=b.default_atoms_font_bold_2D;this.atoms_font_italic_2D=b.default_atoms_font_italic_2D;
this.atoms_circles_2D=b.default_atoms_circles_2D;this.atoms_circleDiameter_2D=b.default_atoms_circleDiameter_2D;this.atoms_circleBorderWidth_2D=b.default_atoms_circleBorderWidth_2D;this.atoms_useJMOLColors=b.default_atoms_useJMOLColors;this.atoms_resolution_3D=b.default_atoms_resolution_3D;this.atoms_sphereDiameter_3D=b.default_atoms_sphereDiameter_3D;this.atoms_useVDWDiameters_3D=b.default_atoms_useVDWDiameters_3D;this.atoms_vdwMultiplier_3D=b.default_atoms_vdwMultiplier_3D;this.atoms_materialAmbientColor_3D=
b.default_atoms_materialAmbientColor_3D;this.atoms_materialSpecularColor_3D=b.default_atoms_materialSpecularColor_3D;this.atoms_materialShininess_3D=b.default_atoms_materialShininess_3D;this.atoms_implicitHydrogens_2D=b.default_atoms_implicitHydrogens_2D;this.atoms_displayTerminalCarbonLabels_2D=b.default_atoms_displayTerminalCarbonLabels_2D;this.atoms_showHiddenCarbons_2D=b.default_atoms_showHiddenCarbons_2D;this.atoms_displayAllCarbonLabels_2D=b.default_atoms_displayAllCarbonLabels_2D;this.atoms_nonBondedAsStars_3D=
b.default_atoms_nonBondedAsStars_3D;this.bonds_display=b.default_bonds_display;this.bonds_color=b.default_bonds_color;this.bonds_width_2D=b.default_bonds_width_2D;this.bonds_saturationWidth_2D=b.default_bonds_saturationWidth_2D;this.bonds_ends_2D=b.default_bonds_ends_2D;this.bonds_useJMOLColors=b.default_bonds_useJMOLColors;this.bonds_colorGradient=b.default_bonds_colorGradient;this.bonds_saturationAngle_2D=b.default_bonds_saturationAngle_2D;this.bonds_symmetrical_2D=b.default_bonds_symmetrical_2D;
this.bonds_clearOverlaps_2D=b.default_bonds_clearOverlaps_2D;this.bonds_overlapClearWidth_2D=b.default_bonds_overlapClearWidth_2D;this.bonds_atomLabelBuffer_2D=b.default_bonds_atomLabelBuffer_2D;this.bonds_wedgeThickness_2D=b.default_bonds_wedgeThickness_2D;this.bonds_hashWidth_2D=b.default_bonds_hashWidth_2D;this.bonds_hashSpacing_2D=b.default_bonds_hashSpacing_2D;this.bonds_showBondOrders_3D=b.default_bonds_showBondOrders_3D;this.bonds_resolution_3D=b.default_bonds_resolution_3D;this.bonds_renderAsLines_3D=
b.default_bonds_renderAsLines_3D;this.bonds_cylinderDiameter_3D=b.default_bonds_cylinderDiameter_3D;this.bonds_materialAmbientColor_3D=b.default_bonds_materialAmbientColor_3D;this.bonds_materialSpecularColor_3D=b.default_bonds_materialSpecularColor_3D;this.bonds_materialShininess_3D=b.default_bonds_materialShininess_3D;this.proteins_displayRibbon=b.default_proteins_displayRibbon;this.proteins_displayBackbone=b.default_proteins_displayBackbone;this.proteins_backboneThickness=b.default_proteins_backboneThickness;
this.proteins_backboneColor=b.default_proteins_backboneColor;this.proteins_ribbonCartoonize=b.default_proteins_ribbonCartoonize;this.proteins_useShapelyColors=b.default_proteins_useShapelyColors;this.proteins_useAminoColors=b.default_proteins_useAminoColors;this.proteins_usePolarityColors=b.default_proteins_usePolarityColors;this.proteins_primaryColor=b.default_proteins_primaryColor;this.proteins_secondaryColor=b.default_proteins_secondaryColor;this.proteins_ribbonCartoonHelixPrimaryColor=b.default_proteins_ribbonCartoonHelixPrimaryColor;
this.proteins_ribbonCartoonHelixSecondaryColor=b.default_proteins_ribbonCartoonHelixSecondaryColor;this.proteins_ribbonCartoonSheetColor=b.default_proteins_ribbonCartoonSheetColor;this.proteins_ribbonThickness=b.default_proteins_ribbonThickness;this.proteins_materialAmbientColor_3D=b.default_proteins_materialAmbientColor_3D;this.proteins_materialSpecularColor_3D=b.default_proteins_materialSpecularColor_3D;this.proteins_materialShininess_3D=b.default_proteins_materialShininess_3D;this.macro_displayAtoms=
b.default_macro_displayAtoms;this.macro_displayBonds=b.default_macro_displayBonds;this.macro_atomToLigandDistance=b.default_macro_atomToLigandDistance;this.nucleics_display=b.default_nucleics_display;this.nucleics_tubeColor=b.default_nucleics_tubeColor;this.nucleics_baseColor=b.default_nucleics_baseColor;this.nucleics_useShapelyColors=b.default_nucleics_useShapelyColors;this.nucleics_tubeThickness=b.default_nucleics_tubeThickness;this.nucleics_tubeResolution_3D=b.default_nucleics_tubeResolution_3D;
this.nucleics_materialAmbientColor_3D=b.default_nucleics_materialAmbientColor_3D;this.nucleics_materialSpecularColor_3D=b.default_nucleics_materialSpecularColor_3D;this.nucleics_materialShininess_3D=b.default_nucleics_materialShininess_3D;this.macro_showWater=b.default_macro_showWater;this.macro_colorByChain=b.default_macro_colorByChain;this.surfaces_display=b.default_surfaces_display;this.surfaces_style=b.default_surfaces_style;this.surfaces_color=b.default_surfaces_color;this.surfaces_materialAmbientColor_3D=
b.default_surfaces_materialAmbientColor_3D;this.surfaces_materialSpecularColor_3D=b.default_surfaces_materialSpecularColor_3D;this.surfaces_materialShininess_3D=b.default_surfaces_materialShininess_3D;this.crystals_displayUnitCell=b.default_crystals_displayUnitCell;this.crystals_unitCellColor=b.default_crystals_unitCellColor;this.crystals_unitCellLineWidth=b.default_crystals_unitCellLineWidth;this.plots_color=b.default_plots_color;this.plots_width=b.default_plots_width;this.plots_showIntegration=
b.default_plots_showIntegration;this.plots_integrationColor=b.default_plots_integrationColor;this.plots_integrationLineWidth=b.default_plots_integrationLineWidth;this.plots_showGrid=b.default_plots_showGrid;this.plots_gridColor=b.default_plots_gridColor;this.plots_gridLineWidth=b.default_plots_gridLineWidth;this.plots_showYAxis=b.default_plots_showYAxis;this.plots_flipXAxis=b.default_plots_flipXAxis;this.text_font_size=b.default_text_font_size;this.text_font_families=[];g=0;for(h=b.default_text_font_families.length;g<
h;g++)this.text_font_families[g]=b.default_text_font_families[g];this.text_color=b.default_text_color;this.set3DRepresentation=function(d){this.bonds_display=this.atoms_display=true;this.bonds_color="#777777";this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=true;this.bonds_renderAsLines_3D=false;if(d=="Ball and Stick"){this.atoms_vdwMultiplier_3D=0.3;this.bonds_useJMOLColors=false;this.bonds_cylinderDiameter_3D=0.3;this.bonds_materialAmbientColor_3D=
b.default_atoms_materialAmbientColor_3D}else if(d=="van der Waals Spheres"){this.bonds_display=false;this.atoms_vdwMultiplier_3D=1}else if(d=="Stick"){this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=false;this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=0.8;this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D}else if(d=="Wireframe"){this.atoms_useVDWDiameters_3D=false;this.bonds_cylinderDiameter_3D=0.05;this.atoms_sphereDiameter_3D=0.15;this.bonds_materialAmbientColor_3D=
b.default_atoms_materialAmbientColor_3D}else if(d=="Line"){this.atoms_display=false;this.bonds_renderAsLines_3D=true;this.bonds_width_2D=1;this.bonds_cylinderDiameter_3D=0.05}else alert('"'+d+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};this.getFontString=function(d,j,c,f){var e=[];c&&e.push("bold ");f&&e.push("italic ");e.push(d+"px ");d=0;for(c=j.length;d<c;d++){f=j[d];if(f.indexOf(" ")!=-1)f='"'+f+'"';
e.push((d!=0?",":"")+f)}return e.join("")}}})(ChemDoodle,ChemDoodle.structures,Math);
(function(b,a,l,g){l.getPointsPerAngstrom=function(){return b.default_bondLength_2D/b.default_angstromsPerBondLength};l.BondDeducer=function(){this.margin=1.1;this.deduceCovalentBonds=function(h,d){var j=l.getPointsPerAngstrom();if(d)j=d;for(var c=0,f=h.atoms.length;c<f;c++)for(var e=c+1;e<f;e++){var k=h.atoms[c],m=h.atoms[e];k.distance3D(m)<(a[k.label].covalentRadius+a[m.label].covalentRadius)*j*this.margin&&h.bonds.push(new g.Bond(k,m,1))}};return true}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,
ChemDoodle.structures);(function(b){b.HydrogenDeducer=function(){this.removeHydrogens=function(a){for(var l=[],g=[],h=0,d=a.bonds.length;h<d;h++)a.bonds[h].a1.label!="H"&&a.bonds[h].a2.label!="H"&&g.push(a.bonds[h]);h=0;for(d=a.atoms.length;h<d;h++)a.atoms[h].label!="H"&&l.push(a.atoms[h]);a.atoms=l;a.bonds=g};return true}})(ChemDoodle.informatics);
(function(b,a,l){a.MolecularSurfaceGenerator=function(){this.generateSurface=function(g,h,d,j,c){return new l.MolecularSurface(g,h,d,j,c)};return true}})(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures);
(function(b,a){b.Splitter=function(){this.split=function(l){for(var g=[],h=0,d=l.atoms.length;h<d;h++)l.atoms[h].visited=false;h=0;for(d=l.bonds.length;h<d;h++)l.bonds[h].visited=false;h=0;for(d=l.atoms.length;h<d;h++){var j=l.atoms[h];if(!j.visited){var c=new a.Molecule;c.atoms.push(j);j.visited=true;var f=new a.Queue;for(f.enqueue(j);!f.isEmpty();){j=f.dequeue();for(var e=0,k=l.bonds.length;e<k;e++){var m=l.bonds[e];if(m.contains(j)&&!m.visited){m.visited=true;c.bonds.push(m);m=m.getNeighbor(j);
if(!m.visited){m.visited=true;c.atoms.push(m);f.enqueue(m)}}}}g.push(c)}}return g};return true}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(b,a){b.StructureBuilder=function(){this.copy=function(l){for(var g=0,h=l.atoms.length;g<h;g++)l.atoms[g].metaID=g;var d=new a.Molecule;g=0;for(h=l.atoms.length;g<h;g++)d.atoms[g]=new a.Atom(l.atoms[g].label,l.atoms[g].x,l.atoms[g].y,l.atoms[g].z);g=0;for(h=l.bonds.length;g<h;g++)d.bonds[g]=new a.Bond(d.atoms[l.bonds[g].a1.metaID],d.atoms[l.bonds[g].a2.metaID],l.bonds[g].bondOrder);return d};return true}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(b){b._Counter=function(){this.value=0;this.molecule=null;this.setMolecule=function(a){this.value=0;this.molecule=a;this.innerCalculate&&this.innerCalculate()};return true}})(ChemDoodle.informatics);(function(b){b.FrerejacqueNumberCounter=function(a){this.setMolecule(a);return true};b.FrerejacqueNumberCounter.prototype=new b._Counter;b.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new b.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(b,a){a.NumberOfMoleculesCounter=function(l){this.setMolecule(l);return true};a.NumberOfMoleculesCounter.prototype=new a._Counter;a.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var l=0,g=this.molecule.atoms.length;l<g;l++)this.molecule.atoms[l].visited=false;l=0;for(g=this.molecule.atoms.length;l<g;l++)if(!this.molecule.atoms[l].visited){this.value++;var h=new b.Queue;this.molecule.atoms[l].visited=true;for(h.enqueue(this.molecule.atoms[l]);!h.isEmpty();)for(var d=h.dequeue(),
j=0,c=this.molecule.bonds.length;j<c;j++){var f=this.molecule.bonds[j];if(f.contains(d)){f=f.getNeighbor(d);if(!f.visited){f.visited=true;h.enqueue(f)}}}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(b,a){b._RingFinder=function(){this.rings=this.bonds=this.atoms=null;this.reduce=function(l){for(var g=0,h=l.atoms.length;g<h;g++)l.atoms[g].visited=false;g=0;for(h=l.bonds.length;g<h;g++)l.bonds[g].visited=false;for(var d=true;d;){d=false;g=0;for(h=l.atoms.length;g<h;g++){for(var j=0,c=null,f=0,e=l.bonds.length;f<e;f++)if(l.bonds[f].contains(l.atoms[g])&&!l.bonds[f].visited){j++;if(j==2)break;c=l.bonds[f]}if(j==1){d=true;c.visited=true;l.atoms[g].visited=true}}}g=0;for(h=l.atoms.length;g<
h;g++)l.atoms[g].visited||this.atoms.push(l.atoms[g]);g=0;for(h=l.bonds.length;g<h;g++)l.bonds[g].visited||this.bonds.push(l.bonds[g]);if(this.bonds.length==0&&this.atoms.length!=0)this.atoms=[]};this.setMolecule=function(l){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(l);this.atoms.length>2&&this.innerGetRings&&this.innerGetRings()};this.fuse=function(){for(var l=0,g=this.rings.length;l<g;l++)for(var h=0,d=this.bonds.length;h<d;h++)a(this.bonds[h].a1,this.rings[l].atoms)!=-1&&a(this.bonds[h].a2,
this.rings[l].atoms)!=-1&&this.rings[l].bonds.push(this.bonds[h])};return true}})(ChemDoodle.informatics,jQuery.inArray);
(function(b,a,l){function g(h,d){this.atoms=[];if(d)for(var j=0,c=d.atoms.length;j<c;j++)this.atoms[j]=d.atoms[j];this.atoms.push(h);this.grow=function(f,e){for(var k=this.atoms[this.atoms.length-1],m=[],q=0,p=f.length;q<p;q++)if(f[q].contains(k)){var n=f[q].getNeighbor(k);l(n,e)==-1&&m.push(n)}k=[];q=0;for(p=m.length;q<p;q++)k.push(new g(m[q],this));return k};this.check=function(f,e,k){for(var m=0,q=e.atoms.length-1;m<q;m++)if(l(e.atoms[m],this.atoms)!=-1)return null;var p=null;if(e.atoms[e.atoms.length-
1]==this.atoms[this.atoms.length-1]){p=new a.Ring;p.atoms[0]=k;m=0;for(q=this.atoms.length;m<q;m++)p.atoms.push(this.atoms[m]);for(m=e.atoms.length-2;m>=0;m--)p.atoms.push(e.atoms[m])}else{var n=[];m=0;for(q=f.length;m<q;m++)f[m].contains(e.atoms[e.atoms.length-1])&&n.push(f[m]);m=0;for(q=n.length;m<q;m++)if((e.atoms.length==1||!n[m].contains(e.atoms[e.atoms.length-2]))&&n[m].contains(this.atoms[this.atoms.length-1])){p=new a.Ring;p.atoms[0]=k;f=0;for(k=this.atoms.length;f<k;f++)p.atoms.push(this.atoms[f]);
for(f=e.atoms.length-1;f>=0;f--)p.atoms.push(e.atoms[f]);break}}return p};return true}b.EulerFacetRingFinder=function(h){this.fingerBreak=5;this.setMolecule(h);return true};b.EulerFacetRingFinder.prototype=new b._RingFinder;b.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var h=0,d=this.atoms.length;h<d;h++){for(var j=[],c=0,f=this.bonds.length;c<f;c++)this.bonds[c].contains(this.atoms[h])&&j.push(this.bonds[c].getNeighbor(this.atoms[h]));c=0;for(f=j.length;c<f;c++)for(var e=c+1;e<j.length;e++){var k=
[];k[0]=new g(j[c]);k[1]=new g(j[e]);var m=[];m[0]=this.atoms[h];for(var q=0,p=j.length;q<p;q++)q!=c&&q!=e&&m.push(j[q]);var n=[];if(q=k[0].check(this.bonds,k[1],this.atoms[h]))n[0]=q;for(;n.length==0&&k.length>0&&k[0].atoms.length<this.fingerBreak;){var t=[];q=0;for(p=k.length;q<p;q++)for(var v=k[q].grow(this.bonds,m),r=0,x=v.length;r<x;r++)t.push(v[r]);k=t;q=0;for(p=k.length;q<p;q++)for(r=q+1;r<p;r++)(x=k[q].check(this.bonds,k[r],this.atoms[h]))&&n.push(x);if(n.length==0){t=[];q=0;for(p=m.length;q<
p;q++){r=0;for(x=this.bonds.length;r<x;r++)if(this.bonds[r].contains(m[q])){j=this.bonds[r].getNeighbor(m[q]);l(j,m)==-1&&l(j,t)==-1&&t.push(j)}}q=0;for(p=t.length;q<p;q++)m.push(t[q])}}if(n.length>0){k=null;q=0;for(p=n.length;q<p;q++)if(!k||k.atoms.length>n[q].atoms.length)k=n[q];n=false;q=0;for(p=this.rings.length;q<p;q++){m=true;r=0;for(x=k.atoms.length;r<x;r++)if(l(k.atoms[r],this.rings[q].atoms)==-1){m=false;break}if(m){n=true;break}}n||this.rings.push(k)}}}this.fuse()}})(ChemDoodle.informatics,
ChemDoodle.structures,jQuery.inArray);
(function(b){b.SSSRFinder=function(a){this.rings=[];if(a.atoms.length>0){var l=(new b.FrerejacqueNumberCounter(a)).value,g=(new b.EulerFacetRingFinder(a)).rings;g.sort(function(f,e){return f.atoms.length-e.atoms.length});for(var h=0,d=a.bonds.length;h<d;h++)a.bonds[h].visited=false;h=0;for(d=g.length;h<d;h++){a=false;for(var j=0,c=g[h].bonds.length;j<c;j++)if(!g[h].bonds[j].visited){a=true;break}if(a){j=0;for(c=g[h].bonds.length;j<c;j++)g[h].bonds[j].visited=true;this.rings.push(g[h])}if(this.rings.length==
l)break}}return true}})(ChemDoodle.informatics);
(function(b,a,l,g,h,d){var j=/\s+/g,c=/\(|\)|\s+/g,f=/\'|\s+/g,e=/,|\'|\s+/g,k=/[0-9]/,m={P:[],A:[[0,0.5,0.5]],B:[[0.5,0,0.5]],C:[[0.5,0.5,0]],I:[[0.5,0.5,0.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,0.5,0.5],[0.5,0,0.5],[0.5,0.5,0]]},q=function(n){var t=0,v=0,r=0,x=0,u=n.indexOf("x"),w=n.indexOf("y"),z=n.indexOf("z");if(u!=-1){v++;if(u>0&&n.charAt(u-1)!="+")v*=-1}if(w!=-1){r++;if(w>0&&n.charAt(w-1)!="+")r*=-1}if(z!=-1){x++;if(z>0&&n.charAt(z-
1)!="+")x*=-1}if(n.length>2){u="+";w=0;for(z=n.length;w<z;w++){var A=n.charAt(w);if((A=="-"||A=="/")&&(w==n.length-1||n.charAt(w+1).match(k)))u=A;if(A.match(k))if(u=="+")t+=parseInt(A);else if(u=="-")t-=parseInt(A);else if(u=="/")t/=parseInt(A)}}return[t,v,r,x]};l.CIFInterpreter=function(){this.read=function(n,t,v,r){t=t?t:1;v=v?v:1;r=r?r:1;var x=new g.Molecule;if(n==null||n.length==0)return x;for(var u=n.split("\n"),w=0,z=0,A=0,C=n=0,D=0,G="P",B=null;!a.stringStartsWith(B=u.shift(),"loop_");)if(B.length>
0)if(a.stringStartsWith(B,"_cell_length_a"))w=parseFloat(B.split(c)[1]);else if(a.stringStartsWith(B,"_cell_length_b"))z=parseFloat(B.split(c)[1]);else if(a.stringStartsWith(B,"_cell_length_c"))A=parseFloat(B.split(c)[1]);else if(a.stringStartsWith(B,"_cell_angle_alpha"))n=h.PI*parseFloat(B.split(c)[1])/180;else if(a.stringStartsWith(B,"_cell_angle_beta"))C=h.PI*parseFloat(B.split(c)[1])/180;else if(a.stringStartsWith(B,"_cell_angle_gamma"))D=h.PI*parseFloat(B.split(c)[1])/180;else if(a.stringStartsWith(B,
"_symmetry_space_group_name_H-M"))G=B.split(f)[1];w=w;B=z;A=A;C=C;D=D;n=(h.cos(n)-h.cos(D)*h.cos(C))/h.sin(D);n=[w,0,0,0,B*h.cos(D),B*h.sin(D),0,0,A*h.cos(C),A*n,A*h.sqrt(1-h.pow(h.cos(C),2)-h.pow(n,2)),0,0,0,0,1];for(C=[];!a.stringStartsWith(B=u.shift(),"loop_");)B.length>0&&a.stringStartsWith(B,"'")&&C.push(B);for(;a.stringStartsWith(u[0],"_");)u.shift();D=0;for(w=u.length;D<w;D++){B=u[D];if(B.length==0)break;B=B.split(j);x.atoms.push(new g.Atom(B[2],parseFloat(B[3]),parseFloat(B[4]),parseFloat(B[5])))}var I=
m[G];B=[];D=0;for(w=C.length;D<w;D++){u=C[D].split(e);var E=q(u[1]),K=q(u[2]),L=q(u[3]);G=0;for(z=x.atoms.length;G<z;G++){u=x.atoms[G];var M=u.x*E[1]+u.y*E[2]+u.z*E[3]+E[0],F=u.x*K[1]+u.y*K[2]+u.z*K[3]+K[0],H=u.x*L[1]+u.y*L[2]+u.z*L[3]+L[0];B.push(new g.Atom(u.label,M,F,H));if(I){A=0;for(var N=I.length;A<N;A++){var J=I[A];B.push(new g.Atom(u.label,M+J[0],F+J[1],H+J[2]))}}}}D=0;for(w=B.length;D<w;D++){for(u=B[D];u.x>=1;)u.x--;for(;u.x<0;)u.x++;for(;u.y>=1;)u.y--;for(;u.y<0;)u.y++;for(;u.z>=1;)u.z--;
for(;u.z<0;)u.z++}C=[];D=0;for(w=B.length;D<w;D++){A=false;u=B[D];G=0;for(z=x.atoms.length;G<z;G++)if(x.atoms[G].distance3D(u)<1.0E-4){A=true;break}if(!A){G=0;for(z=C.length;G<z;G++)if(C[G].distance3D(u)<1.0E-4){A=true;break}A||C.push(u)}}x.atoms=x.atoms.concat(C);w=[];for(D=0;D<t;D++)for(G=0;G<v;G++)for(A=0;A<r;A++)if(!(D==0&&G==0&&A==0)){C=0;for(B=x.atoms.length;C<B;C++){u=x.atoms[C];w.push(new g.Atom(u.label,u.x+D,u.y+G,u.z+A))}}x.atoms=x.atoms.concat(w);D=0;for(w=x.atoms.length;D<w;D++){u=x.atoms[D];
C=d.multiplyVec3(n,[u.x,u.y,u.z]);u.x=C[0];u.y=C[1];u.z=C[2]}(new b.informatics.BondDeducer).deduceCovalentBonds(x,1);t=[-t/2,-v/2,-r/2];x.unitCellVectors={o:d.multiplyVec3(n,t,[]),x:d.multiplyVec3(n,[t[0]+1,t[1],t[2]]),y:d.multiplyVec3(n,[t[0],t[1]+1,t[2]]),z:d.multiplyVec3(n,[t[0],t[1],t[2]+1]),xy:d.multiplyVec3(n,[t[0]+1,t[1]+1,t[2]]),xz:d.multiplyVec3(n,[t[0]+1,t[1],t[2]+1]),yz:d.multiplyVec3(n,[t[0],t[1]+1,t[2]+1]),xyz:d.multiplyVec3(n,[t[0]+1,t[1]+1,t[2]+1])};return x}};var p=new l.CIFInterpreter;
b.readCIF=function(n,t,v,r){return p.read(n,t,v,r)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3);
(function(b,a,l,g,h){function d(c,f,e){for(var k=c.length,m="",q=0;q<f-k;q++)m+=" ";return e?c+m:m+c}l.MOLInterpreter=function(){this.read=function(c,f){if(!f)f=b.default_bondLength_2D;var e=new g.Molecule;if(c==null||c.length==0)return e;var k=c.split("\n"),m=k[3],q=parseInt(m.substring(0,3));m=parseInt(m.substring(3,6));for(var p=0;p<q;p++){var n=k[4+p];e.atoms[p]=new g.Atom(n.substring(31,34),parseFloat(n.substring(0,10))*f,(f==1?1:-1)*parseFloat(n.substring(10,20))*f,parseFloat(n.substring(20,
30))*f);var t=parseInt(n.substring(34,36));if(t!=0&&a[e.atoms[p].label]!=null)e.atoms[p].mass=a[e.atoms[p].label].mass+t;switch(parseInt(n.substring(36,39))){case 1:e.atoms[p].charge=3;break;case 2:e.atoms[p].charge=2;break;case 3:e.atoms[p].charge=1;break;case 5:e.atoms[p].charge=-1;break;case 6:e.atoms[p].charge=-2;break;case 7:e.atoms[p].charge=-3;break}}for(p=0;p<m;p++){n=k[4+q+p];var v=parseInt(n.substring(6,9));t=parseInt(n.substring(9,12));if(v>3)switch(v){case 4:v=1.5;break;default:v=1;break}n=
new g.Bond(e.atoms[parseInt(n.substring(0,3))-1],e.atoms[parseInt(n.substring(3,6))-1],v);switch(t){case 3:n.stereo=g.Bond.STEREO_AMBIGUOUS;break;case 1:n.stereo=g.Bond.STEREO_PROTRUDING;break;case 6:n.stereo=g.Bond.STEREO_RECESSED;break}e.bonds[p]=n}return e};this.write=function(c){var f="Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n";f=f+d(c.atoms.length.toString(),3)+d(c.bonds.length.toString(),3)+"  0  0  0  0            999 v2000\n";for(var e=c.getCenter(),k=0,m=c.atoms.length;k<
m;k++){var q=c.atoms[k],p=" 0";if(q.mass!=-1&&a[q.label]!=null){var n=q.mass-a[q.label].mass;if(n<5&&n>-4)p=(n>-1?" ":"")+n}n="  0";if(q.charge!=0)switch(q.charge){case 3:n="  1";break;case 2:n="  2";break;case 1:n="  3";break;case -1:n="  5";break;case -2:n="  6";break;case -3:n="  7";break}f=f+d(((q.x-e.x)/b.default_bondLength_2D).toFixed(4),10)+d((-(q.y-e.y)/b.default_bondLength_2D).toFixed(4),10)+d((q.z/b.default_bondLength_2D).toFixed(4),10)+" "+d(q.label,3,true)+p+n+"  0  0  0  0\n"}k=0;for(m=
c.bonds.length;k<m;k++){e=c.bonds[k];q=0;if(e.stereo==g.Bond.STEREO_AMBIGUOUS)q=3;else if(e.stereo==g.Bond.STEREO_PROTRUDING)q=1;else if(e.stereo==g.Bond.STEREO_RECESSED)q=6;f=f+d((h(e.a1,c.atoms)+1).toString(),3)+d((h(e.a2,c.atoms)+1).toString(),3)+d(e.bondOrder.toString(),3)+"  "+q+"     0  0\n"}f+="M  END";return f}};var j=new l.MOLInterpreter;b.readMOL=function(c,f){return j.read(c,f)};b.writeMOL=function(c){return j.write(c)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures,
jQuery.inArray);
(function(b,a,l,g,h){l.PDBInterpreter=function(){function j(c,f,e,k,m){for(var q=0,p=f.length;q<p;q++){var n=f[q];if(n.id==e&&k>=n.start&&k<=n.end){if(m)c.helix=true;else c.sheet=true;if(k+1==n.end)c.arrow=true;return}}}this.calculateRibbonDistances=false;this.read=function(c,f){var e=new g.Molecule;e.chains=[];if(c==null||c.length==0)return e;var k=c.split("\n");f||(f=1);for(var m=[],q=[],p=null,n=[],t=0,v=k.length;t<v;t++){var r=k[t];if(a.stringStartsWith(r,"HELIX"))m.push({id:r.substring(19,20),
start:parseInt(r.substring(21,25)),end:parseInt(r.substring(33,37))});else if(a.stringStartsWith(r,"SHEET"))q.push({id:r.substring(21,22),start:parseInt(r.substring(22,26)),end:parseInt(r.substring(33,37))});else if(a.stringStartsWith(r,"ATOM")){var x=r.substring(16,17);if(x==" "||x=="A"){x=h(r.substring(76,78));if(x.length==0){var u=h(r.substring(12,14));if(u=="HD")x="H";else if(u.length>0)x=u.length>1?u.charAt(0)+u.substring(1).toLowerCase():u}x=new g.Atom(x,parseFloat(r.substring(30,38))*f,parseFloat(r.substring(38,
46))*f,parseFloat(r.substring(46,54))*f);x.hetatm=false;e.atoms.push(x);u=parseInt(r.substring(22,26));if(n.length==0)for(var w=0;w<2;w++){var z=new g.Residue(-1);z.cp1=x;z.cp2=x;n.push(z)}if(u!=Number.NaN&&n[n.length-1].resSeq!=u){w=new g.Residue(u);w.name=h(r.substring(17,20));if(w.name.length==3)w.name=w.name.substring(0,1)+w.name.substring(1).toLowerCase();else if(w.name.length==2&&w.name.charAt(0)=="D")w.name=w.name.substring(1);n.push(w);z=r.substring(21,22);j(w,m,z,u,true);j(w,q,z,u,false)}r=
h(r.substring(12,16));u=n[n.length-1];if(r=="CA"||r=="P"||r=="O5'"){if(!u.cp1)u.cp1=x}else if(r=="N3"&&(u.name=="C"||u.name=="U"||u.name=="T")||r=="N1"&&(u.name=="A"||u.name=="G"))u.cp3=x;else if(r=="C2")u.cp4=x;else if(r=="C4"&&(u.name=="C"||u.name=="U"||u.name=="T")||r=="C6"&&(u.name=="A"||u.name=="G"))u.cp5=x;else if(r=="O"||r=="C6"&&(u.name=="C"||u.name=="U"||u.name=="T")||r=="N9"){if(!n[n.length-1].cp2){if(r=="C6"||r=="N9")p=x;u.cp2=x}}else if(r=="C")p=x}}else if(a.stringStartsWith(r,"HETATM")){x=
h(r.substring(76,78));if(x.length>1)x=x.substring(0,1)+x.substring(1).toLowerCase();x=new g.Atom(x,parseFloat(r.substring(30,38))*f,parseFloat(r.substring(38,46))*f,parseFloat(r.substring(46,54))*f);x.hetatm=true;if(h(r.substring(17,20))=="HOH")x.isWater=true;e.atoms.push(x)}else if(a.stringStartsWith(r,"TER")){this.endChain(e,n,p);n=[]}else if(a.stringStartsWith(r,"ENDMDL"))break}this.endChain(e,n,p);(new b.informatics.BondDeducer).deduceCovalentBonds(e,f);this.calculateRibbonDistances&&this.calculateDistances(e);
return e};this.endChain=function(c,f,e){if(f.length>0){var k=f[f.length-1];if(!k.cp1)k.cp1=c.atoms[c.atoms.length-2];if(!k.cp2)k.cp2=c.atoms[c.atoms.length-1];for(k=0;k<4;k++){var m=new g.Residue(-1);m.cp1=e;m.cp2=f[f.length-1].cp2;f.push(m)}c.chains.push(f)}};this.calculateDistances=function(c){for(var f=[],e=[],k=0,m=c.atoms.length;k<m;k++){var q=c.atoms[k];if(q.hetatm)q.isWater||f.push(q);else e.push(q)}k=0;for(m=e.length;k<m;k++){q=e[k];q.closestDistance=Number.POSITIVE_INFINITY;if(f.length==
0)q.closestDistance=0;else{c=0;for(var p=f.length;c<p;c++)q.closestDistance=Math.min(q.closestDistance,q.distance3D(f[c]))}}}};var d=new l.PDBInterpreter;b.readPDB=function(j,c){return d.read(j,c)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
(function(b,a,l,g,h,d){var j={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},c={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},f={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};l.JCAMPInterpreter=function(){this.convertHZ2PPM=false;this.read=function(k){this.isBreak=function(R){return j[R]!=null||c[R]!=null||f[R]!=null||R==" "||R=="-"||R=="+"};this.getValue=function(R,X){var T=R.charAt(0),U=R.substring(1);if(j[T]!=null)return parseFloat(j[T]+
U);else if(c[T]!=null)return parseFloat(c[T]+U)+X;return parseFloat(U)};var m=new g.Spectrum;if(k==null||k.length==0)return m;k=k.split("\n");for(var q=[],p,n,t,v,r=1,x=1,u=1,w=-1,z=-1,A=-1,C=true,D=false,G=0,B=k.length;G<B;G++){var I=d(k[G]),E=h.inArray("$$",I);if(E!=-1)I=I.substring(0,E);if(q.length==0||!a.stringStartsWith(k[G],"##")){q.length!=0&&q.push("\n");q.push(d(I))}else{E=q.join("");C&&E.length<100&&m.metadata.push(E);q=[I];if(a.stringStartsWith(E,"##TITLE="))m.title=d(E.substring(8));else if(a.stringStartsWith(E,
"##XUNITS=")){m.xUnit=d(E.substring(9));if(this.convertHZ2PPM&&m.xUnit.toUpperCase()=="HZ"){m.xUnit="PPM";D=true}}else if(a.stringStartsWith(E,"##YUNITS="))m.yUnit=d(E.substring(9));else if(!a.stringStartsWith(E,"##XYPAIRS="))if(a.stringStartsWith(E,"##FIRSTX="))n=parseFloat(d(E.substring(9)));else if(a.stringStartsWith(E,"##LASTX="))p=parseFloat(d(E.substring(8)));else if(a.stringStartsWith(E,"##FIRSTY="))t=parseFloat(d(E.substring(9)));else if(a.stringStartsWith(E,"##NPOINTS="))v=parseFloat(d(E.substring(10)));
else if(a.stringStartsWith(E,"##XFACTOR="))r=parseFloat(d(E.substring(10)));else if(a.stringStartsWith(E,"##YFACTOR="))x=parseFloat(d(E.substring(10)));else if(a.stringStartsWith(E,"##DELTAX="))w=parseFloat(d(E.substring(9)));else if(a.stringStartsWith(E,"##.OBSERVE FREQUENCY=")){if(this.convertHZ2PPM)u=parseFloat(d(E.substring(21)))}else if(a.stringStartsWith(E,"##.SHIFT REFERENCE=")){if(this.convertHZ2PPM){A=E.substring(19).split(",");z=parseInt(d(A[2]));A=parseFloat(d(A[3]))}}else if(a.stringStartsWith(E,
"##XYDATA=")){D||(u=1);I=C=false;E=E.split("\n");var K=(p-n)/(v-1);if(w!=-1)for(var L=1,M=E.length;L<M;L++)if(E[L].charAt(0)=="|"){K=w;break}var F=n-K,H=t,N=0,J;L=1;for(M=E.length;L<M;L++){var P=[];F=d(E[L]);q=[];for(var Q=false,O=0,S=F.length;O<S;O++)if(this.isBreak(F.charAt(O))){q.length>0&&!(q.length==1&&q[0]==" ")&&P.push(q.join(""));q=[F.charAt(O)]}else if(F.charAt(O)=="|")Q=true;else q.push(F.charAt(O));P.push(q.join(""));F=parseFloat(P[0])*r-K;O=1;for(S=P.length;O<S;O++){H=P[O];if(f[H.charAt(0)]!=
null)for(var Y=parseInt(f[H.charAt(0)]+H.substring(1))-1,W=0;W<Y;W++){F+=K;N=this.getValue(J,N);H=N*x;V++;m.data[m.data.length-1]=new g.Point(F/u,H)}else if(j[H.charAt(0)]!=null&&I){H=this.getValue(H,N)*x;if(Q){F+=K;m.data.push(new g.Point(F/u,H))}}else{I=c[H.charAt(0)]!=null;J=H;F+=K;N=this.getValue(H,N);H=N*x;V++;m.data.push(new g.Point(F/u,H))}}}if(z!=-1){I=A-m.data[z-1].x;G=0;for(B=m.data.length;G<B;G++)m.data[G].x+=I}}else if(a.stringStartsWith(E,"##PEAK TABLE=")){C=false;m.continuous=false;
E=E.split("\n");var V=0;L=1;for(M=E.length;L<M;L++){I=E[L].split(/[\s,]+/);V+=I.length/2;O=0;for(S=I.length;O+1<S;O+=2)m.data.push(new g.Point(parseFloat(d(I[O])),parseFloat(d(I[O+1]))))}}}}m.setup();return m}};var e=new l.JCAMPInterpreter;e.convertHZ2PPM=true;b.readJCAMP=function(k){return e.read(k)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim);
(function(b,a,l){b.fromJSONChains=function(g){for(var h=[],d=0,j=g.cs.length;d<j;d++){for(var c=g.cs[d],f=[],e=0,k=c.length;e<k;e++){var m=c[e],q=new a.Residue;q.name=m.n;q.cp1=new a.Atom("",m.x1,m.y1,m.z1);q.cp2=new a.Atom("",m.x2,m.y2,m.z2);if(m.x3){q.cp3=new a.Atom("",m.x3,m.y3,m.z3);q.cp4=new a.Atom("",m.x4,m.y4,m.z4);q.cp5=new a.Atom("",m.x5,m.y5,m.z5)}q.helix=m.h;q.sheet=m.s;q.arrow=m.a;f.push(q)}h.push(f)}return h};b.fromJSONPDB=function(g){var h=b.fromJSONDummy(g.mol);h.findRings=false;h.fromJSON=
true;h.chains=b.fromJSONChains(g.ribbons);return h};b.fromJSONDummy=function(g){for(var h=new a.Molecule,d=0,j=g.a.length;d<j;d++){var c=g.a[d],f=new a.Atom(c.l?c.l:"C",c.x,c.y);if(c.z)f.z=c.z;if(c.c)f.charge=c.c;if(c.m)f.mass=c.m;if(c.p_h!=undefined)f.hetatm=c.p_h;if(c.p_w!=undefined)f.isWater=c.p_w;if(c.p_d!=undefined)f.closestDistance=c.p_d;h.atoms.push(f)}d=0;for(j=g.b.length;d<j;d++){c=g.b[d];f=new a.Bond(h.atoms[c.b],h.atoms[c.e],c.o?c.o:1);if(c.s)f.stereo=c.s;h.bonds.push(f)}return h};b.toJSONDummy=
function(g){for(var h={a:[],b:[]},d=0,j=g.atoms.length;d<j;d++){var c=g.atoms[d];h.a[d]={x:c.x,y:c.y};if(c.label!="C")h.a[d].l=c.label;if(c.z!=0)h.a[d].z=c.z;if(c.charge!=0)h.a[d].c=c.charge;if(c.mass!=-1)h.a[d].m=c.mass}d=0;for(j=g.bonds.length;d<j;d++){c=g.bonds[d];h.b[d]={b:l(c.a1,g.atoms),e:l(c.a2,g.atoms)};if(c.bondOrder!=1)h.b[d].o=c.bondOrder;if(c.stereo!=a.Bond.STEREO_NONE)h.b[d].s=c.stereo}return h}})(ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
ChemDoodle.monitor=function(b,a){var l={};l.CANVAS_DRAGGING=null;l.CANVAS_OVER=null;l.ALT=false;l.SHIFT=false;l.META=false;b(a).ready(function(){b(a).mousemove(function(g){if(l.CANVAS_DRAGGING!=null)if(l.CANVAS_DRAGGING.drag){l.CANVAS_DRAGGING.prehandleEvent(g);l.CANVAS_DRAGGING.drag(g)}});b(a).mouseup(function(g){if(l.CANVAS_DRAGGING!=null&&l.CANVAS_DRAGGING!=l.CANVAS_OVER)if(l.CANVAS_DRAGGING.mouseup){l.CANVAS_DRAGGING.prehandleEvent(g);l.CANVAS_DRAGGING.mouseup(g)}l.CANVAS_DRAGGING=null});b(a).keydown(function(g){l.SHIFT=
g.shiftKey;l.ALT=g.altKey;l.META=g.metaKey;var h=l.CANVAS_OVER;if(l.CANVAS_DRAGGING!=null)h=l.CANVAS_DRAGGING;if(h!=null)if(h.keydown){h.prehandleEvent(g);h.keydown(g)}});b(a).keypress(function(g){var h=l.CANVAS_OVER;if(l.CANVAS_DRAGGING!=null)h=l.CANVAS_DRAGGING;if(h!=null)if(h.keypress){h.prehandleEvent(g);h.keypress(g)}});b(a).keyup(function(g){l.SHIFT=g.shiftKey;l.ALT=g.altKey;l.META=g.metaKey;var h=l.CANVAS_OVER;if(l.CANVAS_DRAGGING!=null)h=l.CANVAS_DRAGGING;if(h!=null)if(h.keyup){h.prehandleEvent(g);
h.keyup(g)}})});return l}(jQuery,document);
(function(b,a,l,g,h,d,j,c,f){b._Canvas=function(){this.image=this.emptyMessage=this.molecule=null;return true};b._Canvas.prototype.repaint=function(){var e=c.getElementById(this.id);if(e.getContext){var k=e.getContext("2d"),m=f.devicePixelRatio?f.devicePixelRatio:1;if(m!=1){e.width=this.width*m;e.height=this.height*m;k.scale(m,m)}if(this.image==null){if(this.specs.backgroundColor!=null){k.fillStyle=this.specs.backgroundColor;k.fillRect(0,0,this.width,this.height)}}else k.drawImage(this.image,0,0);
if(this.innerRepaint)this.innerRepaint(k);else if(this.molecule!=null&&this.molecule.atoms.length>0){k.save();k.translate(this.width/2,this.height/2);k.rotate(this.specs.rotateAngle);k.scale(this.specs.scale,this.specs.scale);k.translate(-this.width/2,-this.height/2);this.molecule.draw(k,this.specs);k.restore()}else if(this.emptyMessage!=null){k.fillStyle="#737683";k.textAlign="center";k.textBaseline="middle";k.font="18px Helvetica, Verdana, Arial, Sans-serif";k.fillText(this.emptyMessage,this.width/
2,this.height/2)}this.drawChildExtras&&this.drawChildExtras(k)}};b._Canvas.prototype.setBackgroundImage=function(e){this.image=new Image;var k=this;this.image.onload=function(){k.repaint()};this.image.src=e};b._Canvas.prototype.loadMolecule=function(e){this.molecule=e;this.center();this instanceof ChemDoodle._Canvas3D||this.molecule.check();this.afterLoadMolecule&&this.afterLoadMolecule();this.repaint()};b._Canvas.prototype.center=function(){c.getElementById(this.id);var e=this.molecule.getCenter3D(),
k=new g.Atom("C",this.width/2,this.height/2,0);k.sub3D(e);e=0;for(var m=this.molecule.atoms.length;e<m;e++)this.molecule.atoms[e].add3D(k);k=this.molecule.getDimension();this.specs.scale=1;if(k.x>this.width||k.y>this.height)this.specs.scale=j.min(this.width/k.x,this.height/k.y)*0.85};b._Canvas.prototype.create=function(e,k,m){this.id=e;this.width=k;this.height=m;if(c.getElementById(e)){var q=h("#"+e);if(k)q.attr("width",k);else this.width=q.attr("width");if(m)q.attr("height",m);else this.height=q.attr("height")}else!b.featureDetection.supports_canvas_text()&&
d.msie&&d.version>="6"?c.writeln('<div style="border: 1px solid black;" width="'+k+'" height="'+m+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>'):c.writeln('<canvas class="ChemDoodleWebComponent" id="'+e+'" width="'+k+'" height="'+m+'">This browser does not support HTML5/Canvas.</canvas>');e=h("#"+e);e.css("width",this.width);e.css("height",this.height);this.specs=new g.VisualSpecifications;var p=this;if(a.supports_touch()){e.bind("touchstart",
function(n){var t=(new Date).getTime();if(p.lastTouch&&n.originalEvent.touches.length==1&&t-p.lastTouch<500)if(p.dbltap){p.prehandleEvent(n);p.dbltap(n)}else if(p.dblclick){p.prehandleEvent(n);p.dblclick(n)}else if(p.touchstart){p.prehandleEvent(n);p.touchstart(n)}else{if(p.mousedown){p.prehandleEvent(n);p.mousedown(n)}}else if(p.touchstart){p.prehandleEvent(n);p.touchstart(n)}else if(p.mousedown){p.prehandleEvent(n);p.mousedown(n)}p.lastTouch=t});e.bind("touchmove",function(n){if(n.originalEvent.touches.length>
1&&p.multitouchmove){var t=n.originalEvent.touches.length;p.prehandleEvent(n);for(var v=new g.Point(-n.offset.left*t,-n.offset.top*t),r=0;r<t;r++){v.x+=n.originalEvent.changedTouches[r].pageX;v.y+=n.originalEvent.changedTouches[r].pageY}v.x/=t;v.y/=t;n.p=v;p.multitouchmove(n,t)}else if(p.touchmove){p.prehandleEvent(n);p.touchmove(n)}else if(p.drag){p.prehandleEvent(n);p.drag(n)}});e.bind("touchend",function(n){gestureSpread=-1;if(p.touchend){p.prehandleEvent(n);p.touchend(n)}else if(p.mouseup){p.prehandleEvent(n);
p.mouseup(n)}});e.bind("gesturestart",function(n){if(p.gesturestart){p.prehandleEvent(n);p.gesturestart(n)}});e.bind("gesturechange",function(n){if(p.gesturechange){p.prehandleEvent(n);p.gesturechange(n)}});e.bind("gestureend",function(n){if(p.gestureend){p.prehandleEvent(n);p.gestureend(n)}})}else{e.click(function(n){switch(n.which){case 1:if(p.click){p.prehandleEvent(n);p.click(n)}break;case 2:if(p.middleclick){p.prehandleEvent(n);p.middleclick(n)}break;case 3:if(p.rightclick){p.prehandleEvent(n);
p.rightclick(n)}break}});e.dblclick(function(n){if(p.dblclick){p.prehandleEvent(n);p.dblclick(n)}});e.mousedown(function(n){switch(n.which){case 1:l.CANVAS_DRAGGING=p;if(p.mousedown){p.prehandleEvent(n);p.mousedown(n)}break;case 2:if(p.middlemousedown){p.prehandleEvent(n);p.middlemousedown(n)}break;case 3:if(p.rightmousedown){p.prehandleEvent(n);p.rightmousedown(n)}break}});e.mousemove(function(n){if(l.CANVAS_DRAGGING==null&&p.mousemove){p.prehandleEvent(n);p.mousemove(n)}});e.mouseout(function(n){l.CANVAS_OVER=
null;if(p.mouseout){p.prehandleEvent(n);p.mouseout(n)}});e.mouseover(function(n){l.CANVAS_OVER=p;if(p.mouseover){p.prehandleEvent(n);p.mouseover(n)}});e.mouseup(function(n){switch(n.which){case 1:if(p.mouseup){p.prehandleEvent(n);p.mouseup(n)}break;case 2:if(p.middlemouseup){p.prehandleEvent(n);p.middlemouseup(n)}break;case 3:if(p.rightmouseup){p.prehandleEvent(n);p.rightmouseup(n)}break}});e.mousewheel(function(n,t){if(p.mousewheel){p.prehandleEvent(n);p.mousewheel(n,t)}})}this.subCreate&&this.subCreate()};
b._Canvas.prototype.getMolecule=function(){return this.molecule};b._Canvas.prototype.prehandleEvent=function(e){if(e.originalEvent.changedTouches){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY}e.preventDefault();e.offset=h("#"+this.id).offset();e.p=new g.Point(e.pageX-e.offset.left,e.pageY-e.offset.top)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,Math,document,window);
(function(b){b._AnimatorCanvas=function(a,l,g){a&&this.create(a,l,g);this.timeout=33;return true};b._AnimatorCanvas.prototype=new b._Canvas;b._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var a=this;if(this.nextFrame)this.handle=setInterval(function(){var l=(new Date).getTime();a.nextFrame(l-a.lastTime);a.repaint();a.lastTime=l},this.timeout)};b._AnimatorCanvas.prototype.stopAnimation=function(){if(this.handle!=null){clearInterval(this.handle);
this.handle=null}};b._AnimatorCanvas.prototype.isRunning=function(){return this.handle!=null}})(ChemDoodle);
(function(b,a){b.FileCanvas=function(l,g,h,d){l&&this.create(l,g,h);form='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+d+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+l+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+l+"', "+l+')"></iframe>';a.writeln(form);this.emptyMessage="Click below to load file";this.repaint();
return true};b.FileCanvas.prototype=new b._Canvas})(ChemDoodle,document);
(function(b){b.HyperlinkCanvas=function(a,l,g,h,d,j){a&&this.create(a,l,g);this.urlOrFunction=h;this.color=d?d:"blue";this.size=j?j:2;this.openInNewWindow=true;this.e=this.hoverImage=null;return true};b.HyperlinkCanvas.prototype=new b._Canvas;b.HyperlinkCanvas.prototype.drawChildExtras=function(a){if(this.e!=null)if(this.hoverImage==null){a.strokeStyle=this.color;a.lineWidth=this.size*2;a.strokeRect(0,0,this.width,this.height)}else a.drawImage(this.hoverImage,0,0)};b.HyperlinkCanvas.prototype.setHoverImage=
function(a){this.hoverImage=new Image;this.hoverImage.src=a};b.HyperlinkCanvas.prototype.click=function(){this.e=null;this.repaint();if(this.urlOrFunction instanceof Function)this.urlOrFunction();else if(this.openInNewWindow)window.open(this.urlOrFunction);else location.href=this.urlOrFunction};b.HyperlinkCanvas.prototype.mouseout=function(){this.e=null;this.repaint()};b.HyperlinkCanvas.prototype.mouseover=function(a){this.e=a;this.repaint()}})(ChemDoodle);
(function(b,a,l,g){b.MolGrabberCanvas=function(h,d,j){h&&this.create(h,d,j);d=[];d.push('<br><input type="text" id="');d.push(h);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(h);d.push('_select">');d.push('<option value="chemexper">ChemExper');d.push('<option value="chemspider">ChemSpider');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button id="');d.push(h);d.push('_submit">Show Molecule</button>');d.push("</nobr>");
g.writeln(d.join(""));var c=this;l("#"+h+"_submit").click(function(){c.search()});l("#"+h+"_query").keypress(function(f){f.which==13&&c.search()});this.emptyMessage="Enter search term below";this.repaint();return true};b.MolGrabberCanvas.prototype=new b._Canvas;b.MolGrabberCanvas.prototype.setSearchTerm=function(h){l("#"+this.id+"_query").val(h);this.search()};b.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...";this.molecule=null;this.repaint();var h=this;a.getMoleculeFromDatabase(l("#"+
this.id+"_select").val(),l("#"+this.id+"_query").val(),function(d){h.loadMolecule(d)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(b,a,l){b.RotatorCanvas=function(g,h,d,j){g&&this.create(g,h,d);this.rotate3D=j;this.zIncrement=this.yIncrement=this.xIncrement=g=a.PI/15;return true};b.RotatorCanvas.prototype=new b._AnimatorCanvas;b.RotatorCanvas.prototype.nextFrame=function(g){if(this.molecule==null)this.stopAnimation();else{var h=g/1E3;if(this.rotate3D){g=[];l.identity(g);l.rotate(g,this.xIncrement*h,[1,0,0]);l.rotate(g,this.yIncrement*h,[0,1,0]);l.rotate(g,this.zIncrement*h,[0,0,1]);h=0;for(var d=this.molecule.atoms.length;h<
d;h++){var j=this.molecule.atoms[h],c=[j.x-this.width/2,j.y-this.height/2,j.z];l.multiplyVec3(g,c);j.x=c[0]+this.width/2;j.y=c[1]+this.height/2;j.z=c[2]}h=0;for(d=this.molecule.rings.length;h<d;h++)this.molecule.rings[h].center=this.molecule.rings[h].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else this.specs.rotateAngle+=this.zIncrement*h}};b.RotatorCanvas.prototype.dblclick=
function(){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,mat4);
(function(b){b.SlideshowCanvas=function(a,l,g){a&&this.create(a,l,g);this.molecules=[];this.curIndex=0;this.timeout=5E3;this.alpha=0;this.innerHandle=null;this.phase=0;return true};b.SlideshowCanvas.prototype=new b._AnimatorCanvas;b.SlideshowCanvas.prototype.drawChildExtras=function(a){a.fillStyle="rgba("+parseInt(this.specs.backgroundColor.substring(1,3),16)+", "+parseInt(this.specs.backgroundColor.substring(3,5),16)+", "+parseInt(this.specs.backgroundColor.substring(5,7),16)+", "+this.alpha+")";
a.fillRect(0,0,this.width,this.height)};b.SlideshowCanvas.prototype.nextFrame=function(){if(this.molecules.length==0)this.stopAnimation();else{this.phase=0;var a=this,l=1;this.innerHandle=setInterval(function(){a.alpha=l/15;a.repaint();l==15&&a.breakInnerHandle();l++},33)}};b.SlideshowCanvas.prototype.breakInnerHandle=function(){if(this.innerHandle!=null){clearInterval(this.innerHandle);this.innerHandle=null}if(this.phase==0){this.curIndex++;if(this.curIndex>this.molecules.length-1)this.curIndex=
0;this.alpha=1;this.loadMolecule(this.molecules[this.curIndex]);this.phase=1;var a=this,l=1;this.innerHandle=setInterval(function(){a.alpha=(15-l)/15;a.repaint();l==15&&a.breakInnerHandle();l++},33)}else if(this.phase==1){this.alpha=0;this.repaint()}};b.SlideshowCanvas.prototype.addMolecule=function(a){this.molecules.length==0&&this.loadMolecule(a);this.molecules.push(a)}})(ChemDoodle);
(function(b,a,l,g,h){b.TransformCanvas=function(d,j,c,f){d&&this.create(d,j,c);this.lastPoint=null;this.rotate3D=f;this.rotationMultMod=1.3;this.lastPinchScale=1;this.lastGestureRotate=0;return true};b.TransformCanvas.prototype=new b._Canvas;b.TransformCanvas.prototype.mousedown=function(d){this.lastPoint=d.p};b.TransformCanvas.prototype.dblclick=function(){var d=new l.Point(this.width/2,this.height/2);d.sub(this.molecule.getCenter());for(var j=0,c=this.molecule.atoms.length;j<c;j++)this.molecule.atoms[j].add(d);
this.molecule.check();this.repaint()};b.TransformCanvas.prototype.drag=function(d){if(!this.lastPoint.multi){if(a.ALT){var j=new l.Point(d.p.x,d.p.y);j.sub(this.lastPoint);for(var c=0,f=this.molecule.atoms.length;c<f;c++)this.molecule.atoms[c].add(j);this.lastPoint=d.p;this.molecule.check()}else if(this.rotate3D==true){j=g.max(this.width/4,this.height/4);c=(d.p.x-this.lastPoint.x)/j*this.rotationMultMod;f=-(d.p.y-this.lastPoint.y)/j*this.rotationMultMod;j=[];h.identity(j);h.rotate(j,f,[1,0,0]);h.rotate(j,
c,[0,1,0]);c=0;for(f=this.molecule.atoms.length;c<f;c++){var e=this.molecule.atoms[c],k=[e.x-this.width/2,e.y-this.height/2,e.z];h.multiplyVec3(j,k);e.x=k[0]+this.width/2;e.y=k[1]+this.height/2;e.z=k[2]}c=0;for(f=this.molecule.rings.length;c<f;c++)this.molecule.rings[c].center=this.molecule.rings[c].getCenter();this.lastPoint=d.p;this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else{j=
new l.Point(this.width/2,this.height/2);c=j.angle(this.lastPoint);this.specs.rotateAngle-=j.angle(d.p)-c;this.lastPoint=d.p}this.repaint()}};b.TransformCanvas.prototype.mousewheel=function(d,j){this.specs.scale+=j/10;if(this.specs.scale<0.01)this.specs.scale=0.01;this.repaint()};b.TransformCanvas.prototype.multitouchmove=function(d,j){if(j==2)if(this.lastPoint.multi){var c=new l.Point(d.p.x,d.p.y);c.sub(this.lastPoint);for(var f=0,e=this.molecule.atoms.length;f<e;f++)this.molecule.atoms[f].add(c);
this.lastPoint=d.p;this.lastPoint.multi=true;this.molecule.check();this.repaint()}else{this.lastPoint=d.p;this.lastPoint.multi=true}};b.TransformCanvas.prototype.gesturechange=function(d){if(d.originalEvent.scale-this.lastPinchScale!=0){this.specs.scale*=d.originalEvent.scale/this.lastPinchScale;if(this.specs.scale<0.01)this.specs.scale=0.01;this.lastPinchScale=d.originalEvent.scale}if(this.lastGestureRotate-d.originalEvent.rotation!=0){for(var j=(this.lastGestureRotate-d.originalEvent.rotation)/
180*g.PI,c=new l.Point(this.width/2,this.height/2),f=0,e=this.molecule.atoms.length;f<e;f++){var k=c.distance(this.molecule.atoms[f]),m=c.angle(this.molecule.atoms[f])+j;this.molecule.atoms[f].x=c.x+k*g.cos(m);this.molecule.atoms[f].y=c.y-k*g.sin(m)}this.lastGestureRotate=d.originalEvent.rotation;this.molecule.check()}this.repaint()};b.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4);
(function(b){b.ViewerCanvas=function(a,l,g){a&&this.create(a,l,g);return true};b.ViewerCanvas.prototype=new b._Canvas})(ChemDoodle);
(function(b){b._SpectrumCanvas=function(a,l,g){a&&this.create(a,l,g);this.spectrum=null;this.emptyMessage="No Spectrum Loaded or Recognized";this.getMolecule=this.loadMolecule=null;return true};b._SpectrumCanvas.prototype=new b._Canvas;b._SpectrumCanvas.prototype.innerRepaint=function(a){if(this.spectrum!=null&&this.spectrum.data.length>0)this.spectrum.draw(a,this.specs,this.width,this.height);else if(this.emptyMessage!=null){a.fillStyle="#737683";a.textAlign="center";a.textBaseline="middle";a.font=
"18px Helvetica, Verdana, Arial, Sans-serif";a.fillText(this.emptyMessage,this.width/2,this.height/2)}};b._SpectrumCanvas.prototype.loadSpectrum=function(a){this.spectrum=a;this.repaint()};b._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum}})(ChemDoodle,document);(function(b){b.ObserverCanvas=function(a,l,g){a&&this.create(a,l,g);return true};b.ObserverCanvas.prototype=new b._SpectrumCanvas})(ChemDoodle);
(function(b,a,l){b.PerspectiveCanvas=function(g,h,d){g&&this.create(g,h,d);this.dragRange=null;this.rescaleYAxisOnZoom=true;this.lastPinchScale=1;return true};b.PerspectiveCanvas.prototype=new b._SpectrumCanvas;b.PerspectiveCanvas.prototype.mousedown=function(g){this.dragRange=new b.structures.Point(g.p.x,g.p.x)};b.PerspectiveCanvas.prototype.mouseup=function(g){if(this.dragRange!=null&&this.dragRange.x!=this.dragRange.y){if(!this.dragRange.multi){g=this.spectrum.zoom(this.dragRange.x,g.p.x,this.width,
this.rescaleYAxisOnZoom);if(this.rescaleYAxisOnZoom)this.specs.scale=g}this.dragRange=null;this.repaint()}};b.PerspectiveCanvas.prototype.drag=function(g){if(this.dragRange!=null){if(this.dragRange.multi)this.dragRange=null;else{if(a.SHIFT){this.spectrum.translate(g.p.x-this.dragRange.x,this.width);this.dragRange.x=g.p.x}this.dragRange.y=g.p.x}this.repaint()}};b.PerspectiveCanvas.prototype.drawChildExtras=function(g){if(this.dragRange!=null){var h=l.min(this.dragRange.x,this.dragRange.y),d=l.max(this.dragRange.x,
this.dragRange.y);g.strokeStyle="gray";g.lineStyle=1;g.beginPath();g.moveTo(h,this.height/2);for(h=h;h<=d;h++)h%10<5?g.lineTo(h,l.round(this.height/2)):g.moveTo(h,l.round(this.height/2));g.stroke()}};b.PerspectiveCanvas.prototype.mousewheel=function(g,h){this.specs.scale+=h/10;if(this.specs.scale<0.01)this.specs.scale=0.01;this.repaint()};b.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup();this.specs.scale=1;this.repaint()};b.PerspectiveCanvas.prototype.multitouchmove=function(g,
h){if(h==2)if(this.dragRange==null||!this.dragRange.multi){this.dragRange=new b.structures.Point(g.p.x,g.p.x);this.dragRange.multi=true}else{this.spectrum.translate(g.p.x-this.dragRange.x,this.width);this.dragRange.x=g.p.x;this.dragRange.y=g.p.x;this.repaint()}};b.PerspectiveCanvas.prototype.gesturechange=function(g){this.specs.scale*=g.originalEvent.scale/this.lastPinchScale;if(this.specs.scale<0.01)this.specs.scale=0.01;this.lastPinchScale=g.originalEvent.scale;this.repaint()};b.PerspectiveCanvas.prototype.gestureend=
function(){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(b,a,l,g,h,d,j,c,f,e,k){b._Canvas3D=function(m,q,p){m&&this.create(m,q,p);this.rotationMatrix=c.identity([]);this.translationMatrix=c.identity([]);this.lastPoint=null;this.emptyMessage="WebGL is Unavailable!";return true};b._Canvas3D.prototype=new b._Canvas;b._Canvas3D.prototype.afterLoadMolecule=function(){var m=this.molecule.getDimension();this.translationMatrix=c.translate(c.identity([]),[0,0,-d.max(m.x,m.y)-10]);this.setupScene()};b._Canvas3D.prototype.setViewDistance=function(m){this.translationMatrix=
c.translate(c.identity([]),[0,0,-m])};b._Canvas3D.prototype.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.modelViewMatrix=c.multiply(this.translationMatrix,this.rotationMatrix,[]);this.gl.rotationMatrix=this.rotationMatrix;this.molecule!=null&&this.molecule.render(this.gl,this.specs);this.gl.flush()}};b._Canvas3D.prototype.center=function(){j.getElementById(this.id);for(var m=this.molecule.getCenter3D(),q=0,p=this.molecule.atoms.length;q<p;q++)this.molecule.atoms[q].sub3D(m);
if(this.molecule.chains&&this.molecule.fromJSON){q=0;for(p=this.molecule.chains.length;q<p;q++)for(var n=this.molecule.chains[q],t=0,v=n.length;t<v;t++){var r=n[t];r.cp1.sub3D(m);r.cp2.sub3D(m);if(r.cp3){r.cp3.sub3D(m);r.cp4.sub3D(m);r.cp5.sub3D(m)}}}};b._Canvas3D.prototype.subCreate=function(){try{var m=j.getElementById(this.id);this.gl=m.getContext("webgl");if(!this.gl)this.gl=m.getContext("experimental-webgl");if(this.gl){var q=k.devicePixelRatio?k.devicePixelRatio:1;if(q!=1){m.width=this.width*
q;m.height=this.height*q;ctx.scale(q,q)}}}catch(p){}if(this.gl){this.gl.viewport(0,0,this.width,this.height);this.gl.program=this.gl.createProgram();this.gl.shader=new g.Shader;this.gl.shader.init(this.gl);this.setupScene()}else{this.molecule=null;this.displayMessage()}};b._Canvas.prototype.displayMessage=function(){var m=j.getElementById(this.id);if(m.getContext){m=m.getContext("2d");if(this.specs.backgroundColor!=null){m.fillStyle=this.specs.backgroundColor;m.fillRect(0,0,this.width,this.height)}if(this.emptyMessage!=
null){m.fillStyle="#737683";m.textAlign="center";m.textBaseline="middle";m.font="18px Helvetica, Verdana, Arial, Sans-serif";m.fillText(this.emptyMessage,this.width/2,this.height/2)}}};b._Canvas3D.prototype.setupScene=function(){if(this.gl){var m=l.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(m[0],m[1],m[2],1);this.gl.clearDepth(1);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.sphereBuffer=new g.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D);
this.gl.starBuffer=new g.Star;this.gl.cylinderBuffer=new g.Cylinder(1,1,this.specs.bonds_resolution_3D);this.gl.lineBuffer=new g.Line;if(this.molecule){if(this.molecule.unitCellVectors)this.molecule.unitCell=new g.UnitCell(this.molecule.unitCellVectors);if(this.molecule.chains){this.molecule.ribbons=[];this.molecule.cartoons=[];this.molecule.tubes=[];m=0;for(var q=this.molecule.chains.length;m<q;m++){var p=this.molecule.chains[m],n=p.length>2&&h[p[2].name]&&h[p[2].name].aminoColor=="#BEA06E";if(p.length>
0&&!p[0].lineSegments){for(var t=0,v=p.length-1;t<v;t++){if(n)p[t].Ns=1;p[t].setup(p[t+1].cp1)}if(!n){t=1;for(v=p.length-1;t<v;t++)if(a.vec3AngleFrom(p[t-1].D,p[t].D)>d.PI/2){p[t].guidePointsSmall.reverse();p[t].guidePointsLarge.reverse();e.scale(p[t].D,-1)}}t=1;for(v=p.length-3;t<v;t++)p[t].computeLineSegments(p[t-1],p[t+1],p[t+2],!n);p.pop();p.pop();p.pop();p.shift()}var r=l.hsl2rgb(q==1?0.5:m/q,1,0.5);r="rgb("+r[0]+","+r[1]+","+r[2]+")";p.chainColor=r;if(n){p=new g.Tube(p,this.specs.nucleics_tubeThickness,
this.specs.nucleics_tubeResolution_3D);p.chainColor=r;this.molecule.tubes.push(p)}else{n={front:new g.Ribbon(p,this.specs.proteins_ribbonThickness,false),back:new g.Ribbon(p,-this.specs.proteins_ribbonThickness,false)};n.front.chainColor=r;n.back.chainColor=r;t=0;for(v=n.front.segments.length;t<v;t++)n.front.segments[t].chainColor=r;t=0;for(v=n.back.segments.length;t<v;t++)n.back.segments[t].chainColor=r;this.molecule.ribbons.push(n);p={front:new g.Ribbon(p,this.specs.proteins_ribbonThickness,true),
back:new g.Ribbon(p,-this.specs.proteins_ribbonThickness,true)};p.front.chainColor=r;p.back.chainColor=r;t=0;for(v=p.front.segments.length;t<v;t++)p.front.segments[t].chainColor=r;t=0;for(v=p.back.segments.length;t<v;t++)p.back.segments[t].chainColor=r;t=0;for(v=p.front.cartoonSegments.length;t<v;t++)p.front.cartoonSegments[t].chainColor=r;t=0;for(v=p.back.cartoonSegments.length;t<v;t++)p.back.cartoonSegments[t].chainColor=r;this.molecule.cartoons.push(p)}}}}this.gl.lighting=new g.Light(this.specs.lightDiffuseColor_3D,
this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D);this.gl.lighting.lightScene(this.gl);this.gl.material=new g.Material(this.gl);this.gl.projectionMatrix=this.specs.projectionPerspective_3D?c.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,this.specs.projectionWidthHeightRatio_3D,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):c.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/
2/this.specs.projectionWidthHeightRatio_3D,this.specs.projectionOrthoWidth_3D/2/this.specs.projectionWidthHeightRatio_3D,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),false,this.gl.projectionMatrix);var x=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),u=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(w){this.uniformMatrix4fv(x,
false,w);w=f.transpose(c.toInverseMat3(w,[]));this.uniformMatrix3fv(u,false,w)}}};b._Canvas3D.prototype.mousedown=function(m){this.lastPoint=m.p};b._Canvas3D.prototype.rightmousedown=function(m){this.lastPoint=m.p};b._Canvas3D.prototype.drag=function(m){if(b.monitor.ALT){var q=new g.Point(m.p.x,m.p.y);q.sub(this.lastPoint);c.translate(this.translationMatrix,[q.x/20,-q.y/20,0])}else{d.max(this.width/4,this.height/4);var p=m.p.x-this.lastPoint.x;q=m.p.y-this.lastPoint.y;p=c.rotate(c.identity([]),p*
d.PI/180,[0,1,0]);c.rotate(p,q*d.PI/180,[1,0,0]);this.rotationMatrix=c.multiply(p,this.rotationMatrix)}this.lastPoint=m.p;this.repaint()};b._Canvas3D.prototype.mousewheel=function(m,q){c.translate(this.translationMatrix,[0,0,q*2]);this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math,document,mat4,mat3,vec3,window);
(function(b,a,l,g){b.MolGrabberCanvas3D=function(h,d,j){h&&this.create(h,d,j);d=[];d.push('<br><input type="text" id="');d.push(h);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(h);d.push('_select">');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button id="');d.push(h);d.push('_submit">Show Molecule</button>');d.push("</nobr>");g.writeln(d.join(""));var c=this;l("#"+h+"_submit").click(function(){c.search()});l("#"+h+"_query").keypress(function(f){f.which==
13&&c.search()});return true};b.MolGrabberCanvas3D.prototype=new b._Canvas3D;b.MolGrabberCanvas3D.prototype.setSearchTerm=function(h){l("#"+this.id+"_query").val(h);this.search()};b.MolGrabberCanvas3D.prototype.search=function(){var h=this;a.getMoleculeFromDatabase(l("#"+this.id+"_select").val(),l("#"+this.id+"_query").val(),function(d){h.loadMolecule(d)},3)}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(b,a,l){b.RotatorCanvas3D=function(g,h,d){g&&this.create(g,h,d);this.timeout=33;this.zIncrement=this.yIncrement=this.xIncrement=g=a.PI/15;return true};b.RotatorCanvas3D.prototype=new b._Canvas3D;b.RotatorCanvas3D.prototype.startAnimation=b._AnimatorCanvas.prototype.startAnimation;b.RotatorCanvas3D.prototype.stopAnimation=b._AnimatorCanvas.prototype.stopAnimation;b.RotatorCanvas3D.prototype.isRunning=b._AnimatorCanvas.prototype.isRunning;b.RotatorCanvas3D.prototype.dblclick=b.RotatorCanvas.prototype.dblclick;
b.RotatorCanvas3D.prototype.mousedown=null;b.RotatorCanvas3D.prototype.rightmousedown=null;b.RotatorCanvas3D.prototype.drag=null;b.RotatorCanvas3D.prototype.mousewheel=null;b.RotatorCanvas3D.prototype.nextFrame=function(g){if(this.molecule==null)this.stopAnimation();else{var h=[];l.identity(h);g=g/1E3;l.rotate(h,this.xIncrement*g,[1,0,0]);l.rotate(h,this.yIncrement*g,[0,1,0]);l.rotate(h,this.zIncrement*g,[0,0,1]);l.multiply(this.rotationMatrix,h)}}})(ChemDoodle,Math,mat4);
(function(b){b.TransformCanvas3D=function(a,l,g){a&&this.create(a,l,g);return true};b.TransformCanvas3D.prototype=new b._Canvas3D})(ChemDoodle);(function(b){b.ViewerCanvas3D=function(a,l,g){a&&this.create(a,l,g);return true};b.ViewerCanvas3D.prototype=new b._Canvas3D;b.ViewerCanvas3D.prototype.mousedown=null;b.ViewerCanvas3D.prototype.rightmousedown=null;b.ViewerCanvas3D.prototype.drag=null;b.ViewerCanvas3D.prototype.mousewheel=null})(ChemDoodle);
(function(b,a,l){function g(h,d,j,c){this.element=h;this.x=d;this.y=j;this.dimension=c}b.PeriodicTableCanvas=function(h,d){this.padding=5;h&&this.create(h,d*18+this.padding*2,d*10+this.padding*2);this.getMolecule=this.loadMolecule=null;this.cellDimension=d?d:20;this.setupTable();this.repaint();return true};b.PeriodicTableCanvas.prototype=new b._Canvas;b.PeriodicTableCanvas.prototype.getHoveredElement=function(){if(this.hovered!=null)return this.hovered.element;return null};b.PeriodicTableCanvas.prototype.innerRepaint=
function(h){for(var d=0,j=this.cells.length;d<j;d++)this.drawCell(h,this.specs,this.cells[d]);this.hovered!=null&&this.drawCell(h,this.specs,this.hovered);this.selected!=null&&this.drawCell(h,this.specs,this.selected)};b.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var h=y=this.padding,d=0,j=0,c=b.SYMBOLS.length;j<c;j++){if(d==18){d=0;y+=this.cellDimension;h=this.padding}var f=b.ELEMENT[b.SYMBOLS[j]];if(f.atomicNumber==2){h+=16*this.cellDimension;d+=16}else if(f.atomicNumber==
5||f.atomicNumber==13){h+=10*this.cellDimension;d+=10}if((f.atomicNumber<58||f.atomicNumber>71&&f.atomicNumber<90||f.atomicNumber>103)&&f.atomicNumber<113){this.cells.push(new g(f,h,y,this.cellDimension));h+=this.cellDimension;d++}}y+=2*this.cellDimension;h=3*this.cellDimension+this.padding;for(j=57;j<104;j++){f=b.ELEMENT[b.SYMBOLS[j]];if(f.atomicNumber==90){y+=this.cellDimension;h=3*this.cellDimension+this.padding}if(f.atomicNumber>=58&&f.atomicNumber<=71||f.atomicNumber>=90&&f.atomicNumber<=103){this.cells.push(new g(f,
h,y,this.cellDimension));h+=this.cellDimension}}};b.PeriodicTableCanvas.prototype.drawCell=function(h,d,j){var c=h.createRadialGradient(j.x+j.dimension/3,j.y+j.dimension/3,j.dimension*1.5,j.x+j.dimension/3,j.y+j.dimension/3,j.dimension/10);c.addColorStop(0,"#000000");c.addColorStop(0.7,j.element.jmolColor);c.addColorStop(1,"#FFFFFF");h.fillStyle=c;a.contextRoundRect(h,j.x,j.y,j.dimension,j.dimension,j.dimension/8);if(j==this.hovered||j==this.selected){h.lineWidth=2;h.strokeStyle="#c10000";h.stroke();
h.fillStyle="white"}h.fill();h.font=d.getFontString(d.text_font_size,d.text_font_families);h.fillStyle=d.text_color;h.textAlign="center";h.textBaseline="middle";h.fillText(j.element.symbol,j.x+j.dimension/2,j.y+j.dimension/2)};b.PeriodicTableCanvas.prototype.click=function(){if(this.hovered!=null){this.selected=this.hovered;this.repaint()}};b.PeriodicTableCanvas.prototype.mousemove=function(h){var d=h.p.x;h=h.p.y;this.hovered=null;for(var j=0,c=this.cells.length;j<c;j++){var f=this.cells[j];if(l.isBetween(d,
f.x,f.x+f.dimension)&&l.isBetween(h,f.y,f.y+f.dimension)){this.hovered=f;break}}this.repaint()};b.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=null;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);(function(b,a){b._Layout=function(){return true};b._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()};b._Layout.prototype.create=function(l){this.name=l;this.specs=new a.VisualSpecifications}})(ChemDoodle,ChemDoodle.structures);
(function(b,a,l){b.SimpleReactionLayout=function(g){this.reactants=[];this.products=[];this.textBelow=this.textAbove=null;this.arrow="&rarr;";this.plus="+";this.create(g);return true};b.SimpleReactionLayout.prototype=new b._Layout;b.SimpleReactionLayout.prototype.addReactant=function(g){this.reactants.push(g)};b.SimpleReactionLayout.prototype.addProduct=function(g){this.products.push(g)};b.SimpleReactionLayout.prototype.innerLayout=function(){l.writeln("<table><tr>");for(var g=0,h=this.reactants.length;g<
h;g++){g>0&&l.writeln('<td><span style="font-size:25px;">'+this.plus+"</span></td>");l.writeln("<td>");var d=this.reactants[g].getDimension();d=new b.ViewerCanvas(this.name+"_reactant"+g,d.x+60,d.y+60);this.specs.backgroundColor==null&&a("#"+this.name+"_reactant"+g).css("border","0px");d.specs=this.specs;d.loadMolecule(this.reactants[g]);l.writeln("</td>")}l.writeln("<td>");l.writeln("<table>");l.writeln("<tr><td>");this.textAbove!=null?l.writeln("<center>"+this.textAbove+"</center>"):l.writeln("&nbsp;");
l.writeln("</td></tr>");l.writeln('<tr><td><center><span style="font-size:25px;">'+this.arrow+"</span></center></td></tr>");l.writeln("<tr><td>");this.textBelow!=null?l.writeln("<center>"+this.textBelow+"</center>"):l.writeln("&nbsp;");l.writeln("</td></tr>");l.writeln("</table>");l.writeln("</td>");g=0;for(h=this.products.length;g<h;g++){g>0&&l.writeln('<td><span style="font-size:25px;">'+this.plus+"</td>");l.writeln("<td>");d=this.products[g].getDimension();d=new b.ViewerCanvas(this.name+"_product"+
g,d.x+60,d.y+60);this.specs.backgroundColor==null&&a("#"+this.name+"_product"+g).css("border","0px");d.specs=this.specs;d.loadMolecule(this.products[g]);l.writeln("</td>")}l.writeln("</tr></table>")}})(ChemDoodle,jQuery,document);(function(b,a,l){b.png={};b.png.create=function(g){l.open(a.getElementById(g.id).toDataURL("image/png"))}})(ChemDoodle.io,document,window);
