//
// ChemDoodle Web Components 5.0.0
//
// http://web.chemdoodle.com
//
// Copyright 2009-2012 iChemLabs, LLC.  All rights reserved.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// As a special exception to the GPL, any HTML file in a public website
// or any free web service which merely makes function calls to this
// code, and for that purpose includes it by reference, shall be deemed
// a separate work for copyright law purposes. If you modify this code,
// you may extend this exception to your version of the code, but you
// are not obligated to do so. If you do not wish to do so, delete this
// exception statement from your version.
//
// As an additional exception to the GPL, you may distribute this
// packed form of the code without the copy of the GPL license normally
// required, provided you include this license notice and a URL through
// which recipients can access the corresponding unpacked source code.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact> for
// alternate licensing options.
//
var ChemDoodle=function(){var b={structures:{}};b.structures.d2={};b.structures.d3={};b.iChemLabs={};b.informatics={};b.io={};b.getVersion=function(){return"5.0.0"};return b}();
ChemDoodle.extensions=function(b,e,a){return{stringStartsWith:function(a,c){return a.slice(0,c.length)===c},vec3AngleFrom:function(b,c){var d=e.length(b),f=e.length(c),d=e.dot(b,c)/d/f;return a.acos(d)},contextHashTo:function(a,c,d,f,q,g,e){for(var m=0,j=(new b.Point(c,d)).distance(new b.Point(f,q)),l=!1,n=c,r=d,c=f-c,d=q-d;m<j;){if(l)if(m+e>j){a.moveTo(f,q);break}else{var k=e/j,n=n+k*c,r=r+k*d;a.moveTo(n,r);m+=e}else if(m+g>j){a.lineTo(f,q);break}else k=g/j,n+=k*c,r+=k*d,a.lineTo(n,r),m+=g;l=!l}},
contextRoundRect:function(a,c,d,f,q,g){a.beginPath();a.moveTo(c+g,d);a.lineTo(c+f-g,d);a.quadraticCurveTo(c+f,d,c+f,d+g);a.lineTo(c+f,d+q-g);a.quadraticCurveTo(c+f,d+q,c+f-g,d+q);a.lineTo(c+g,d+q);a.quadraticCurveTo(c,d+q,c,d+q-g);a.lineTo(c,d+g);a.quadraticCurveTo(c,d,c+g,d);a.closePath()},contextEllipse:function(a,c,d,f,q){var g=0.5522848*(f/2),b=0.5522848*(q/2),m=c+f,j=d+q,f=c+f/2,q=d+q/2;a.beginPath();a.moveTo(c,q);a.bezierCurveTo(c,q-b,f-g,d,f,d);a.bezierCurveTo(f+g,d,m,q-b,m,q);a.bezierCurveTo(m,
q+b,f+g,j,f,j);a.bezierCurveTo(f-g,j,c,q+b,c,q);a.closePath()}}}(ChemDoodle.structures,vec3,Math);
ChemDoodle.math=function(b,e,a){var h={},c={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};h.angleBetweenLargest=function(d){if(0===d.length)return{angle:0,largest:2*a.PI};if(1===d.length)return{angle:d[0]+a.PI,largest:2*a.PI};for(var f=0,c=0,g=0,b=d.length-1;g<b;g++){var m=d[g+1]-d[g];
m>f&&(f=m,c=(d[g+1]+d[g])/2)}g=d[0]+2*a.PI-d[d.length-1];g>f&&(c=d[0]-g/2,f=g,0>c&&(c+=2*a.PI));return{angle:c,largest:f}};h.isBetween=function(a,f,c){if(f>c)var g=f,f=c,c=g;return a>=f&&a<=c};h.getRGB=function(a,f){var q=[0,0,0];c[a.toLowerCase()]&&(a=c[a.toLowerCase()]);if("#"===a.charAt(0))return 4===a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),[parseInt(a.substring(1,3),16)/255*f,parseInt(a.substring(3,5),16)/255*f,parseInt(a.substring(5,7),16)/255*
f];if(b.stringStartsWith(a,"rgb")){var g=a.replace(/rgb\(|\)/g,"").split(",");return 3!==g.length?q:[parseInt(g[0])/255*f,parseInt(g[1])/255*f,parseInt(g[2])/255*f]}return q};h.distanceFromPointToLineInclusive=function(d,f,c){var g=f.distance(c),c=f.angle(c),c=a.PI/2-c,c=f.angle(d)+c,d=f.distance(d),d=new e.Point(d*a.cos(c),-d*a.sin(c));return h.isBetween(-d.y,0,g)?a.abs(d.x):-1};h.calculateDistanceInterior=function(d,f,c){if(this.isBetween(f.x,c.x,c.x+c.w)&&this.isBetween(f.y,c.y,c.y+c.w))return d.distance(f);
var g=[];g.push({x1:c.x,y1:c.y,x2:c.x+c.w,y2:c.y});g.push({x1:c.x,y1:c.y+c.h,x2:c.x+c.w,y2:c.y+c.h});g.push({x1:c.x,y1:c.y,x2:c.x,y2:c.y+c.h});g.push({x1:c.x+c.w,y1:c.y,x2:c.x+c.w,y2:c.y+c.h});for(var c=[],b=0;4>b;b++){var m=g[b];(m=this.intersectLines(f.x,f.y,d.x,d.y,m.x1,m.y1,m.x2,m.y2))&&c.push(m)}if(0===c.length)return 0;b=f=0;for(g=c.length;b<g;b++)var m=c[b],j=d.x-m.x,m=d.y-m.y,f=a.max(f,a.sqrt(j*j+m*m));return f};h.intersectLines=function(a,f,c,g,b,m,j,e){var c=c-a,g=g-f,j=j-b,e=e-m,h=g*j-
c*e;if(0===h)return!1;j=(e*(a-b)-j*(f-m))/h;b=(g*(a-b)-c*(f-m))/h;return 0<=b&&1>=b&&0<=j&&1>=j?{x:a+j*c,y:f+j*g}:!1};h.hsl2rgb=function(a,f,c){var g=function(a,d,c){0>c?c+=1:1<c&&(c-=1);return c<1/6?a+6*(d-a)*c:0.5>c?d:c<2/3?a+6*(d-a)*(2/3-c):a};if(0===f)c=f=a=c;else var b=0.5>c?c*(1+f):c+f-c*f,m=2*c-b,c=g(m,b,a+1/3),f=g(m,b,a),a=g(m,b,a-1/3);return[255*c,255*f,255*a]};h.isPointInPoly=function(a,c){for(var b=!1,g=-1,e=a.length,m=e-1;++g<e;m=g)(a[g].y<=c.y&&c.y<a[m].y||a[m].y<=c.y&&c.y<a[g].y)&&c.x<
(a[m].x-a[g].x)*(c.y-a[g].y)/(a[m].y-a[g].y)+a[g].x&&(b=!b);return b};return h}(ChemDoodle.extensions,ChemDoodle.structures,Math);
(function(b,e){b.Bounds=function(){this.minX=this.minY=Infinity;this.maxX=this.maxY=-Infinity;this.expand=function(a,h,c,d){a instanceof b.Bounds?(this.minX=e.min(this.minX,a.minX),this.minY=e.min(this.minY,a.minY),this.maxX=e.max(this.maxX,a.maxX),this.maxY=e.max(this.maxY,a.maxY)):(this.minX=e.min(this.minX,a),this.maxX=e.max(this.maxX,a),this.minY=e.min(this.minY,h),this.maxY=e.max(this.maxY,h),void 0!==c&&void 0!==d&&(this.minX=e.min(this.minX,c),this.maxX=e.max(this.maxX,c),this.minY=e.min(this.minY,
d),this.maxY=e.max(this.maxY,d)))};return!0}})(ChemDoodle.math,Math);
ChemDoodle.featureDetection=function(b,e,a,h){var c={supports_canvas:function(){return!!a.createElement("canvas").getContext},supports_canvas_text:function(){return!c.supports_canvas()?!1:"function"===typeof a.createElement("canvas").getContext("2d").fillText},supports_webgl:function(){var c=a.createElement("canvas");try{if(c.getContext("webgl")||c.getContext("experimental-webgl"))return!0}catch(f){}return!1},supports_xhr2:function(){return e.support.cors},supports_touch:function(){return"ontouchstart"in
h},supports_gesture:function(){return"ongesturestart"in h}};return c}(ChemDoodle.iChemLabs,jQuery,document,window);ChemDoodle.SYMBOLS="H,He,Li,Be,B,C,N,O,F,Ne,Na,Mg,Al,Si,P,S,Cl,Ar,K,Ca,Sc,Ti,V,Cr,Mn,Fe,Co,Ni,Cu,Zn,Ga,Ge,As,Se,Br,Kr,Rb,Sr,Y,Zr,Nb,Mo,Tc,Ru,Rh,Pd,Ag,Cd,In,Sn,Sb,Te,I,Xe,Cs,Ba,La,Ce,Pr,Nd,Pm,Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,W,Re,Os,Ir,Pt,Au,Hg,Tl,Pb,Bi,Po,At,Rn,Fr,Ra,Ac,Th,Pa,U,Np,Pu,Am,Cm,Bk,Cf,Es,Fm,Md,No,Lr,Rf,Db,Sg,Bh,Hs,Mt,Ds,Rg,Cn,Uut,Uuq,Uup,Uuh,Uus,Uuo".split(",");
ChemDoodle.ELEMENT=function(b){function e(a,c,b){this.symbol=a;this.name=c;this.atomicNumber=b;return!0}var a=[];a.H=new e("H","Hydrogen",1);a.He=new e("He","Helium",2);a.Li=new e("Li","Lithium",3);a.Be=new e("Be","Beryllium",4);a.B=new e("B","Boron",5);a.C=new e("C","Carbon",6);a.N=new e("N","Nitrogen",7);a.O=new e("O","Oxygen",8);a.F=new e("F","Fluorine",9);a.Ne=new e("Ne","Neon",10);a.Na=new e("Na","Sodium",11);a.Mg=new e("Mg","Magnesium",12);a.Al=new e("Al","Aluminum",13);a.Si=new e("Si","Silicon",
14);a.P=new e("P","Phosphorus",15);a.S=new e("S","Sulfur",16);a.Cl=new e("Cl","Chlorine",17);a.Ar=new e("Ar","Argon",18);a.K=new e("K","Potassium",19);a.Ca=new e("Ca","Calcium",20);a.Sc=new e("Sc","Scandium",21);a.Ti=new e("Ti","Titanium",22);a.V=new e("V","Vanadium",23);a.Cr=new e("Cr","Chromium",24);a.Mn=new e("Mn","Manganese",25);a.Fe=new e("Fe","Iron",26);a.Co=new e("Co","Cobalt",27);a.Ni=new e("Ni","Nickel",28);a.Cu=new e("Cu","Copper",29);a.Zn=new e("Zn","Zinc",30);a.Ga=new e("Ga","Gallium",
31);a.Ge=new e("Ge","Germanium",32);a.As=new e("As","Arsenic",33);a.Se=new e("Se","Selenium",34);a.Br=new e("Br","Bromine",35);a.Kr=new e("Kr","Krypton",36);a.Rb=new e("Rb","Rubidium",37);a.Sr=new e("Sr","Strontium",38);a.Y=new e("Y","Yttrium",39);a.Zr=new e("Zr","Zirconium",40);a.Nb=new e("Nb","Niobium",41);a.Mo=new e("Mo","Molybdenum",42);a.Tc=new e("Tc","Technetium",43);a.Ru=new e("Ru","Ruthenium",44);a.Rh=new e("Rh","Rhodium",45);a.Pd=new e("Pd","Palladium",46);a.Ag=new e("Ag","Silver",47);a.Cd=
new e("Cd","Cadmium",48);a.In=new e("In","Indium",49);a.Sn=new e("Sn","Tin",50);a.Sb=new e("Sb","Antimony",51);a.Te=new e("Te","Tellurium",52);a.I=new e("I","Iodine",53);a.Xe=new e("Xe","Xenon",54);a.Cs=new e("Cs","Cesium",55);a.Ba=new e("Ba","Barium",56);a.La=new e("La","Lanthanum",57);a.Ce=new e("Ce","Cerium",58);a.Pr=new e("Pr","Praseodymium",59);a.Nd=new e("Nd","Neodymium",60);a.Pm=new e("Pm","Promethium",61);a.Sm=new e("Sm","Samarium",62);a.Eu=new e("Eu","Europium",63);a.Gd=new e("Gd","Gadolinium",
64);a.Tb=new e("Tb","Terbium",65);a.Dy=new e("Dy","Dysprosium",66);a.Ho=new e("Ho","Holmium",67);a.Er=new e("Er","Erbium",68);a.Tm=new e("Tm","Thulium",69);a.Yb=new e("Yb","Ytterbium",70);a.Lu=new e("Lu","Lutetium",71);a.Hf=new e("Hf","Hafnium",72);a.Ta=new e("Ta","Tantalum",73);a.W=new e("W","Tungsten",74);a.Re=new e("Re","Rhenium",75);a.Os=new e("Os","Osmium",76);a.Ir=new e("Ir","Iridium",77);a.Pt=new e("Pt","Platinum",78);a.Au=new e("Au","Gold",79);a.Hg=new e("Hg","Mercury",80);a.Tl=new e("Tl",
"Thallium",81);a.Pb=new e("Pb","Lead",82);a.Bi=new e("Bi","Bismuth",83);a.Po=new e("Po","Polonium",84);a.At=new e("At","Astatine",85);a.Rn=new e("Rn","Radon",86);a.Fr=new e("Fr","Francium",87);a.Ra=new e("Ra","Radium",88);a.Ac=new e("Ac","Actinium",89);a.Th=new e("Th","Thorium",90);a.Pa=new e("Pa","Protactinium",91);a.U=new e("U","Uranium",92);a.Np=new e("Np","Neptunium",93);a.Pu=new e("Pu","Plutonium",94);a.Am=new e("Am","Americium",95);a.Cm=new e("Cm","Curium",96);a.Bk=new e("Bk","Berkelium",97);
a.Cf=new e("Cf","Californium",98);a.Es=new e("Es","Einsteinium",99);a.Fm=new e("Fm","Fermium",100);a.Md=new e("Md","Mendelevium",101);a.No=new e("No","Nobelium",102);a.Lr=new e("Lr","Lawrencium",103);a.Rf=new e("Rf","Rutherfordium",104);a.Db=new e("Db","Dubnium",105);a.Sg=new e("Sg","Seaborgium",106);a.Bh=new e("Bh","Bohrium",107);a.Hs=new e("Hs","Hassium",108);a.Mt=new e("Mt","Meitnerium",109);a.Ds=new e("Ds","Darmstadtium",110);a.Rg=new e("Rg","Roentgenium",111);a.Cn=new e("Cn","Copernicium",112);
a.Uut=new e("Uut","Ununtrium",113);a.Uuq=new e("Uuq","Ununquadium",114);a.Uup=new e("Uup","Ununpentium",115);a.Uuh=new e("Uuh","Ununhexium",116);a.Uus=new e("Uus","Ununseptium",117);a.Uuo=new e("Uuo","Ununoctium",118);a.H.jmolColor="#FFFFFF";a.He.jmolColor="#D9FFFF";a.Li.jmolColor="#CC80FF";a.Be.jmolColor="#C2FF00";a.B.jmolColor="#FFB5B5";a.C.jmolColor="#909090";a.N.jmolColor="#3050F8";a.O.jmolColor="#FF0D0D";a.F.jmolColor="#90E050";a.Ne.jmolColor="#B3E3F5";a.Na.jmolColor="#AB5CF2";a.Mg.jmolColor=
"#8AFF00";a.Al.jmolColor="#BFA6A6";a.Si.jmolColor="#F0C8A0";a.P.jmolColor="#FF8000";a.S.jmolColor="#FFFF30";a.Cl.jmolColor="#1FF01F";a.Ar.jmolColor="#80D1E3";a.K.jmolColor="#8F40D4";a.Ca.jmolColor="#3DFF00";a.Sc.jmolColor="#E6E6E6";a.Ti.jmolColor="#BFC2C7";a.V.jmolColor="#A6A6AB";a.Cr.jmolColor="#8A99C7";a.Mn.jmolColor="#9C7AC7";a.Fe.jmolColor="#E06633";a.Co.jmolColor="#F090A0";a.Ni.jmolColor="#50D050";a.Cu.jmolColor="#C88033";a.Zn.jmolColor="#7D80B0";a.Ga.jmolColor="#C28F8F";a.Ge.jmolColor="#668F8F";
a.As.jmolColor="#BD80E3";a.Se.jmolColor="#FFA100";a.Br.jmolColor="#A62929";a.Kr.jmolColor="#5CB8D1";a.Rb.jmolColor="#702EB0";a.Sr.jmolColor="#00FF00";a.Y.jmolColor="#94FFFF";a.Zr.jmolColor="#94E0E0";a.Nb.jmolColor="#73C2C9";a.Mo.jmolColor="#54B5B5";a.Tc.jmolColor="#3B9E9E";a.Ru.jmolColor="#248F8F";a.Rh.jmolColor="#0A7D8C";a.Pd.jmolColor="#006985";a.Ag.jmolColor="#C0C0C0";a.Cd.jmolColor="#FFD98F";a.In.jmolColor="#A67573";a.Sn.jmolColor="#668080";a.Sb.jmolColor="#9E63B5";a.Te.jmolColor="#D47A00";a.I.jmolColor=
"#940094";a.Xe.jmolColor="#429EB0";a.Cs.jmolColor="#57178F";a.Ba.jmolColor="#00C900";a.La.jmolColor="#70D4FF";a.Ce.jmolColor="#FFFFC7";a.Pr.jmolColor="#D9FFC7";a.Nd.jmolColor="#C7FFC7";a.Pm.jmolColor="#A3FFC7";a.Sm.jmolColor="#8FFFC7";a.Eu.jmolColor="#61FFC7";a.Gd.jmolColor="#45FFC7";a.Tb.jmolColor="#30FFC7";a.Dy.jmolColor="#1FFFC7";a.Ho.jmolColor="#00FF9C";a.Er.jmolColor="#00E675";a.Tm.jmolColor="#00D452";a.Yb.jmolColor="#00BF38";a.Lu.jmolColor="#00AB24";a.Hf.jmolColor="#4DC2FF";a.Ta.jmolColor="#4DA6FF";
a.W.jmolColor="#2194D6";a.Re.jmolColor="#267DAB";a.Os.jmolColor="#266696";a.Ir.jmolColor="#175487";a.Pt.jmolColor="#D0D0E0";a.Au.jmolColor="#FFD123";a.Hg.jmolColor="#B8B8D0";a.Tl.jmolColor="#A6544D";a.Pb.jmolColor="#575961";a.Bi.jmolColor="#9E4FB5";a.Po.jmolColor="#AB5C00";a.At.jmolColor="#754F45";a.Rn.jmolColor="#428296";a.Fr.jmolColor="#420066";a.Ra.jmolColor="#007D00";a.Ac.jmolColor="#70ABFA";a.Th.jmolColor="#00BAFF";a.Pa.jmolColor="#00A1FF";a.U.jmolColor="#008FFF";a.Np.jmolColor="#0080FF";a.Pu.jmolColor=
"#006BFF";a.Am.jmolColor="#545CF2";a.Cm.jmolColor="#785CE3";a.Bk.jmolColor="#8A4FE3";a.Cf.jmolColor="#A136D4";a.Es.jmolColor="#B31FD4";a.Fm.jmolColor="#B31FBA";a.Md.jmolColor="#B30DA6";a.No.jmolColor="#BD0D87";a.Lr.jmolColor="#C70066";a.Rf.jmolColor="#CC0059";a.Db.jmolColor="#D1004F";a.Sg.jmolColor="#D90045";a.Bh.jmolColor="#E00038";a.Hs.jmolColor="#E6002E";a.Mt.jmolColor="#EB0026";a.Ds.jmolColor="#000000";a.Rg.jmolColor="#000000";a.Cn.jmolColor="#000000";a.Uut.jmolColor="#000000";a.Uuq.jmolColor=
"#000000";a.Uup.jmolColor="#000000";a.Uuh.jmolColor="#000000";a.Uus.jmolColor="#000000";a.Uuo.jmolColor="#000000";for(var h=0,c=b.length;h<c;h++)a[b[h]].pymolColor=a[b[h]].jmolColor;a.H.pymolColor="#E6E6E6";a.C.pymolColor="#33FF33";a.N.pymolColor="#3333FF";a.O.pymolColor="#FF4D4D";a.F.pymolColor="#B3FFFF";a.S.pymolColor="#E6C640";a.H.covalentRadius=0.31;a.He.covalentRadius=0.28;a.Li.covalentRadius=1.28;a.Be.covalentRadius=0.96;a.B.covalentRadius=0.84;a.C.covalentRadius=0.76;a.N.covalentRadius=0.71;
a.O.covalentRadius=0.66;a.F.covalentRadius=0.57;a.Ne.covalentRadius=0.58;a.Na.covalentRadius=1.66;a.Mg.covalentRadius=1.41;a.Al.covalentRadius=1.21;a.Si.covalentRadius=1.11;a.P.covalentRadius=1.07;a.S.covalentRadius=1.05;a.Cl.covalentRadius=1.02;a.Ar.covalentRadius=1.06;a.K.covalentRadius=2.03;a.Ca.covalentRadius=1.76;a.Sc.covalentRadius=1.7;a.Ti.covalentRadius=1.6;a.V.covalentRadius=1.53;a.Cr.covalentRadius=1.39;a.Mn.covalentRadius=1.39;a.Fe.covalentRadius=1.32;a.Co.covalentRadius=1.26;a.Ni.covalentRadius=
1.24;a.Cu.covalentRadius=1.32;a.Zn.covalentRadius=1.22;a.Ga.covalentRadius=1.22;a.Ge.covalentRadius=1.2;a.As.covalentRadius=1.19;a.Se.covalentRadius=1.2;a.Br.covalentRadius=1.2;a.Kr.covalentRadius=1.16;a.Rb.covalentRadius=2.2;a.Sr.covalentRadius=1.95;a.Y.covalentRadius=1.9;a.Zr.covalentRadius=1.75;a.Nb.covalentRadius=1.64;a.Mo.covalentRadius=1.54;a.Tc.covalentRadius=1.47;a.Ru.covalentRadius=1.46;a.Rh.covalentRadius=1.42;a.Pd.covalentRadius=1.39;a.Ag.covalentRadius=1.45;a.Cd.covalentRadius=1.44;a.In.covalentRadius=
1.42;a.Sn.covalentRadius=1.39;a.Sb.covalentRadius=1.39;a.Te.covalentRadius=1.38;a.I.covalentRadius=1.39;a.Xe.covalentRadius=1.4;a.Cs.covalentRadius=2.44;a.Ba.covalentRadius=2.15;a.La.covalentRadius=2.07;a.Ce.covalentRadius=2.04;a.Pr.covalentRadius=2.03;a.Nd.covalentRadius=2.01;a.Pm.covalentRadius=1.99;a.Sm.covalentRadius=1.98;a.Eu.covalentRadius=1.98;a.Gd.covalentRadius=1.96;a.Tb.covalentRadius=1.94;a.Dy.covalentRadius=1.92;a.Ho.covalentRadius=1.92;a.Er.covalentRadius=1.89;a.Tm.covalentRadius=1.9;
a.Yb.covalentRadius=1.87;a.Lu.covalentRadius=1.87;a.Hf.covalentRadius=1.75;a.Ta.covalentRadius=1.7;a.W.covalentRadius=1.62;a.Re.covalentRadius=1.51;a.Os.covalentRadius=1.44;a.Ir.covalentRadius=1.41;a.Pt.covalentRadius=1.36;a.Au.covalentRadius=1.36;a.Hg.covalentRadius=1.32;a.Tl.covalentRadius=1.45;a.Pb.covalentRadius=1.46;a.Bi.covalentRadius=1.48;a.Po.covalentRadius=1.4;a.At.covalentRadius=1.5;a.Rn.covalentRadius=1.5;a.Fr.covalentRadius=2.6;a.Ra.covalentRadius=2.21;a.Ac.covalentRadius=2.15;a.Th.covalentRadius=
2.06;a.Pa.covalentRadius=2;a.U.covalentRadius=1.96;a.Np.covalentRadius=1.9;a.Pu.covalentRadius=1.87;a.Am.covalentRadius=1.8;a.Cm.covalentRadius=1.69;a.Bk.covalentRadius=0;a.Cf.covalentRadius=0;a.Es.covalentRadius=0;a.Fm.covalentRadius=0;a.Md.covalentRadius=0;a.No.covalentRadius=0;a.Lr.covalentRadius=0;a.Rf.covalentRadius=0;a.Db.covalentRadius=0;a.Sg.covalentRadius=0;a.Bh.covalentRadius=0;a.Hs.covalentRadius=0;a.Mt.covalentRadius=0;a.Ds.covalentRadius=0;a.Rg.covalentRadius=0;a.Cn.covalentRadius=0;
a.Uut.covalentRadius=0;a.Uuq.covalentRadius=0;a.Uup.covalentRadius=0;a.Uuh.covalentRadius=0;a.Uus.covalentRadius=0;a.Uuo.covalentRadius=0;a.H.vdWRadius=1.2;a.He.vdWRadius=1.4;a.Li.vdWRadius=1.82;a.Be.vdWRadius=0;a.B.vdWRadius=0;a.C.vdWRadius=1.7;a.N.vdWRadius=1.55;a.O.vdWRadius=1.52;a.F.vdWRadius=1.47;a.Ne.vdWRadius=1.54;a.Na.vdWRadius=2.27;a.Mg.vdWRadius=1.73;a.Al.vdWRadius=0;a.Si.vdWRadius=2.1;a.P.vdWRadius=1.8;a.S.vdWRadius=1.8;a.Cl.vdWRadius=1.75;a.Ar.vdWRadius=1.88;a.K.vdWRadius=2.75;a.Ca.vdWRadius=
0;a.Sc.vdWRadius=0;a.Ti.vdWRadius=0;a.V.vdWRadius=0;a.Cr.vdWRadius=0;a.Mn.vdWRadius=0;a.Fe.vdWRadius=0;a.Co.vdWRadius=0;a.Ni.vdWRadius=1.63;a.Cu.vdWRadius=1.4;a.Zn.vdWRadius=1.39;a.Ga.vdWRadius=1.87;a.Ge.vdWRadius=0;a.As.vdWRadius=1.85;a.Se.vdWRadius=1.9;a.Br.vdWRadius=1.85;a.Kr.vdWRadius=2.02;a.Rb.vdWRadius=0;a.Sr.vdWRadius=0;a.Y.vdWRadius=0;a.Zr.vdWRadius=0;a.Nb.vdWRadius=0;a.Mo.vdWRadius=0;a.Tc.vdWRadius=0;a.Ru.vdWRadius=0;a.Rh.vdWRadius=0;a.Pd.vdWRadius=1.63;a.Ag.vdWRadius=1.72;a.Cd.vdWRadius=
1.58;a.In.vdWRadius=1.93;a.Sn.vdWRadius=2.17;a.Sb.vdWRadius=0;a.Te.vdWRadius=2.06;a.I.vdWRadius=1.98;a.Xe.vdWRadius=2.16;a.Cs.vdWRadius=0;a.Ba.vdWRadius=0;a.La.vdWRadius=0;a.Ce.vdWRadius=0;a.Pr.vdWRadius=0;a.Nd.vdWRadius=0;a.Pm.vdWRadius=0;a.Sm.vdWRadius=0;a.Eu.vdWRadius=0;a.Gd.vdWRadius=0;a.Tb.vdWRadius=0;a.Dy.vdWRadius=0;a.Ho.vdWRadius=0;a.Er.vdWRadius=0;a.Tm.vdWRadius=0;a.Yb.vdWRadius=0;a.Lu.vdWRadius=0;a.Hf.vdWRadius=0;a.Ta.vdWRadius=0;a.W.vdWRadius=0;a.Re.vdWRadius=0;a.Os.vdWRadius=0;a.Ir.vdWRadius=
0;a.Pt.vdWRadius=1.75;a.Au.vdWRadius=1.66;a.Hg.vdWRadius=1.55;a.Tl.vdWRadius=1.96;a.Pb.vdWRadius=2.02;a.Bi.vdWRadius=0;a.Po.vdWRadius=0;a.At.vdWRadius=0;a.Rn.vdWRadius=0;a.Fr.vdWRadius=0;a.Ra.vdWRadius=0;a.Ac.vdWRadius=0;a.Th.vdWRadius=0;a.Pa.vdWRadius=0;a.U.vdWRadius=1.86;a.Np.vdWRadius=0;a.Pu.vdWRadius=0;a.Am.vdWRadius=0;a.Cm.vdWRadius=0;a.Bk.vdWRadius=0;a.Cf.vdWRadius=0;a.Es.vdWRadius=0;a.Fm.vdWRadius=0;a.Md.vdWRadius=0;a.No.vdWRadius=0;a.Lr.vdWRadius=0;a.Rf.vdWRadius=0;a.Db.vdWRadius=0;a.Sg.vdWRadius=
0;a.Bh.vdWRadius=0;a.Hs.vdWRadius=0;a.Mt.vdWRadius=0;a.Ds.vdWRadius=0;a.Rg.vdWRadius=0;a.Cn.vdWRadius=0;a.Uut.vdWRadius=0;a.Uuq.vdWRadius=0;a.Uup.vdWRadius=0;a.Uuh.vdWRadius=0;a.Uus.vdWRadius=0;a.Uuo.vdWRadius=0;a.H.valency=1;a.He.valency=0;a.Li.valency=1;a.Be.valency=2;a.B.valency=3;a.C.valency=4;a.N.valency=3;a.O.valency=2;a.F.valency=1;a.Ne.valency=0;a.Na.valency=1;a.Mg.valency=0;a.Al.valency=0;a.Si.valency=4;a.P.valency=3;a.S.valency=2;a.Cl.valency=1;a.Ar.valency=0;a.K.valency=0;a.Ca.valency=
0;a.Sc.valency=0;a.Ti.valency=1;a.V.valency=1;a.Cr.valency=2;a.Mn.valency=3;a.Fe.valency=2;a.Co.valency=1;a.Ni.valency=1;a.Cu.valency=0;a.Zn.valency=0;a.Ga.valency=0;a.Ge.valency=4;a.As.valency=3;a.Se.valency=2;a.Br.valency=1;a.Kr.valency=0;a.Rb.valency=0;a.Sr.valency=0;a.Y.valency=0;a.Zr.valency=0;a.Nb.valency=1;a.Mo.valency=2;a.Tc.valency=3;a.Ru.valency=2;a.Rh.valency=1;a.Pd.valency=0;a.Ag.valency=0;a.Cd.valency=0;a.In.valency=0;a.Sn.valency=4;a.Sb.valency=3;a.Te.valency=2;a.I.valency=1;a.Xe.valency=
0;a.Cs.valency=0;a.Ba.valency=0;a.La.valency=0;a.Ce.valency=0;a.Pr.valency=0;a.Nd.valency=0;a.Pm.valency=0;a.Sm.valency=0;a.Eu.valency=0;a.Gd.valency=0;a.Tb.valency=0;a.Dy.valency=0;a.Ho.valency=0;a.Er.valency=0;a.Tm.valency=0;a.Yb.valency=0;a.Lu.valency=0;a.Hf.valency=0;a.Ta.valency=1;a.W.valency=2;a.Re.valency=3;a.Os.valency=2;a.Ir.valency=3;a.Pt.valency=0;a.Au.valency=1;a.Hg.valency=0;a.Tl.valency=0;a.Pb.valency=4;a.Bi.valency=3;a.Po.valency=2;a.At.valency=1;a.Rn.valency=0;a.Fr.valency=0;a.Ra.valency=
0;a.Ac.valency=0;a.Th.valency=0;a.Pa.valency=0;a.U.valency=0;a.Np.valency=0;a.Pu.valency=0;a.Am.valency=0;a.Cm.valency=0;a.Bk.valency=0;a.Cf.valency=0;a.Es.valency=0;a.Fm.valency=0;a.Md.valency=0;a.No.valency=0;a.Lr.valency=0;a.Rf.valency=0;a.Db.valency=0;a.Sg.valency=0;a.Bh.valency=0;a.Hs.valency=0;a.Mt.valency=0;a.Ds.valency=0;a.Rg.valency=0;a.Cn.valency=0;a.Uut.valency=0;a.Uuq.valency=0;a.Uup.valency=0;a.Uuh.valency=0;a.Uus.valency=0;a.Uuo.valency=0;a.H.mass=1;a.He.mass=4;a.Li.mass=7;a.Be.mass=
9;a.B.mass=11;a.C.mass=12;a.N.mass=14;a.O.mass=16;a.F.mass=19;a.Ne.mass=20;a.Na.mass=23;a.Mg.mass=24;a.Al.mass=27;a.Si.mass=28;a.P.mass=31;a.S.mass=32;a.Cl.mass=35;a.Ar.mass=40;a.K.mass=39;a.Ca.mass=40;a.Sc.mass=45;a.Ti.mass=48;a.V.mass=51;a.Cr.mass=52;a.Mn.mass=55;a.Fe.mass=56;a.Co.mass=59;a.Ni.mass=58;a.Cu.mass=63;a.Zn.mass=64;a.Ga.mass=69;a.Ge.mass=74;a.As.mass=75;a.Se.mass=80;a.Br.mass=79;a.Kr.mass=84;a.Rb.mass=85;a.Sr.mass=88;a.Y.mass=89;a.Zr.mass=90;a.Nb.mass=93;a.Mo.mass=98;a.Tc.mass=0;a.Ru.mass=
102;a.Rh.mass=103;a.Pd.mass=106;a.Ag.mass=107;a.Cd.mass=114;a.In.mass=115;a.Sn.mass=120;a.Sb.mass=121;a.Te.mass=130;a.I.mass=127;a.Xe.mass=132;a.Cs.mass=133;a.Ba.mass=138;a.La.mass=139;a.Ce.mass=140;a.Pr.mass=141;a.Nd.mass=142;a.Pm.mass=0;a.Sm.mass=152;a.Eu.mass=153;a.Gd.mass=158;a.Tb.mass=159;a.Dy.mass=164;a.Ho.mass=165;a.Er.mass=166;a.Tm.mass=169;a.Yb.mass=174;a.Lu.mass=175;a.Hf.mass=180;a.Ta.mass=181;a.W.mass=184;a.Re.mass=187;a.Os.mass=192;a.Ir.mass=193;a.Pt.mass=195;a.Au.mass=197;a.Hg.mass=202;
a.Tl.mass=205;a.Pb.mass=208;a.Bi.mass=209;a.Po.mass=0;a.At.mass=0;a.Rn.mass=0;a.Fr.mass=0;a.Ra.mass=0;a.Ac.mass=0;a.Th.mass=232;a.Pa.mass=231;a.U.mass=238;a.Np.mass=0;a.Pu.mass=0;a.Am.mass=0;a.Cm.mass=0;a.Bk.mass=0;a.Cf.mass=0;a.Es.mass=0;a.Fm.mass=0;a.Md.mass=0;a.No.mass=0;a.Lr.mass=0;a.Rf.mass=0;a.Db.mass=0;a.Sg.mass=0;a.Bh.mass=0;a.Hs.mass=0;a.Mt.mass=0;a.Ds.mass=0;a.Rg.mass=0;a.Cn.mass=0;a.Uut.mass=0;a.Uuq.mass=0;a.Uup.mass=0;a.Uuh.mass=0;a.Uus.mass=0;a.Uuo.mass=0;return a}(ChemDoodle.SYMBOLS);
ChemDoodle.RESIDUE=function(){function b(a,b){this.symbol=a;this.name=b;return!0}var e=[];e.Ala=new b("Ala","Alanine");e.Arg=new b("Arg","Arginine");e.Asn=new b("Asn","Asparagine");e.Asp=new b("Asp","Aspartic Acid");e.Cys=new b("Cys","Cysteine");e.Gln=new b("Gln","Glutamine");e.Glu=new b("Glu","Glutamic Acid");e.Gly=new b("Gly","Glycine");e.His=new b("His","Histidine");e.Ile=new b("Ile","Isoleucine");e.Leu=new b("Leu","Leucine");e.Lys=new b("Lys","Lysine");e.Met=new b("Met","Methionine");e.Phe=new b("Phe",
"Phenylalanine");e.Pro=new b("Pro","Proline");e.Ser=new b("Ser","Serine");e.Thr=new b("Thr","Threonine");e.Trp=new b("Trp","Tryptophan");e.Tyr=new b("Tyr","Tyrosine");e.Val=new b("Val","Valine");e.Asx=new b("Asx","Asparagine/Aspartic Acid");e.Glx=new b("Glx","Glutamine/Glutamic Acid");e["*"]=new b("*","Other");e.A=new b("A","Adenine");e.G=new b("G","Guanine");e.I=new b("I","");e.C=new b("C","Cytosine");e.T=new b("T","Thymine");e.U=new b("U","Uracil");e.Ala.polar=!1;e.Arg.polar=!0;e.Asn.polar=!0;e.Asp.polar=
!0;e.Cys.polar=!0;e.Gln.polar=!0;e.Glu.polar=!0;e.Gly.polar=!1;e.His.polar=!0;e.Ile.polar=!1;e.Leu.polar=!1;e.Lys.polar=!0;e.Met.polar=!1;e.Phe.polar=!1;e.Pro.polar=!1;e.Ser.polar=!0;e.Thr.polar=!0;e.Trp.polar=!0;e.Tyr.polar=!0;e.Val.polar=!1;e.Asx.polar=!0;e.Glx.polar=!0;e.Ala.aminoColor="#C8C8C8";e.Arg.aminoColor="#145AFF";e.Asn.aminoColor="#00DCDC";e.Asp.aminoColor="#E60A0A";e.Cys.aminoColor="#E6E600";e.Gln.aminoColor="#00DCDC";e.Glu.aminoColor="#E60A0A";e.Gly.aminoColor="#EBEBEB";e.His.aminoColor=
"#8282D2";e.Ile.aminoColor="#0F820F";e.Leu.aminoColor="#0F820F";e.Lys.aminoColor="#145AFF";e.Met.aminoColor="#E6E600";e.Phe.aminoColor="#3232AA";e.Pro.aminoColor="#DC9682";e.Ser.aminoColor="#FA9600";e.Thr.aminoColor="#FA9600";e.Trp.aminoColor="#B45AB4";e.Tyr.aminoColor="#3232AA";e.Val.aminoColor="#0F820F";e.Asx.aminoColor="#FF69B4";e.Glx.aminoColor="#FF69B4";e["*"].aminoColor="#BEA06E";e.A.aminoColor="#BEA06E";e.G.aminoColor="#BEA06E";e.I.aminoColor="#BEA06E";e.C.aminoColor="#BEA06E";e.T.aminoColor=
"#BEA06E";e.U.aminoColor="#BEA06E";e.Ala.shapelyColor="#8CFF8C";e.Arg.shapelyColor="#00007C";e.Asn.shapelyColor="#FF7C70";e.Asp.shapelyColor="#A00042";e.Cys.shapelyColor="#FFFF70";e.Gln.shapelyColor="#FF4C4C";e.Glu.shapelyColor="#660000";e.Gly.shapelyColor="#FFFFFF";e.His.shapelyColor="#7070FF";e.Ile.shapelyColor="#004C00";e.Leu.shapelyColor="#455E45";e.Lys.shapelyColor="#4747B8";e.Met.shapelyColor="#B8A042";e.Phe.shapelyColor="#534C52";e.Pro.shapelyColor="#525252";e.Ser.shapelyColor="#FF7042";e.Thr.shapelyColor=
"#B84C00";e.Trp.shapelyColor="#4F4600";e.Tyr.shapelyColor="#8C704C";e.Val.shapelyColor="#FF8CFF";e.Asx.shapelyColor="#FF00FF";e.Glx.shapelyColor="#FF00FF";e["*"].shapelyColor="#FF00FF";e.A.shapelyColor="#A0A0FF";e.G.shapelyColor="#FF7070";e.I.shapelyColor="#80FFFF";e.C.shapelyColor="#FF8C4B";e.T.shapelyColor="#A0FFA0";e.U.shapelyColor="#FF8080";return e}();
(function(b){b.Queue=function(){var b=[],a=0;this.getSize=function(){return b.length-a};this.isEmpty=function(){return 0===b.length};this.enqueue=function(a){b.push(a)};this.dequeue=function(){var h;b.length&&(h=b[a],2*++a>=b.length&&(b=b.slice(a),a=0));return h};this.getOldestElement=function(){var h;b.length&&(h=b[a]);return h}}})(ChemDoodle.structures);
(function(b,e){b.Point=function(a,b){this.x=a?a:0;this.y=b?b:0;this.sub=function(a){this.x-=a.x;this.y-=a.y};this.add=function(a){this.x+=a.x;this.y+=a.y};this.distance=function(a){var d=a.x-this.x,a=a.y-this.y;return e.sqrt(d*d+a*a)};this.angleForStupidCanvasArcs=function(a){for(var d=a.x-this.x,a=a.y-this.y,f=0,f=0===d?0===a?0:0<a?e.PI/2:3*e.PI/2:0===a?0<d?0:e.PI:0>d?e.atan(a/d)+e.PI:0>a?e.atan(a/d)+2*e.PI:e.atan(a/d);0>f;)f+=2*e.PI;return f%=2*e.PI};this.angle=function(a){for(var d=a.x-this.x,
a=this.y-a.y,f=0,f=0===d?0===a?0:0<a?e.PI/2:3*e.PI/2:0===a?0<d?0:e.PI:0>d?e.atan(a/d)+e.PI:0>a?e.atan(a/d)+2*e.PI:e.atan(a/d);0>f;)f+=2*e.PI;return f%=2*e.PI};return!0}})(ChemDoodle.structures,Math);
(function(b,e,a,h,c,d){h.Atom=function(f,h,g,o){this.x=h?h:0;this.y=g?g:0;this.z=o?o:0;this.numRadical=this.numLonePair=this.charge=0;this.mass=-1;this.angleOfLeastInterference=this.bondNumber=this.coordinationNumber=0;this.isHidden=!1;this.label=f?f.replace(/\s/g,""):"C";b[this.label]||(this.label="C");this.altLabel=void 0;this.any=!1;this.rgroup=-1;this.isSelected=this.isHover=this.isLone=!1;this.add3D=function(a){this.x=this.x+a.x;this.y=this.y+a.y;this.z=this.z+a.z};this.sub3D=function(a){this.x=
this.x-a.x;this.y=this.y-a.y;this.z=this.z-a.z};this.distance3D=function(a){var d=a.x-this.x,f=a.y-this.y,a=a.z-this.z;return c.sqrt(d*d+f*f+a*a)};this.draw=function(a,d){if(this.isLassoed){var f=a.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);f.addColorStop(0,"rgba(212, 99, 0, 0)");f.addColorStop(0.7,"rgba(212, 99, 0, 0.8)");a.fillStyle=f;a.beginPath();a.arc(this.x,this.y,5,0,c.PI*2,false);a.fill()}this.textBounds=[];if(this.specs)d=this.specs;f=d.getFontString(d.atoms_font_size_2D,d.atoms_font_families_2D,
d.atoms_font_bold_2D,d.atoms_font_italic_2D);a.font=f;a.fillStyle=d.atoms_color;if(!this.any&&this.rgroup===-1)if(d.atoms_useJMOLColors)a.fillStyle=b[this.label].jmolColor;else if(d.atoms_usePYMOLColors)a.fillStyle=b[this.label].pymolColor;if(this.isLone&&!d.atoms_displayAllCarbonLabels_2D||d.atoms_circles_2D){a.beginPath();a.arc(this.x,this.y,d.atoms_circleDiameter_2D/2,0,c.PI*2,false);a.fill();if(d.atoms_circleBorderWidth_2D>0){a.lineWidth=d.atoms_circleBorderWidth_2D;a.strokeStyle="black";a.stroke(this.x,
this.y,0,c.PI*2,d.atoms_circleDiameter_2D/2)}}else if(this.isLabelVisible(d)){a.textAlign="center";a.textBaseline="middle";if(this.altLabel!==void 0){a.fillText(this.altLabel,this.x,this.y);var g=a.measureText(this.altLabel).width;this.textBounds.push({x:this.x-g/2,y:this.y-d.atoms_font_size_2D/2+1,w:g,h:d.atoms_font_size_2D-2})}else if(this.any){a.font=d.getFontString(d.atoms_font_size_2D+5,d.atoms_font_families_2D,true);a.fillText("*",this.x+1,this.y+3);g=a.measureText("*").width;this.textBounds.push({x:this.x-
g/2,y:this.y-d.atoms_font_size_2D/2+1,w:g,h:d.atoms_font_size_2D-2})}else if(this.rgroup!==-1){f="R"+this.rgroup;a.fillText(f,this.x,this.y);g=a.measureText(f).width;this.textBounds.push({x:this.x-g/2,y:this.y-d.atoms_font_size_2D/2+1,w:g,h:d.atoms_font_size_2D-2})}else{a.fillText(this.label,this.x,this.y);g=a.measureText(this.label).width;this.textBounds.push({x:this.x-g/2,y:this.y-d.atoms_font_size_2D/2+1,w:g,h:d.atoms_font_size_2D-2});if(this.mass!==-1){var h=d.getFontString(d.atoms_font_size_2D*
0.7,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),q=a.font;a.font=h;h=a.measureText(this.mass).width;a.fillText(this.mass,this.x-h-0.5,this.y-d.atoms_font_size_2D*0.3);a.font=q}q=this.getImplicitHydrogenCount();if(d.atoms_implicitHydrogens_2D&&q>0){var o=a.measureText("H").width;if(q>1){var x=g/2+o/2,t=0,h=d.getFontString(d.atoms_font_size_2D*0.8,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D);a.font=h;var y=a.measureText(q).width;if(this.bondNumber===
1)this.angleOfLeastInterference>c.PI/2&&this.angleOfLeastInterference<3*c.PI/2&&(x=-g/2-y-o/2);else if(!(this.angleOfLeastInterference<=c.PI/4))if(this.angleOfLeastInterference<3*c.PI/4){x=0;t=-d.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=5*c.PI/4)x=-g/2-y-o/2;else if(this.angleOfLeastInterference<7*c.PI/4){x=0;t=d.atoms_font_size_2D*0.9}a.font=f;a.fillText("H",this.x+x,this.y+t);a.font=h;a.fillText(q,this.x+x+o/2+y/2,this.y+t+d.atoms_font_size_2D*0.3);this.textBounds.push({x:this.x+
x-o/2,y:this.y+t-d.atoms_font_size_2D/2+1,w:o,h:d.atoms_font_size_2D-2});this.textBounds.push({x:this.x+x+o/2,y:this.y+t+d.atoms_font_size_2D*0.3-d.atoms_font_size_2D/2+1,w:y,h:d.atoms_font_size_2D*0.8-2})}else{x=g/2+o/2;t=0;if(this.bondNumber===1)this.angleOfLeastInterference>c.PI/2&&this.angleOfLeastInterference<3*c.PI/2&&(x=-g/2-o/2);else if(!(this.angleOfLeastInterference<=c.PI/4))if(this.angleOfLeastInterference<3*c.PI/4){x=0;t=-d.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=
5*c.PI/4)x=-g/2-o/2;else if(this.angleOfLeastInterference<7*c.PI/4){x=0;t=d.atoms_font_size_2D*0.9}a.fillText("H",this.x+x,this.y+t);this.textBounds.push({x:this.x+x-o/2,y:this.y+t-d.atoms_font_size_2D/2+1,w:o,h:d.atoms_font_size_2D-2})}}}if(this.charge!==0){f=this.charge.toFixed(0);f=f==="1"?"+":f==="-1"?"\u2013":e.stringStartsWith(f,"-")?f.substring(1)+"\u2013":f+"+";g=this.angleOfLeastInterference;h=d.atoms_font_size_2D;this.isLabelVisible(d)&&q>0&&(g=g+c.PI/4);a.textAlign="center";a.textBaseline=
"middle";a.fillText(f,this.x+h*c.cos(g),this.y-h*c.sin(g))}if(this.numLonePair>0||this.numRadical>0){a.fillStyle="black";if(this.bondNumber===2&&c.abs(this.largestAngle-c.PI)<c.PI/60)if(this.numRadical===0){this.drawElectrons(a,d,c.floor(this.numLonePair/2),0,this.angleOfLeastInterference,this.largestAngle);this.drawElectrons(a,d,c.floor(this.numLonePair/2)+this.numLonePair%2,0,this.angleOfLeastInterference+c.PI,this.largestAngle)}else if(this.numLonePair===0){this.drawElectrons(a,d,0,c.floor(this.numRadical/
2),this.angleOfLeastInterference,this.largestAngle);this.drawElectrons(a,d,0,c.floor(this.numRadical/2)+this.numRadical%2,this.angleOfLeastInterference+c.PI,this.largestAngle)}else{this.drawElectrons(a,d,this.numLonePair,0,this.angleOfLeastInterference,this.largestAngle);this.drawElectrons(a,d,0,this.numRadical,this.angleOfLeastInterference+c.PI,this.largestAngle)}else this.drawElectrons(a,d,this.numLonePair,this.numRadical,this.angleOfLeastInterference,this.largestAngle)}}};this.drawElectrons=function(a,
d,f,g,b,e){for(var h=e/(f+g+(this.bondNumber===0?0:1)),e=b-e/2+h,q=0;q<f;q++){var b=e+q*h,o=this.x+Math.cos(b)*d.atoms_lonePairDistance_2D,y=this.y-Math.sin(b)*d.atoms_lonePairDistance_2D,w=b+Math.PI/2,b=Math.cos(w)*d.atoms_lonePairSpread_2D/2,w=-Math.sin(w)*d.atoms_lonePairSpread_2D/2;a.beginPath();a.arc(o+b,y+w,d.atoms_lonePairDiameter_2D,0,c.PI*2,false);a.fill();a.beginPath();a.arc(o-b,y-w,d.atoms_lonePairDiameter_2D,0,c.PI*2,false);a.fill()}for(q=0;q<g;q++){b=e+(q+f)*h;o=this.x+Math.cos(b)*d.atoms_lonePairDistance_2D;
y=this.y-Math.sin(b)*d.atoms_lonePairDistance_2D;a.beginPath();a.arc(o,y,d.atoms_lonePairDiameter_2D,0,c.PI*2,false);a.fill()}};this.drawDecorations=function(a){if(this.isHover||this.isSelected){a.strokeStyle=this.isHover?"#885110":"#0060B2";a.lineWidth=1.2;a.beginPath();a.arc(this.x,this.y,this.isHover?7:15,0,c.PI*2,false);a.stroke()}if(this.isOverlap){a.strokeStyle="#C10000";a.lineWidth=1.2;a.beginPath();a.arc(this.x,this.y,7,0,c.PI*2,false);a.stroke()}};this.render=function(a,f){if(this.specs)f=
this.specs;var c=d.translate(a.modelViewMatrix,[this.x,this.y,this.z],[]),g=f.atoms_useVDWDiameters_3D?b[this.label].vdWRadius*f.atoms_vdwMultiplier_3D:f.atoms_sphereDiameter_3D/2;g===0&&(g=1);d.scale(c,[g,g,g]);g=f.atoms_color;if(f.atoms_useJMOLColors)g=b[this.label].jmolColor;else if(f.atoms_usePYMOLColors)g=b[this.label].pymolColor;a.material.setDiffuseColor(g);a.setMatrixUniforms(c);a.drawElements(a.TRIANGLES,(this.renderAsStar?a.starBuffer:a.sphereBuffer).vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,
0)};this.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||this.label!=="C"||this.altLabel||this.any||this.rgroup!==-1||this.mass!==-1||this.charge!==0||this.numLonePair!==0||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&this.bondNumber===1};this.getImplicitHydrogenCount=function(){if(this.label==="H"||!b[this.label])return 0;var a=b[this.label].valency,d=a-this.coordinationNumber;if(this.charge>0){a=4-a;d=this.charge<=a?d+this.charge:4-this.coordinationNumber-
this.charge+a}else d=d+this.charge;return d<0?0:d};this.getBounds=function(){var d=new a.Bounds;d.expand(this.x,this.y);if(this.textBounds)for(var f=0,g=this.textBounds.length;f<g;f++){var c=this.textBounds[f];d.expand(c.x,c.y,c.x+c.w,c.y+c.h)}return d};return!0};h.Atom.prototype=new h.Point(0,0)})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,mat4);
(function(b,e,a,h,c,d,f){a.Bond=function(q,g,o){this.a1=q;this.a2=g;this.bondOrder=o?o:1;this.stereo=a.Bond.STEREO_NONE;this.isHover=!1;this.ring=void 0;this.getCenter=function(){return new a.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};this.getLength=function(){return this.a1.distance(this.a2)};this.getLength3D=function(){return this.a1.distance3D(this.a2)};this.contains=function(a){return a===this.a1||a===this.a2};this.getNeighbor=function(a){if(a===this.a1)return this.a2;if(a===this.a2)return this.a1};
this.draw=function(d,f){if(!(this.a1.x===this.a2.x&&this.a1.y===this.a2.y)){this.specs&&(f=this.specs);var g=this.a1.x,q=this.a2.x,o=this.a1.y,k=this.a2.y,v=this.a1.distance(this.a2),x=q-g,t=k-o;if(this.a1.isLassoed&&this.a2.isLassoed){var y=d.createLinearGradient(g,o,q,k);y.addColorStop(0,"rgba(212, 99, 0, 0)");y.addColorStop(0.5,"rgba(212, 99, 0, 0.8)");y.addColorStop(1,"rgba(212, 99, 0, 0)");var w=2.5,u=this.a1.angle(this.a2)+c.PI/2,p=c.cos(u),u=c.sin(u),A=g-p*w,B=o+u*w,D=g+p*w,G=o-u*w,F=q+p*w,
C=k-u*w,p=q-p*w,u=k+u*w;d.fillStyle=y;d.beginPath();d.moveTo(A,B);d.lineTo(D,G);d.lineTo(F,C);d.lineTo(p,u);d.closePath();d.fill()}if(f.atoms_display&&!f.atoms_circles_2D&&this.a1.isLabelVisible(f)){w=p=0;for(A=this.a1.textBounds.length;w<A;w++)p=Math.max(p,h.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[w]));p+=f.bonds_atomLabelBuffer_2D;p/=v;g+=x*p;o+=t*p}if(f.atoms_display&&!f.atoms_circles_2D&&this.a2.isLabelVisible(f)){w=p=0;for(A=this.a2.textBounds.length;w<A;w++)p=Math.max(p,
h.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[w]));p+=f.bonds_atomLabelBuffer_2D;p/=v;q-=x*p;k-=t*p}f.bonds_clearOverlaps_2D&&(p=g+0.15*x,u=o+0.15*t,w=q-0.15*x,v=k-0.15*t,d.strokeStyle=f.backgroundColor,d.lineWidth=f.bonds_width_2D+2*f.bonds_overlapClearWidth_2D,d.lineCap="round",d.beginPath(),d.moveTo(p,u),d.lineTo(w,v),d.closePath(),d.stroke());d.strokeStyle=f.bonds_color;d.fillStyle=f.bonds_color;d.lineWidth=f.bonds_width_2D;d.lineCap=f.bonds_ends_2D;if(f.bonds_useJMOLColors||
f.bonds_usePYMOLColors)p=d.createLinearGradient(g,o,q,k),u=b[this.a1.label].jmolColor,w=b[this.a2.label].jmolColor,f.atoms_usePYMOLColors&&(u=b[this.a1.label].pymolColor,w=b[this.a2.label].pymolColor),p.addColorStop(0,u),f.bonds_colorGradient||(p.addColorStop(0.5,u),p.addColorStop(0.51,w)),p.addColorStop(1,w),d.strokeStyle=p,d.fillStyle=p;switch(this.bondOrder){case 0.5:d.beginPath();d.moveTo(g,o);e.contextHashTo(d,g,o,q,k,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D);d.stroke();break;case 1:if(this.stereo===
a.Bond.STEREO_PROTRUDING||this.stereo===a.Bond.STEREO_RECESSED)t=f.bonds_width_2D/2,w=this.a1.distance(this.a2)*f.bonds_wedgeThickness_2D/2,u=this.a1.angle(this.a2)+c.PI/2,p=c.cos(u),u=c.sin(u),A=g-p*t,B=o+u*t,D=g+p*t,G=o-u*t,F=q+p*w,C=k-u*w,p=q-p*w,u=k+u*w,d.beginPath(),d.moveTo(A,B),d.lineTo(D,G),d.lineTo(F,C),d.lineTo(p,u),d.closePath(),this.stereo===a.Bond.STEREO_PROTRUDING?d.fill():(d.save(),d.clip(),d.lineWidth=2*w,d.lineCap="butt",d.beginPath(),d.moveTo(g,o),e.contextHashTo(d,g,o,q,k,f.bonds_hashWidth_2D,
f.bonds_hashSpacing_2D),d.stroke(),d.restore());else if(this.stereo===a.Bond.STEREO_AMBIGUOUS){d.beginPath();d.moveTo(g,o);q=c.floor(c.sqrt(x*x+t*t)/f.bonds_wavyLength_2D);k=g;u=this.a1.angle(this.a2)+c.PI/2;p=c.cos(u);u=c.sin(u);g=x/q;t/=q;w=0;for(A=q;w<A;w++)k+=g,o+=t,q=f.bonds_wavyLength_2D*p+k-0.5*g,v=f.bonds_wavyLength_2D*-u+o-0.5*t,x=f.bonds_wavyLength_2D*-p+k-0.5*g,B=f.bonds_wavyLength_2D*u+o-0.5*t,0===w%2?d.quadraticCurveTo(q,v,k,o):d.quadraticCurveTo(x,B,k,o);d.stroke();break}else d.beginPath(),
d.moveTo(g,o),d.lineTo(q,k),d.stroke();break;case 1.5:d.beginPath();d.moveTo(g,o);d.lineTo(q,k);d.stroke();break;case 2:this.stereo===a.Bond.STEREO_AMBIGUOUS?(w=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,u=this.a1.angle(this.a2)+c.PI/2,p=c.cos(u),u=c.sin(u),A=g-p*w,B=o+u*w,D=g+p*w,G=o-u*w,F=q+p*w,C=k-u*w,p=q-p*w,u=k+u*w,d.beginPath(),d.moveTo(A,B),d.lineTo(F,C),d.moveTo(D,G),d.lineTo(p,u),d.stroke()):!f.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)?(d.beginPath(),
d.moveTo(g,o),d.lineTo(q,k),x=0,v=this.a1.distance(this.a2),p=this.a1.angle(this.a2),u=p+c.PI/2,w=v*f.bonds_saturationWidth_2D,t=f.bonds_saturationAngle_2D,t<c.PI/2&&(x=-(w/c.tan(t))),c.abs(x)<v/2&&(t=g-c.cos(p)*x,g=q+c.cos(p)*x,q=o+c.sin(p)*x,o=k-c.sin(p)*x,p=c.cos(u),u=c.sin(u),A=t-p*w,B=q+u*w,D=t+p*w,G=q-u*w,F=g-p*w,C=o+u*w,p=g+p*w,u=o-u*w,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>c.PI)||this.ring.center.angle(this.a1)-
this.ring.center.angle(this.a2)<-c.PI?(d.moveTo(A,B),d.lineTo(F,C)):(d.moveTo(D,G),d.lineTo(p,u)),d.stroke())):(w=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,u=this.a1.angle(this.a2)+c.PI/2,p=c.cos(u),u=c.sin(u),A=g-p*w,B=o+u*w,D=g+p*w,G=o-u*w,F=q+p*w,C=k-u*w,p=q-p*w,u=k+u*w,d.beginPath(),d.moveTo(A,B),d.lineTo(p,u),d.moveTo(D,G),d.lineTo(F,C),d.stroke());break;case 3:w=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D,u=this.a1.angle(this.a2)+c.PI/2,p=c.cos(u),u=c.sin(u),A=g-p*w,B=
o+u*w,D=g+p*w,G=o-u*w,F=q+p*w,C=k-u*w,p=q-p*w,u=k+u*w,d.beginPath(),d.moveTo(A,B),d.lineTo(p,u),d.moveTo(D,G),d.lineTo(F,C),d.moveTo(g,o),d.lineTo(q,k),d.stroke()}}};this.drawDecorations=function(a){if(this.isHover||this.isSelected){var d=2*c.PI,f=(this.a1.angleForStupidCanvasArcs(this.a2)+c.PI/2)%d;a.strokeStyle=this.isHover?"#885110":"#0060B2";a.lineWidth=1.2;a.beginPath();var g=(f+c.PI)%d,g=g%(2*c.PI);a.arc(this.a1.x,this.a1.y,7,f,g,!1);a.stroke();a.beginPath();f+=c.PI;g=(f+c.PI)%d;a.arc(this.a2.x,
this.a2.y,7,f,g,!1);a.stroke()}};this.render=function(a,g){this.specs&&(g=this.specs);var q=(g.bonds_renderAsLines_3D?1.1:1.001)*this.a1.distance3D(this.a2)/(g.bonds_useJMOLColors||g.bonds_usePYMOLColors?2:1);if(0===q)return!1;var q=[g.bonds_cylinderDiameter_3D/2,q,g.bonds_cylinderDiameter_3D/2],h=d.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),o,k=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];if(g.bonds_useJMOLColors||g.bonds_usePYMOLColors)f.scale(k,0.5),o=d.translate(a.modelViewMatrix,
[this.a2.x,this.a2.y,this.a2.z],[]);var v=[0],x;if(g.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:v=[-g.bonds_cylinderDiameter_3D,g.bonds_cylinderDiameter_3D];break;case 3:v=[-1.2*g.bonds_cylinderDiameter_3D,0,1.2*g.bonds_cylinderDiameter_3D]}if(1<v.length){x=[0,0,1];var t=d.inverse(a.rotationMatrix,[]);d.multiplyVec3(t,x);x=f.cross(k,x,[]);f.normalize(x)}}var y=[0,1,0],t=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(k=[0,0,1],this.a2.y<this.a1.y&&(t=c.PI)):(t=e.vec3AngleFrom(y,k),k=f.cross(y,
k,[]));for(var y=0,w=v.length;y<w;y++){var u=d.set(h,[]);0!==v[y]&&d.translate(u,f.scale(x,v[y],[]));0!==t&&d.rotate(u,t,k);d.scale(u,q);var p=g.bonds_color;g.bonds_useJMOLColors?p=b[this.a1.label].jmolColor:g.bonds_usePYMOLColors&&(p=b[this.a1.label].pymolColor);a.material.setDiffuseColor(p);a.setMatrixUniforms(u);g.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems);if(g.bonds_useJMOLColors||
g.bonds_usePYMOLColors)d.set(o,u),0!==v[y]&&d.translate(u,f.scale(x,v[y],[])),d.rotate(u,t+c.PI,k),d.scale(u,q),a.material.setDiffuseColor(g.bonds_usePYMOLColors?b[this.a2.label].pymolColor:b[this.a2.label].jmolColor),a.setMatrixUniforms(u),g.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)}};return!0};a.Bond.STEREO_NONE="none";a.Bond.STEREO_PROTRUDING="protruding";a.Bond.STEREO_RECESSED=
"recessed";a.Bond.STEREO_AMBIGUOUS="ambiguous"})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,mat4,vec3);
(function(b,e){b.Ring=function(){this.atoms=[];this.bonds=[];this.center=void 0;this.setupBonds=function(){for(var a=0,b=this.bonds.length;a<b;a++)this.bonds[a].ring=this;this.center=this.getCenter()};this.getCenter=function(){for(var a=Infinity,h=Infinity,c=-Infinity,d=-Infinity,f=0,q=this.atoms.length;f<q;f++)a=e.min(this.atoms[f].x,a),h=e.min(this.atoms[f].y,h),c=e.max(this.atoms[f].x,c),d=e.max(this.atoms[f].y,d);return new b.Point((c+a)/2,(d+h)/2)};return!0}})(ChemDoodle.structures,Math);
(function(b,e,a,h,c){a.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[];this.findRings=!0;this.draw=function(a,f){this.specs&&(f=this.specs);if(f.atoms_display&&!f.atoms_circles_2D)for(var c=0,g=this.atoms.length;c<g;c++)this.atoms[c].draw(a,f);if(f.bonds_display){c=0;for(g=this.bonds.length;c<g;c++)this.bonds[c].draw(a,f)}if(f.atoms_display&&f.atoms_circles_2D){c=0;for(g=this.atoms.length;c<g;c++)this.atoms[c].draw(a,f)}};this.render=function(d,f){this.specs&&(f=this.specs);var c=0<
this.atoms.length&&void 0!==this.atoms[0].hetatm;if(c){if(f.macro_displayBonds){0<this.bonds.length&&(f.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(d.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:f.bonds_width_2D),d.lineBuffer.bindBuffers(d)):d.cylinderBuffer.bindBuffers(d),d.material.setTempColors(f.bonds_materialAmbientColor_3D,void 0,f.bonds_materialSpecularColor_3D,f.bonds_materialShininess_3D));for(var g=0,b=this.bonds.length;g<
b;g++){var e=this.bonds[g];if(!e.a1.hetatm&&(-1===f.macro_atomToLigandDistance||void 0!==e.a1.closestDistance&&f.macro_atomToLigandDistance>=e.a1.closestDistance&&f.macro_atomToLigandDistance>=e.a2.closestDistance))e.render(d,this.residueSpecs?this.residueSpecs:f)}}if(f.macro_displayAtoms){0<this.atoms.length&&(d.sphereBuffer.bindBuffers(d),d.material.setTempColors(f.atoms_materialAmbientColor_3D,void 0,f.atoms_materialSpecularColor_3D,f.atoms_materialShininess_3D));g=0;for(b=this.atoms.length;g<
b;g++){var j=this.atoms[g];if(!j.hetatm&&(-1===f.macro_atomToLigandDistance||void 0!==j.closestDistance&&f.macro_atomToLigandDistance>=j.closestDistance))j.render(d,this.residueSpecs?this.residueSpecs:f)}}}if(f.bonds_display){0<this.bonds.length&&(f.bonds_renderAsLines_3D?(d.lineWidth(f.bonds_width_2D),d.lineBuffer.bindBuffers(d)):d.cylinderBuffer.bindBuffers(d),d.material.setTempColors(f.bonds_materialAmbientColor_3D,void 0,f.bonds_materialSpecularColor_3D,f.bonds_materialShininess_3D));g=0;for(b=
this.bonds.length;g<b;g++)e=this.bonds[g],(!c||e.a1.hetatm)&&e.render(d,f)}if(f.atoms_display){g=0;for(b=this.atoms.length;g<b;g++)j=this.atoms[g],j.bondNumber=0,j.renderAsStar=!1;g=0;for(b=this.bonds.length;g<b;g++)e=this.bonds[g],e.a1.bondNumber++,e.a2.bondNumber++;0<this.atoms.length&&(d.sphereBuffer.bindBuffers(d),d.material.setTempColors(f.atoms_materialAmbientColor_3D,void 0,f.atoms_materialSpecularColor_3D,f.atoms_materialShininess_3D));e=[];g=0;for(b=this.atoms.length;g<b;g++)if(j=this.atoms[g],
!c||j.hetatm&&(f.macro_showWater||!j.isWater))f.atoms_nonBondedAsStars_3D&&0===j.bondNumber?(j.renderAsStar=!0,e.push(j)):j.render(d,f);if(0<e.length){d.starBuffer.bindBuffers(d);g=0;for(b=e.length;g<b;g++)e[g].render(d,f)}}if(this.chains){d.setMatrixUniforms(d.modelViewMatrix);if(f.proteins_displayRibbon){d.material.setTempColors(f.proteins_materialAmbientColor_3D,void 0,f.proteins_materialSpecularColor_3D,f.proteins_materialShininess_3D);c=0;for(j=this.ribbons.length;c<j;c++)if(f.proteins_useShapelyColors||
f.proteins_useAminoColors||f.proteins_usePolarityColors){e=f.proteins_ribbonCartoonize?this.cartoons[c]:this.ribbons[c];e.front.bindBuffers(d);g=0;for(b=e.front.segments.length;g<b;g++)e.front.segments[g].render(d,f);e.back.bindBuffers(d);g=0;for(b=e.back.segments.length;g<b;g++)e.back.segments[g].render(d,f)}else if(f.proteins_ribbonCartoonize){e=this.cartoons[c];e.front.bindBuffers(d);g=0;for(b=e.front.cartoonSegments.length;g<b;g++)e.front.cartoonSegments[g].render(d,f);e.back.bindBuffers(d);g=
0;for(b=e.back.cartoonSegments.length;g<b;g++)e.back.cartoonSegments[g].render(d,f)}else e=this.ribbons[c],e.front.render(d,f),e.back.render(d,f)}if(f.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace={nodes:[],edges:[]};c=0;for(j=this.chains.length;c<j;c++){var l=this.chains[c];if(!(2<l.length&&h[l[2].name]&&"#BEA06E"===h[l[2].name].aminoColor)&&0<l.length){g=1;for(b=l.length-2;g<b;g++)e=l[g].cp1,e.chainColor=l.chainColor,this.alphaCarbonTrace.nodes.push(e),e=new a.Bond(l[g].cp1,
l[g+1].cp1),e.residueName=l[g].name,e.chainColor=l.chainColor,this.alphaCarbonTrace.edges.push(e),g===l.length-3&&(e=l[g+1].cp1,e.chainColor=l.chainColor,this.alphaCarbonTrace.nodes.push(e))}}}if(0<this.alphaCarbonTrace.nodes.length){c=new a.VisualSpecifications;c.atoms_display=!0;c.bonds_display=!0;c.atoms_sphereDiameter_3D=f.proteins_backboneThickness;c.bonds_cylinderDiameter_3D=f.proteins_backboneThickness;c.bonds_useJMOLColors=!1;c.atoms_color=f.proteins_backboneColor;c.bonds_color=f.proteins_backboneColor;
c.atoms_useVDWDiameters_3D=!1;d.material.setTempColors(f.proteins_materialAmbientColor_3D,void 0,f.proteins_materialSpecularColor_3D,f.proteins_materialShininess_3D);d.material.setDiffuseColor(f.proteins_backboneColor);g=0;for(b=this.alphaCarbonTrace.nodes.length;g<b;g++)e=this.alphaCarbonTrace.nodes[g],f.macro_colorByChain&&(c.atoms_color=e.chainColor),d.sphereBuffer.bindBuffers(d),e.render(d,c);g=0;for(b=this.alphaCarbonTrace.edges.length;g<b;g++){var j=this.alphaCarbonTrace.edges[g],n,e=h[j.residueName]?
h[j.residueName]:h["*"];f.macro_colorByChain?n=j.chainColor:f.proteins_useShapelyColors?n=e.shapelyColor:f.proteins_useAminoColors?n=e.aminoColor:f.proteins_usePolarityColors&&(n=e.polar?"#C10000":"#FFFFFF");n&&(c.bonds_color=n);d.cylinderBuffer.bindBuffers(d);j.render(d,c)}}}if(f.nucleics_display){d.material.setTempColors(f.nucleics_materialAmbientColor_3D,void 0,f.nucleics_materialSpecularColor_3D,f.nucleics_materialShininess_3D);c=0;for(j=this.tubes.length;c<j;c++)d.setMatrixUniforms(d.modelViewMatrix),
e=this.tubes[c],e.render(d,f)}}f.crystals_displayUnitCell&&this.unitCell&&(d.setMatrixUniforms(d.modelViewMatrix),this.unitCell.bindBuffers(d),d.material.setDiffuseColor(f.crystals_unitCellColor),d.lineWidth(f.crystals_unitCellLineWidth),d.drawElements(d.LINES,this.unitCell.vertexIndexBuffer.numItems,d.UNSIGNED_SHORT,0));this.surface&&f.surfaces_display&&(d.setMatrixUniforms(d.modelViewMatrix),this.surface.bindBuffers(d),d.material.setTempColors(f.surfaces_materialAmbientColor_3D,f.surfaces_color,
f.surfaces_materialSpecularColor_3D,f.surfaces_materialShininess_3D),"Dot"===f.surfaces_style?d.drawArrays(d.POINTS,0,this.surface.vertexPositionBuffer.numItems):d.drawElements(d.TRIANGLES,this.surface.vertexIndexBuffer.numItems,d.UNSIGNED_SHORT,0))};this.getCenter3D=function(){if(1===this.atoms.length)return new a.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var d=Infinity,f=Infinity,b=Infinity,g=-Infinity,e=-Infinity,h=-Infinity;if(this.chains)for(var j=0,l=this.chains.length;j<l;j++)for(var n=
this.chains[j],r=0,k=n.length;r<k;r++)var v=n[r],d=c.min(v.cp1.x,d),f=c.min(v.cp1.y,f),b=c.min(v.cp1.z,b),g=c.max(v.cp1.x,g),e=c.max(v.cp1.y,e),h=c.max(v.cp1.z,h),d=c.min(v.cp2.x,d),f=c.min(v.cp2.y,f),b=c.min(v.cp2.z,b),g=c.max(v.cp2.x,g),e=c.max(v.cp2.y,e),h=c.max(v.cp2.z,h);j=0;for(l=this.atoms.length;j<l;j++)d=c.min(this.atoms[j].x,d),f=c.min(this.atoms[j].y,f),b=c.min(this.atoms[j].z,b),g=c.max(this.atoms[j].x,g),e=c.max(this.atoms[j].y,e),h=c.max(this.atoms[j].z,h);return new a.Atom("C",(g+d)/
2,(e+f)/2,(h+b)/2)};this.getCenter=function(){if(1===this.atoms.length)return new a.Point(this.atoms[0].x,this.atoms[0].y);for(var d=Infinity,f=Infinity,b=-Infinity,g=-Infinity,e=0,h=this.atoms.length;e<h;e++)d=c.min(this.atoms[e].x,d),f=c.min(this.atoms[e].y,f),b=c.max(this.atoms[e].x,b),g=c.max(this.atoms[e].y,g);return new a.Point((b+d)/2,(g+f)/2)};this.getDimension=function(){if(1===this.atoms.length)return new a.Point(0,0);var d=Infinity,f=Infinity,b=-Infinity,g=-Infinity;if(this.chains){for(var e=
0,h=this.chains.length;e<h;e++)for(var j=this.chains[e],l=0,n=j.length;l<n;l++)var r=j[l],d=c.min(r.cp1.x,d),f=c.min(r.cp1.y,f),b=c.max(r.cp1.x,b),g=c.max(r.cp1.y,g),d=c.min(r.cp2.x,d),f=c.min(r.cp2.y,f),b=c.max(r.cp2.x,b),g=c.max(r.cp2.y,g);d-=30;f-=30;b+=30;g+=30}e=0;for(h=this.atoms.length;e<h;e++)d=c.min(this.atoms[e].x,d),f=c.min(this.atoms[e].y,f),b=c.max(this.atoms[e].x,b),g=c.max(this.atoms[e].y,g);return new a.Point(b-d,g-f)};this.check=function(a){if(a&&this.doChecks){if(this.findRings)if(this.bonds.length-
this.atoms.length!==this.fjNumCache){this.rings=(new b.informatics.SSSRFinder(this)).rings;for(var f=0,c=this.bonds.length;f<c;f++)this.bonds[f].ring=void 0;f=0;for(c=this.rings.length;f<c;f++)this.rings[f].setupBonds()}else{f=0;for(c=this.rings.length;f<c;f++){var g=this.rings[f];g.center=g.getCenter()}}if(this.atoms.length!==this.atomNumCache&&this.bonds.length!==this.bondNumCache){f=0;for(c=this.atoms.length;f<c;f++)if(this.atoms[f].isLone=!1,"C"===this.atoms[f].label){for(var e=g=0,h=this.bonds.length;e<
h;e++)(this.bonds[e].a1===this.atoms[f]||this.bonds[e].a2===this.atoms[f])&&g++;0===g&&(this.atoms[f].isLone=!0)}}g=!1;f=0;for(c=this.atoms.length;f<c;f++)0!==this.atoms[f].z&&(g=!0);g&&(this.sortAtomsByZ(),this.sortBondsByZ());this.setupMetaData();this.atomNumCache=this.atoms.length;this.bondNumCache=this.bonds.length;this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!a};this.getAngles=function(a){for(var f=[],c=0,g=this.bonds.length;c<g;c++)this.bonds[c].contains(a)&&f.push(a.angle(this.bonds[c].getNeighbor(a)));
f.sort();return f};this.getCoordinationNumber=function(a){for(var f=0,c=0,g=a.length;c<g;c++)f+=a[c].bondOrder;return f};this.getBonds=function(a){for(var f=[],c=0,g=this.bonds.length;c<g;c++)this.bonds[c].contains(a)&&f.push(this.bonds[c]);return f};this.sortAtomsByZ=function(){for(var a=1,f=this.atoms.length;a<f;a++)for(var c=a;0<c&&this.atoms[c].z<this.atoms[c-1].z;){var g=this.atoms[c];this.atoms[c]=this.atoms[c-1];this.atoms[c-1]=g;c--}};this.sortBondsByZ=function(){for(var a=1,c=this.bonds.length;a<
c;a++)for(var b=a;0<b&&this.bonds[b].a1.z+this.bonds[b].a2.z<this.bonds[b-1].a1.z+this.bonds[b-1].a2.z;){var g=this.bonds[b];this.bonds[b]=this.bonds[b-1];this.bonds[b-1]=g;b--}};this.setupMetaData=function(){for(var a=this.getCenter(),f=0,e=this.atoms.length;f<e;f++){var g=this.atoms[f],h=this.getBonds(g),m=this.getAngles(g);g.isHidden=2===h.length&&c.abs(c.abs(m[1]-m[0])-c.PI)<c.PI/30&&h[0].bondOrder===h[1].bondOrder;m=b.math.angleBetweenLargest(m);g.angleOfLeastInterference=m.angle%(2*c.PI);g.largestAngle=
m.largest;g.coordinationNumber=this.getCoordinationNumber(h);g.bondNumber=h.length;g.molCenter=a}f=0;for(e=this.bonds.length;f<e;f++)this.bonds[f].molCenter=a};this.scaleToAverageBondLength=function(a){var c=this.getAverageBondLength();if(0!==c)for(var a=a/c,c=0,b=this.atoms.length;c<b;c++)this.atoms[c].x*=a,this.atoms[c].y*=a};this.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var a=0,c=0,b=this.bonds.length;c<b;c++)a+=this.bonds[c].getLength();return a/=this.bonds.length};
this.getBounds=function(){for(var a=new e.Bounds,c=0,b=this.atoms.length;c<b;c++)a.expand(this.atoms[c].getBounds());if(this.chains){c=0;for(b=this.chains.length;c<b;c++)for(var g=this.chains[c],h=0,m=g.length;h<m;h++){var j=g[h];a.expand(j.cp1.x,j.cp1.y);a.expand(j.cp2.x,j.cp2.y)}a.minX-=30;a.minY-=30;a.maxX+=30;a.maxY+=30}return a};return!0}})(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math);
(function(b,e,a,h){var c,d=-1;b.Residue=function(f){this.resSeq=f;this.setup=function(a,d){this.horizontalResolution=d;var c=[a.x-this.cp1.x,a.y-this.cp1.y,a.z-this.cp1.z],f=h.cross(c,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=h.cross(f,c,[]);h.normalize(f);h.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];c=[(a.x+this.cp1.x)/2,(a.y+this.cp1.y)/2,(a.z+this.cp1.z)/2];this.helix&&(h.scale(f,1.5),h.add(c,f));this.guidePointsSmall[0]=new b.Atom("",
c[0]-this.D[0]/2,c[1]-this.D[1]/2,c[2]-this.D[2]/2);for(f=1;f<d;f++)this.guidePointsSmall[f]=new b.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/d,this.guidePointsSmall[0].y+this.D[1]*f/d,this.guidePointsSmall[0].z+this.D[2]*f/d);h.scale(this.D,4);this.guidePointsLarge[0]=new b.Atom("",c[0]-this.D[0]/2,c[1]-this.D[1]/2,c[2]-this.D[2]/2);for(f=1;f<d;f++)this.guidePointsLarge[f]=new b.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/d,this.guidePointsLarge[0].y+this.D[1]*f/d,this.guidePointsLarge[0].z+
this.D[2]*f/d)};this.getGuidePointSet=function(a){if(0===a)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(1===a)return this.guidePointsSmall;if(2===a)return this.guidePointsLarge};this.computeLineSegments=function(f,g,b,e,h){if(h!==d){var l=h*h,n=h*h*h;c=a.multiply([-1/6,0.5,-0.5,1/6,0.5,-1,0.5,0,-0.5,0,0.5,0,1/6,2/3,1/6,0],[6/n,0,0,0,6/n,2/l,0,0,1/n,1/l,1/h,0,0,0,0,1],[]);d=h}this.split=g.helix!==this.helix||g.sheet!==this.sheet;this.lineSegments=this.innerCompute(0,
f,g,b,!1,h);e&&(this.lineSegmentsCartoon=this.innerCompute(g.helix||g.sheet?2:1,f,g,b,!0,h))};this.innerCompute=function(d,f,o,m,j,l){for(var n=[],r=this.getGuidePointSet(d),f=f.getGuidePointSet(d),o=o.getGuidePointSet(d),k=m.getGuidePointSet(d),v=0,x=this.guidePointsLarge.length;v<x;v++){for(var t=a.multiply([f[v].x,f[v].y,f[v].z,1,r[v].x,r[v].y,r[v].z,1,o[v].x,o[v].y,o[v].z,1,k[v].x,k[v].y,k[v].z,1],c,[]),y=[],w=0;w<l;w++){for(d=3;0<d;d--)for(m=0;4>m;m++)t[4*d+m]+=t[4*(d-1)+m];y[w]=new b.Atom("",
t[12]/t[15],t[13]/t[15],t[14]/t[15])}n[v]=y}if(j&&this.arrow)for(d=0;d<l;d++){j=1.5-1.3*d/l;r=e.floor(this.horizontalResolution/2);f=n[r];m=0;for(o=n.length;m<o;m++)m!==r&&(k=f[d],v=n[m][d],x=[v.x-k.x,v.y-k.y,v.z-k.z],h.scale(x,j),v.x=k.x+x[0],v.y=k.y+x[1],v.z=k.z+x[2])}return n}}})(ChemDoodle.structures,Math,mat4,vec3);
(function(b,e,a,h,c){e.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.yUnit=this.xUnit=this.title=void 0;this.continuous=!0;this.integrationSensitivity=0.01;this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0};this.draw=function(a,f,e,g){this.specs&&(f=this.specs);var o=5,m=0,j=0;a.fillStyle=f.text_color;a.textAlign="center";a.textBaseline="alphabetic";a.font=f.getFontString(f.text_font_size,f.text_font_families);this.xUnit&&(j+=f.text_font_size,
a.fillText(this.xUnit,e/2,g-2));this.yUnit&&f.plots_showYAxis&&(m+=f.text_font_size,a.save(),a.translate(f.text_font_size,g/2),a.rotate(-c.PI/2),a.fillText(this.yUnit,0,0),a.restore());this.title&&(o+=f.text_font_size,a.fillText(this.title,e/2,f.text_font_size));j+=5+f.text_font_size;f.plots_showYAxis&&(m+=5+a.measureText("1000").width);f.plots_showGrid&&(a.strokeStyle=f.plots_gridColor,a.lineWidth=f.plots_gridLineWidth,a.strokeRect(m,o,e-m,g-j-o));a.textAlign="center";a.textBaseline="top";for(var l=
this.maxX-this.minX,n=l/100,r=0.001;r<n||25<l/r;)r*=10;for(var k=0,v=f.plots_flipXAxis?e:0,l=c.round(this.minX/r)*r;l<=this.maxX;l+=r/2){var x=this.getTransformedX(l,f,e,m);if(x>m)if(a.strokeStyle="black",a.lineWidth=1,0===k%2){a.beginPath();a.moveTo(x,g-j);a.lineTo(x,g-j+2);a.stroke();for(n=l.toFixed(5);"0"===n.charAt(n.length-1);)n=n.substring(0,n.length-1);"."===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1));var t=a.measureText(n).width;f.plots_flipXAxis&&(t*=-1);var y=x-t/2;if(f.plots_flipXAxis?
y<v:y>v)a.fillText(n,x,g-j+2),v=x+t/2;f.plots_showGrid&&(a.strokeStyle=f.plots_gridColor,a.lineWidth=f.plots_gridLineWidth,a.beginPath(),a.moveTo(x,g-j),a.lineTo(x,o),a.stroke())}else a.beginPath(),a.moveTo(x,g-j),a.lineTo(x,g-j+2),a.stroke();k++}if(f.plots_showYAxis||f.plots_showGrid){r=1/f.scale;a.textAlign="right";a.textBaseline="middle";for(l=0;10>=l;l++)if(n=r/10*l,k=o+(g-j-o)*(1-n*f.scale),f.plots_showGrid&&(a.strokeStyle=f.plots_gridColor,a.lineWidth=f.plots_gridLineWidth,a.beginPath(),a.moveTo(m,
k),a.lineTo(e,k),a.stroke()),f.plots_showYAxis){a.strokeStyle="black";a.lineWidth=1;a.beginPath();a.moveTo(m,k);a.lineTo(m-3,k);a.stroke();n*=100;v=c.max(0,3-c.floor(n).toString().length);n=n.toFixed(v);if(0<v)for(;"0"===n.charAt(n.length-1);)n=n.substring(0,n.length-1);"."===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1));a.fillText(n,m-3,k)}}a.strokeStyle="black";a.lineWidth=1;a.beginPath();a.moveTo(e,g-j);a.lineTo(m,g-j);f.plots_showYAxis&&a.lineTo(m,o);a.stroke();if(0<this.dataDisplay.length){a.textAlign=
"left";a.textBaseline="top";l=n=0;for(r=this.dataDisplay.length;l<r;l++)if(this.dataDisplay[l].value)a.fillText([this.dataDisplay[l].display,": ",this.dataDisplay[l].value].join(""),m+10,o+10+n*(f.text_font_size+5)),n++;else if(this.dataDisplay[l].tag){k=0;for(v=this.metadata.length;k<v;k++)if(b.stringStartsWith(this.metadata[k],this.dataDisplay[l].tag)){v=this.metadata[k];this.dataDisplay[l].display&&(v=h.inArray("=",this.metadata[k]),v=[this.dataDisplay[l].display,": ",-1<v?this.metadata[k].substring(v+
2):this.metadata[k]].join(""));a.fillText(v,m+10,o+10+n*(f.text_font_size+5));n++;break}}}this.drawPlot(a,f,e,g,o,m,j);this.memory.offsetTop=o;this.memory.offsetLeft=m;this.memory.offsetBottom=j;this.memory.flipXAxis=f.plots_flipXAxis;this.memory.scale=f.scale;this.memory.width=e;this.memory.height=g};this.drawPlot=function(a,f,b,g,h,m,j){this.specs&&(f=this.specs);a.strokeStyle=f.plots_color;a.lineWidth=f.plots_width;var l=[];a.beginPath();if(this.continuous)for(var n=!1,r=0,k=0,v=this.data.length;k<
v;k++){var x=this.getTransformedX(this.data[k].x,f,b,m);if(x>=m&&x<b){var t=this.getTransformedY(this.data[k].y,f,g,j,h);f.plots_showIntegration&&c.abs(this.data[k].y)>this.integrationSensitivity&&l.push(new e.Point(this.data[k].x,this.data[k].y));n||(a.moveTo(x,t),n=!0);a.lineTo(x,t);r++;0===r%1E3&&(a.stroke(),a.beginPath(),a.moveTo(x,t))}else if(n)break}else{k=0;for(v=this.data.length;k<v;k++)x=this.getTransformedX(this.data[k].x,f,b,m),x>=m&&x<b&&(a.moveTo(x,g-j),a.lineTo(x,this.getTransformedY(this.data[k].y,
f,g,j,h)))}a.stroke();if(f.plots_showIntegration&&1<l.length){a.strokeStyle=f.plots_integrationColor;a.lineWidth=f.plots_integrationLineWidth;a.beginPath();k=l[1].x>l[0].x;if(this.flipXAxis&&!k||!this.flipXAxis&&k){for(k=l.length-2;0<=k;k--)l[k].y+=l[k+1].y;n=l[0].y}else{k=1;for(v=l.length;k<v;k++)l[k].y+=l[k-1].y;n=l[l.length-1].y}k=0;for(v=l.length;k<v;k++)x=this.getTransformedX(l[k].x,f,b,m),t=this.getTransformedY(l[k].y/f.scale/n,f,g,j,h),0===k?a.moveTo(x,t):a.lineTo(x,t);a.stroke()}};this.getTransformedY=
function(a,c,b,g,e){return e+(b-g-e)*(1-a*c.scale)};this.getInverseTransformedY=function(a){return 100*((1-(a-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale)};this.getTransformedX=function(a,c,b,g){a=g+(a-this.minX)/(this.maxX-this.minX)*(b-g);c.plots_flipXAxis&&(a=b+g-a);return a};this.getInverseTransformedX=function(a){this.memory.flipXAxis&&(a=this.memory.width+this.memory.offsetLeft-a);return(a-this.memory.offsetLeft)*(this.maxX-this.minX)/
(this.memory.width-this.memory.offsetLeft)+this.minX};this.setup=function(){for(var a=Number.MAX_VALUE,f=Number.MIN_VALUE,b=Number.MIN_VALUE,g=0,e=this.data.length;g<e;g++)a=c.min(a,this.data[g].x),f=c.max(f,this.data[g].x),b=c.max(b,this.data[g].y);this.continuous?(this.minX=a,this.maxX=f):(this.minX=a-1,this.maxX=f+1);g=0;for(e=this.data.length;g<e;g++)this.data[g].y/=b};this.zoom=function(d,f,b,g){d=this.getInverseTransformedX(d);f=this.getInverseTransformedX(f);this.minX=c.min(d,f);this.maxX=
c.max(d,f);if(g){g=Number.MIN_VALUE;f=0;for(d=this.data.length;f<d;f++)a.isBetween(this.data[f].x,this.minX,this.maxX)&&(g=c.max(g,this.data[f].y));return 1/g}};this.translate=function(a,c){var b=a/(c-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=b;this.maxX+=b};this.alertMetadata=function(){alert(this.metadata.join("\n"))};this.getInternalCoordinates=function(a,c){return new ChemDoodle.structures.Point(this.getInverseTransformedX(a),this.getInverseTransformedY(c))};
this.getClosestPlotInternalCoordinates=function(c){var f=this.getInverseTransformedX(c-1),c=this.getInverseTransformedX(c+1);if(f>c)var b=f,f=c,c=b;for(var b=-1,g=-Infinity,e=!1,h=0,j=this.data.length;h<j;h++){var l=this.data[h];if(a.isBetween(l.x,f,c))l.y>g&&(e=!0,g=l.y,b=h);else if(e)break}if(-1!==b)return l=this.data[b],new ChemDoodle.structures.Point(l.x,100*l.y)};this.getClosestPeakInternalCoordinates=function(a){for(var f=this.getInverseTransformedX(a),a=0,b=Infinity,g=0,e=this.data.length;g<
e;g++){var h=c.abs(this.data[g].x-f);if(h<=b)b=h,a=g;else break}f=highestRight=a;b=maxRight=this.data[a].y;g=a+1;for(e=this.data.length;g<e;g++)if(this.data[g].y+0.05>maxRight)maxRight=this.data[g].y,highestRight=g;else break;for(g=a-1;0<=g;g--)if(this.data[g].y+0.05>b)b=this.data[g].y,f=g;else break;a=this.data[f-a>highestRight-a?highestRight:f];return new ChemDoodle.structures.Point(a.x,100*a.y)};return!0}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math);
(function(b,e,a){e._Shape=function(){return!0};e._Shape.prototype.drawDecorations=function(a,c){if(this.isHover)for(var b=this.getPoints(),f=0,e=b.length;f<e;f++){var g=b[f];this.drawAnchor(a,c,g,g===this.hoverPoint)}};e._Shape.prototype.getBounds=function(){for(var a=new b.Bounds,c=this.getPoints(),d=0,f=c.length;d<f;d++){var e=c[d];a.expand(e.x,e.y)}return a};e._Shape.prototype.drawAnchor=function(b,c,d,f){b.save();b.translate(d.x,d.y);b.rotate(a.PI/4);b.scale(1/c.scale,1/c.scale);b.beginPath();
b.moveTo(-4,-4);b.lineTo(4,-4);b.lineTo(4,4);b.lineTo(-4,4);b.closePath();b.fillStyle=f?"#885110":"white";b.fill();b.beginPath();b.moveTo(-4,-2);b.lineTo(-4,-4);b.lineTo(-2,-4);b.moveTo(2,-4);b.lineTo(4,-4);b.lineTo(4,-2);b.moveTo(4,2);b.lineTo(4,4);b.lineTo(2,4);b.moveTo(-2,4);b.lineTo(-4,4);b.lineTo(-4,2);b.moveTo(-4,-2);b.strokeStyle="rgba(0,0,0,.2)";b.lineWidth=5;b.stroke();b.strokeStyle="blue";b.lineWidth=1;b.stroke();b.restore()}})(ChemDoodle.math,ChemDoodle.structures.d2,Math);
(function(b,e,a,h){a.Line=function(c,d){this.p1=c?c:new e.Point;this.p2=d?d:new e.Point;this.arrowType=void 0;this.draw=function(c,b){if(this.isLassoed){var g=c.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);g.addColorStop(0,"rgba(212, 99, 0, 0)");g.addColorStop(0.5,"rgba(212, 99, 0, 0.8)");g.addColorStop(1,"rgba(212, 99, 0, 0)");var d=2.5,e=this.p1.angle(this.p2)+h.PI/2,j=h.cos(e),e=h.sin(e),l=this.p1.x-j*d,n=this.p1.y+e*d,r=this.p1.x+j*d,k=this.p1.y-e*d,v=this.p2.x+j*d,x=this.p2.y-
e*d,t=this.p2.x-j*d,y=this.p2.y+e*d;c.fillStyle=g;c.beginPath();c.moveTo(l,n);c.lineTo(r,k);c.lineTo(v,x);c.lineTo(t,y);c.closePath();c.fill()}c.strokeStyle=b.shapes_color;c.fillStyle=b.shapes_color;c.lineWidth=b.shapes_lineWidth_2D;c.lineJoin="miter";if(this.arrowType===a.Line.ARROW_RETROSYNTHETIC){var g=2*h.sqrt(2),d=b.shapes_arrowLength_2D/g,j=this.p1.angle(this.p2),e=j+h.PI/2,g=b.shapes_arrowLength_2D/g,w=h.cos(j),u=h.sin(j),j=h.cos(e),e=h.sin(e),l=this.p1.x-j*d,n=this.p1.y+e*d,r=this.p1.x+j*
d,k=this.p1.y-e*d,v=this.p2.x+j*d-w*g,x=this.p2.y-e*d+u*g,t=this.p2.x-j*d-w*g,y=this.p2.y+e*d+u*g,p=this.p2.x+2*j*d-2*w*g,A=this.p2.y-2*e*d+2*u*g,j=this.p2.x-2*j*d-2*w*g,d=this.p2.y+2*e*d+2*u*g;c.beginPath();c.moveTo(r,k);c.lineTo(v,x);c.moveTo(p,A);c.lineTo(this.p2.x,this.p2.y);c.lineTo(j,d);c.moveTo(t,y);c.lineTo(l,n);c.stroke()}else if(this.p1.x!==this.p2.x||this.p1.y!==this.p2.y)this.arrowType===a.Line.ARROW_SYNTHETIC?(j=this.p1.angle(this.p2),e=j+h.PI/2,g=2*b.shapes_arrowLength_2D/h.sqrt(3),
w=h.cos(j),u=h.sin(j),j=h.cos(e),e=h.sin(e),c.beginPath(),c.moveTo(this.p1.x,this.p1.y),c.lineTo(this.p2.x-w*g/2,this.p2.y+u*g/2),c.stroke(),l=this.p2.x-0.8*w*g,n=this.p2.y+0.8*u*g,p=this.p2.x+j*b.shapes_arrowLength_2D/3-w*g,A=this.p2.y-e*b.shapes_arrowLength_2D/3+u*g,j=this.p2.x-j*b.shapes_arrowLength_2D/3-w*g,d=this.p2.y+e*b.shapes_arrowLength_2D/3+u*g,c.beginPath(),c.moveTo(this.p2.x,this.p2.y),c.lineTo(j,d),c.lineTo(l,n),c.lineTo(p,A),c.closePath(),c.fill()):(c.beginPath(),c.moveTo(this.p1.x,
this.p1.y),c.lineTo(this.p2.x,this.p2.y)),c.stroke()};this.getPoints=function(){return[this.p1,this.p2]};this.isOver=function(a,c){var g=b.distanceFromPointToLineInclusive(a,this.p1,this.p2);return-1!==g&&g<c};return!0};a.Line.prototype=new a._Shape;a.Line.ARROW_SYNTHETIC="synthetic";a.Line.ARROW_RETROSYNTHETIC="retrosynthetic"})(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(b,e,a,h){a.Pusher=function(a,b,f){this.o1=a;this.o2=b;this.numElectron=f?f:1;this.draw=function(a,c){if(this.o1&&this.o2){a.strokeStyle=c.shapes_color;a.fillStyle=c.shapes_color;a.lineWidth=c.shapes_lineWidth_2D;a.lineJoin="miter";var b=this.o1 instanceof e.Atom?new e.Point(this.o1.x,this.o1.y):this.o1.getCenter(),d=this.o2 instanceof e.Atom?new e.Point(this.o2.x,this.o2.y):this.o2.getCenter(),f=h.max(50,b.distance(d)),l;if(this.o1.molCenter)if(this.o1 instanceof e.Atom){var n=this.o1.molCenter.angle(b);
l=new e.Point(b.x+f*h.cos(n),b.y-f*h.sin(n))}else{var n=this.o1.a1.angle(this.o1.a2),r=n+h.PI/2,n=r+h.PI,r=new e.Point(b.x+f*h.cos(r),b.y-f*h.sin(r)),n=new e.Point(b.x+f*h.cos(n),b.y-f*h.sin(n));l=r.distance(this.o1.molCenter)>n.distance(this.o1.molCenter)?r:n}else l=b;this.o2.molCenter?this.o2 instanceof e.Atom?(n=this.o2.molCenter.angle(d),n=new e.Point(d.x+f*h.cos(n),d.y-f*h.sin(n))):(n=this.o2.a1.angle(this.o2.a2),r=n+h.PI/2,n=r+h.PI,r=new e.Point(d.x+f*h.cos(r),d.y-f*h.sin(r)),n=new e.Point(d.x+
f*h.cos(n),d.y-f*h.sin(n)),n=r.distance(this.o2.molCenter)>n.distance(this.o2.molCenter)?r:n):n=d;for(var r=l.angle(b),k=n.angle(d),v=h.max(r,k)-h.min(r,k);v+0.001>=h.PI;)v-=h.PI;0.001>v&&(r+=h.PI/6,k+=h.PI/6,l.x=b.x+f*h.cos(r+h.PI),l.y=b.y-f*h.sin(r+h.PI),n.x=d.x+f*h.cos(k+h.PI),n.y=d.y-f*h.sin(k+h.PI));v=r+h.PI/2;f=h.cos(r);r=h.sin(r);if(c.pusher_showElectron_2D){var x=5;if(this.o1 instanceof e.Atom&&this.o1.isLabelVisible(c)||1<this.o1.bondOrder)x=8;b.x-=f*x;b.y+=r*x;2===this.numElectron?(x=Math.cos(v)*
c.atoms_lonePairSpread_2D/2,v=-Math.sin(v)*c.atoms_lonePairSpread_2D/2,a.beginPath(),a.arc(b.x+x,b.y+v,c.atoms_lonePairDiameter_2D,0,2*h.PI,!1),a.fill(),a.beginPath(),a.arc(b.x-x,b.y-v,c.atoms_lonePairDiameter_2D,0,2*h.PI,!1)):(a.beginPath(),a.arc(b.x,b.y,c.atoms_lonePairDiameter_2D,0,2*h.PI,!1));a.fill()}b.x-=5*f;b.y+=5*r;var v=k+h.PI/2,t=2*c.shapes_arrowLength_2D/h.sqrt(3),f=h.cos(k),r=h.sin(k),y=h.cos(v),w=h.sin(v);d.x-=5*f;d.y+=5*r;k=new e.Point(d.x,d.y);d.x-=0.8*f*t;d.y+=0.8*r*t;var v=k.x-0.8*
f*t,x=k.y+0.8*r*t,u=new e.Point(k.x+y*c.shapes_arrowLength_2D/3-f*t,k.y-w*c.shapes_arrowLength_2D/3+r*t),f=new e.Point(k.x-y*c.shapes_arrowLength_2D/3-f*t,k.y+w*c.shapes_arrowLength_2D/3+r*t),t=r=!0;1===this.numElectron&&(u.distance(l)>f.distance(l)?t=!1:r=!1);a.beginPath();a.moveTo(k.x,k.y);t&&a.lineTo(f.x,f.y);a.lineTo(v,x);r&&a.lineTo(u.x,u.y);a.closePath();a.fill();a.stroke();a.beginPath();a.moveTo(b.x,b.y);a.bezierCurveTo(l.x,l.y,n.x,n.y,d.x,d.y);a.stroke()}};this.getPoints=function(){return[]};
this.isOver=function(){return!1};return!0};a.Pusher.prototype=new a._Shape})(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(b){b._Mesh=function(){return!0};b._Mesh.prototype.storeData=function(b,a,h){this.positionData=b;this.normalData=a;this.indexData=h};b._Mesh.prototype.setupBuffers=function(b){this.vertexPositionBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(this.positionData),b.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=b.createBuffer();
b.bindBuffer(b.ARRAY_BUFFER,this.vertexNormalBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(this.normalData),b.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;this.indexData&&(this.vertexIndexBuffer=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),b.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);
if(this.partitions)for(var a=0,h=this.partitions.length;a<h;a++){var c=this.partitions[a],d=this.generateBuffers(b,c.positionData,c.normalData,c.indexData);c.vertexPositionBuffer=d[0];c.vertexNormalBuffer=d[1];c.vertexIndexBuffer=d[2]}};b._Mesh.prototype.generateBuffers=function(b,a,h,c){var d=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,d);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);d.itemSize=3;d.numItems=a.length/3;a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,
new Float32Array(h),b.STATIC_DRAW);a.itemSize=3;a.numItems=h.length/3;var f;c&&(f=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,f),b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),b.STATIC_DRAW),f.itemSize=1,f.numItems=c.length);return[d,a,f]};b._Mesh.prototype.bindBuffers=function(b){this.vertexPositionBuffer||this.setupBuffers(b);b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,b.FLOAT,!1,
0,0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,b.FLOAT,!1,0,0);this.vertexIndexBuffer&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures.d3,Math);
(function(b,e){b.Cylinder=function(a,b,c){for(var d=[],f=[],q=0;q<c;q++){var g=2*q*e.PI/c,o=e.cos(g),g=e.sin(g);f.push(o,0,g);d.push(a*o,0,a*g);f.push(o,0,g);d.push(a*o,b,a*g)}f.push(1,0,0);d.push(a,0,0);f.push(1,0,0);d.push(a,b,0);this.storeData(d,f);return!0};b.Cylinder.prototype=new b._Mesh})(ChemDoodle.structures.d3,Math);
(function(b,e){b.Sphere=function(a,b,c){for(var d=[],f=[],q=0;q<=b;q++)for(var g=q*e.PI/b,o=e.sin(g),m=e.cos(g),g=0;g<=c;g++){var j=2*g*e.PI/c,l=e.sin(j),j=e.cos(j)*o,n=m,l=l*o;f.push(j,n,l);d.push(a*j,a*n,a*l)}a=[];c+=1;for(q=0;q<b;q++)for(g=0;g<c;g++)o=q*c+g%c,m=o+c,a.push(o),a.push(m),a.push(o+1),g<c-1&&(a.push(m),a.push(m+1),a.push(o+1));this.storeData(d,f,a);return!0};b.Sphere.prototype=new b._Mesh})(ChemDoodle.structures.d3,Math);
(function(b,e,a,h){function c(a,c,g,e){this.name=c;this.entire=a;this.pi=e;this.getColor=function(c){return c.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(b[this.name]?this.name:"*",c):this.helix?a.front?c.proteins_ribbonCartoonHelixPrimaryColor:c.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?c.proteins_ribbonCartoonSheetColor:a.front?c.proteins_primaryColor:c.proteins_secondaryColor};this.getResidueColor=function(a,c){var d=b[a];return c.proteins_useShapelyColors?d.shapelyColor:
c.proteins_useAminoColors?d.aminoColor:c.proteins_usePolarityColors&&d.polar?"#C10000":"#FFFFFF"};this.render=function(a,c){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(d(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi);this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(g),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=
1,this.vertexIndexBuffer.numItems=g.length);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);a.material.setDiffuseColor(this.getColor(c));a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}var d=function(a,c){a.bindBuffer(a.ARRAY_BUFFER,c.vertexPositionBuffer);a.vertexAttribPointer(a.shader.vertexPositionAttribute,c.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,c.vertexNormalBuffer);a.vertexAttribPointer(a.shader.vertexNormalAttribute,
c.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c.vertexIndexBuffer)};e.Ribbon=function(b,e,g){var o=b[0].lineSegments.length,m=b[0].lineSegments[0].length;this.partitions=[];this.partitions.lastRender=0;var j;this.front=0<e;for(var l=0,n=b.length-1;l<n;l++){if(!j||65E3<j.positionData.length)0<this.partitions.length&&l--,j={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(j);var r=b[l];j.count++;for(var k=0;k<o;k++)for(var v=g?r.lineSegmentsCartoon[k]:
r.lineSegments[k],x=0===k,t=!1,y=0;y<m;y++){var w=v[y],u=l,p=y+1;l===b.length-2&&y===m-1?p--:y===m-1&&(u++,p=0);var p=g?b[u].lineSegmentsCartoon[k][p]:b[u].lineSegments[k][p],u=!1,A=k+1;k===o-1&&(A-=2,u=!0);var A=g?r.lineSegmentsCartoon[A][y]:r.lineSegments[A][y],p=[p.x-w.x,p.y-w.y,p.z-w.z],A=[A.x-w.x,A.y-w.y,A.z-w.z],B=h.cross(p,A,[]);0===y&&(h.normalize(p),h.scale(p,-1),j.normalData.push(p[0],p[1],p[2]),j.positionData.push(w.x,w.y,w.z));x||t?(h.normalize(A),h.scale(A,-1),j.normalData.push(A[0],
A[1],A[2]),j.positionData.push(w.x,w.y,w.z),x&&y===m-1&&(x=!1,y=-1)):(h.normalize(B),(u&&!this.front||!u&&this.front)&&h.scale(B,-1),j.normalData.push(B[0],B[1],B[2]),h.scale(B,a.abs(e)),j.positionData.push(w.x+B[0],w.y+B[1],w.z+B[2]),k===o-1&&y===m-1&&(t=!0,y=-1));if(-1===y||y===m-1)h.normalize(p),j.normalData.push(p[0],p[1],p[2]),j.positionData.push(w.x,w.y,w.z)}}o+=2;m+=2;g&&(this.cartoonSegments=[]);this.segments=[];e=0;for(r=this.partitions.length;e<r;e++){j=this.partitions[e];var D;g&&(D=[]);
l=0;for(n=j.count-1;l<n;l++){v=l;for(k=0;k<e;k++)v+=this.partitions[k].count-1;k=b[v];0<l&&g&&k.split&&(y=new c(this,void 0,D,e),k.helix&&(y.helix=!0),k.sheet&&(y.sheet=!0),this.cartoonSegments.push(y),D=[]);x=l*o*m;t=[];k=0;for(w=o-1;k<w;k++){u=x+k*m;for(y=0;y<m;y++){p=1;l===j.count-1?p=0:y===m-1&&(p=o*m-y);p=[u+y,u+m+y,u+m+y+p,u+y,u+y+p,u+m+y+p];if(y!==m-1)for(A=0;6>A;A++)t.push(p[A]);y===m-2&&l<j.count-1&&(A=o*m-y,p[2]+=A,p[4]+=A,p[5]+=A);for(A=0;6>A;A++)j.indexData.push(p[A]);if(g)for(A=0;6>A;A++)D.push(p[A])}}this.segments.push(new c(this,
b[v+1].name,t,e))}if(g){y=new c(this,void 0,D,e);v=j.count-1;for(k=0;k<e;k++)v+=this.partitions[k].count-1;k=b[v];k.helix&&(y.helix=!0);k.sheet&&(y.sheet=!0);this.cartoonSegments.push(y)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);1===this.partitions.length&&(this.partitions=void 0);this.render=function(a,c){this.bindBuffers(a);var b=c.macro_colorByChain?this.chainColor:void 0;b||(b=this.front?c.proteins_primaryColor:c.proteins_secondaryColor);
a.material.setDiffuseColor(b);a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0);if(this.partitions)for(var b=1,f=this.partitions.length;b<f;b++){var g=this.partitions[b];d(a,g);a.drawElements(a.TRIANGLES,g.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}};return!0};e.Ribbon.prototype=new e._Mesh})(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,vec3);
(function(b,e,a){e.Light=function(e,c,d){this.diffuseRGB=b.getRGB(e,1);this.specularRGB=b.getRGB(c,1);this.direction=d;this.lightScene=function(c){c.uniform3f(c.getUniformLocation(c.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]);c.uniform3f(c.getUniformLocation(c.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var b=a.create(this.direction);a.normalize(b);a.negate(b);c.uniform3f(c.getUniformLocation(c.program,
"u_light.direction"),b[0],b[1],b[2]);var d=[0,0,0],b=[d[0]+b[0],d[1]+b[1],d[2]+b[2]],d=a.length(b);0===d?b=[0,0,1]:a.scale(1/d);c.uniform3f(c.getUniformLocation(c.program,"u_light.half_vector"),b[0],b[1],b[2])};return!0}})(ChemDoodle.math,ChemDoodle.structures.d3,vec3);(function(b){b.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0]);return!0};b.Line.prototype=new b._Mesh})(ChemDoodle.structures.d3);
(function(b,e){e.Material=function(a){var e=a.getUniformLocation(a.program,"u_material.ambient_color"),c=a.getUniformLocation(a.program,"u_material.diffuse_color"),d=a.getUniformLocation(a.program,"u_material.specular_color"),f=a.getUniformLocation(a.program,"u_material.shininess"),q=a.getUniformLocation(a.program,"u_material.alpha");this.setTempColors=function(g,o,m,j){if(!this.aCache||this.aCache!==g)this.aCache=g,g=b.getRGB(g,1),a.uniform3f(e,g[0],g[1],g[2]);if(o&&(!this.dCache||this.dCache!==
o))this.dCache=o,g=b.getRGB(o,1),a.uniform3f(c,g[0],g[1],g[2]);if(!this.sCache||this.sCache!==m)this.sCache=m,g=b.getRGB(m,1),a.uniform3f(d,g[0],g[1],g[2]);if(!this.snCache||this.snCache!==j)this.snCache=j,a.uniform1f(f,j);this.alCache=1;a.uniform1f(q,1)};this.setDiffuseColor=function(d){if(!this.dCache||this.dCache!==d)this.dCache=d,d=b.getRGB(d,1),a.uniform3f(c,d[0],d[1],d[2])};this.setAlpha=function(c){if(!this.alCache||this.alCache!==c)this.alCache=c,a.uniform1f(q,c)};return!0}})(ChemDoodle.math,
ChemDoodle.structures.d3);
(function(b,e,a,h){e.MolecularSurface=function(c,d,f,e,g){function o(a,c,b,d){var f=a.index;if(a.contained)for(var f=-1,g=Infinity,e=0,h=c.length;e<h;e++)for(var j=c[e],l=0,q=j.length;l<q;l++){var o=j[l];if(!o.contained&&o.index!==b&&o.index!==d){var m=o.distance3D(a);m<g&&(f=o.index,g=m)}}return f}for(var m=[],j=[],l=[],n=[],r=0;r<=d;r++)for(var k=r*h.PI/d,v=h.sin(k),x=h.cos(k),k=0;k<=f;k++){var t=2*k*h.PI/f;n.push(h.cos(t)*v,x,h.sin(t)*v)}v=[];r=0;for(k=c.atoms.length;r<k;r++){for(var x=[],y=c.atoms[r],
w=a[y.label][g]+e,u=[],t=0,p=c.atoms.length;t<p;t++)if(t!==r){var A=c.atoms[t];A.index=t;y.distance3D(A)<w+a[A.label][g]+e&&u.push(A)}t=0;for(p=n.length;t<p;t+=3){for(var B=new b.Atom("C",y.x+w*n[t],y.y+w*n[t+1],y.z+w*n[t+2]),D=0,G=u.length;D<G;D++)if(A=u[D],B.distance3D(A)<a[A.label][g]+e){B.contained=!0;break}x.push(B)}v.push(x)}c=[];f++;for(r=0;r<d;r++)for(k=0;k<f;k++)g=r*f+k%f,e=g+f,c.push(g),c.push(e),c.push(g+1),k<f-1&&(c.push(e),c.push(e+1),c.push(g+1));r=D=0;for(k=v.length;r<k;r++){x=v[r];
t=0;for(p=x.length;t<p;t++)B=x[t],B.contained||(B.index=D,D++,m.push(B.x,B.y,B.z),j.push(n[3*t],n[3*t+1],n[3*t+2]));t=0;for(p=c.length;t<p;t+=3)g=x[c[t]],e=x[c[t+1]],B=x[c[t+2]],!g.contained&&!e.contained&&!B.contained&&l.push(g.index,e.index,B.index)}n=[];r=0;for(k=v.length;r<k;r++){x=v[r];t=0;for(p=c.length;t<p;t+=3){g=x[c[t]];e=x[c[t+1]];B=x[c[t+2]];u=[];D=0;for(G=v.length;D<G;D++)D!==r&&u.push(v[D]);if((!g.contained||!e.contained||!B.contained)&&(g.contained||e.contained||B.contained))if(d=o(g,
u,-1,-1),f=o(e,u,d,-1),u=o(B,u,d,f),-1!==d&&-1!==f&&-1!==u){e=!1;D=0;for(G=n.length;D<G;D+=3)if(g=n[D],B=n[D+1],y=n[D+2],w=f===g||f===B||f===y,A=u===g||u===B||u===y,(d===g||d===B||d===y)&&w&&A){e=!0;break}e||n.push(d,f,u)}}}l=l.concat(n);this.storeData(m,j,l);return!0};e.MolecularSurface.prototype=new e._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(b,e){b.Shader=function(){this.init=function(a){var b=this.getShader(a,"vertex-shader");b||(b=this.loadDefaultVertexShader(a));var c=this.getShader(a,"fragment-shader");c||(c=this.loadDefaultFragmentShader(a));a.attachShader(a.program,b);a.attachShader(a.program,c);a.linkProgram(a.program);a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(program));a.useProgram(a.program);this.vertexPositionAttribute=a.getAttribLocation(a.program,"a_vertex_position");
a.enableVertexAttribArray(this.vertexPositionAttribute);this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal");a.enableVertexAttribArray(this.vertexNormalAttribute)};this.getShader=function(a,b){var c=e.getElementById(b);if(c){for(var d=[],f=c.firstChild;f;)3===f.nodeType&&d.push(f.textContent),f=f.nextSibling;if("x-shader/x-fragment"===c.type)f=a.createShader(a.FRAGMENT_SHADER);else if("x-shader/x-vertex"===c.type)f=a.createShader(a.VERTEX_SHADER);else return;a.shaderSource(f,
d.join(""));a.compileShader(f);if(a.getShaderParameter(f,a.COMPILE_STATUS))return f;alert(c.type+" "+a.getShaderInfoLog(f))}};this.loadDefaultVertexShader=function(a){var b=[];b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("float shininess;");b.push("float alpha;");
b.push("};");b.push("attribute vec3 a_vertex_position;");b.push("attribute vec3 a_vertex_normal;");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("uniform mat4 u_model_view_matrix;");b.push("uniform mat4 u_projection_matrix;");b.push("uniform mat3 u_normal_matrix;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");b.push("{");b.push("if(length(a_vertex_normal)==0.0){");
b.push("v_normal = a_vertex_normal;");b.push("}else{");b.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);");b.push("}");b.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);");b.push("v_light_direction = u_light.direction;");b.push("v_ambient = vec4(u_material.ambient_color, 1.0);");b.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;");b.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);");b.push("}");var c=a.createShader(a.VERTEX_SHADER);
a.shaderSource(c,b.join(""));a.compileShader(c);if(a.getShaderParameter(c,a.COMPILE_STATUS))return c;alert("Vertex shader failed to compile: "+a.getShaderInfoLog(c))};this.loadDefaultFragmentShader=function(a){var b=[];b.push("precision mediump float;\n");b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");
b.push("vec3 specular_color;");b.push("float shininess;");b.push("float alpha;");b.push("};");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");b.push("{");b.push("if(length(v_normal)==0.0){");b.push("gl_FragColor = vec4(v_diffuse.rgba);");b.push("}else{");b.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);");
b.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);");b.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);");b.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);");b.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);");b.push("gl_FragColor = color+v_ambient;");b.push("gl_FragColor.a*=u_material.alpha;");b.push("}");b.push("}");var c=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(c,b.join(""));a.compileShader(c);
if(a.getShaderParameter(c,a.COMPILE_STATUS))return c;alert("Fragment shader failed to compile: "+a.getShaderInfoLog(c))};return!0}})(ChemDoodle.structures.d3,document);
(function(b,e,a){e.Shape=function(e,c){for(var d=e.length,f=[],q=[],g=new b.Point,o=0,m=d;o<m;o++){var j=o+1;o===m-1&&(j=0);for(var l=e[o],j=e[j],n=a.cross([0,0,1],[j.x-l.x,j.y-l.y,0]),r=0;2>r;r++)f.push(l.x,l.y,c/2),f.push(l.x,l.y,-c/2),f.push(j.x,j.y,c/2),f.push(j.x,j.y,-c/2);for(r=0;4>r;r++)q.push(n[0],n[1],n[2]);q.push(0,0,1);q.push(0,0,-1);q.push(0,0,1);q.push(0,0,-1);g.add(l)}g.x/=d;g.y/=d;q.push(0,0,1);f.push(g.x,g.y,c/2);q.push(0,0,-1);f.push(g.x,g.y,-c/2);g=[];l=8*d;o=0;for(m=d;o<m;o++)d=
8*o,g.push(d),g.push(d+1),g.push(d+3),g.push(d),g.push(d+2),g.push(d+3),g.push(d+4),g.push(d+6),g.push(l),g.push(d+5),g.push(d+7),g.push(l+1);this.storeData(f,q,g);return!0};e.Shape.prototype=new e._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,vec3);
(function(b,e,a){b.Star=function(){for(var b=[0.8944,0.4472,0,0.2764,0.4472,0.8506,0.2764,0.4472,-0.8506,-0.7236,0.4472,0.5257,-0.7236,0.4472,-0.5257,-0.3416,0.4472,0,-0.1056,0.4472,0.3249,-0.1056,0.4472,-0.3249,0.2764,0.4472,0.2008,0.2764,0.4472,-0.2008,-0.8944,-0.4472,0,-0.2764,-0.4472,0.8506,-0.2764,-0.4472,-0.8506,0.7236,-0.4472,0.5257,0.7236,-0.4472,-0.5257,0.3416,-0.4472,0,0.1056,-0.4472,0.3249,0.1056,-0.4472,-0.3249,-0.2764,-0.4472,0.2008,-0.2764,-0.4472,-0.2008,-0.5527,0.1058,0,-0.1708,0.1058,
0.5527,-0.1708,0.1058,-0.5527,0.4471,0.1058,0.3249,0.4471,0.1058,-0.3249,0.5527,-0.1058,0,0.1708,-0.1058,0.5527,0.1708,-0.1058,-0.5527,-0.4471,-0.1058,0.3249,-0.4471,-0.1058,-0.3249,0,1,0,0,-1,0],c=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,
10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],f=[],e=[],g=0,o=c.length;g<o;g+=3){var m=3*c[g],j=3*c[g+1],l=3*c[g+2],m=[b[m],b[m+1],b[m+2]],j=[b[j],b[j+1],b[j+2]],l=[b[l],b[l+1],b[l+2]],n=a.cross([l[0]-j[0],l[1]-j[1],l[2]-j[2]],[m[0]-j[0],m[1]-j[1],m[2]-j[2]],[]);a.normalize(n);d.push(m[0],m[1],m[2],j[0],j[1],j[2],l[0],l[1],l[2]);f.push(n[0],n[1],n[2],n[0],n[1],
n[2],n[0],n[1],n[2]);e.push(g,g+1,g+2)}this.storeData(d,f,e);return!0};b.Star.prototype=new b._Mesh})(ChemDoodle.structures.d3,Math,vec3);
(function(b,e,a,h,c,d,f){var q=function(a,b,f){var e=c.sqrt(b[1]*b[1]+b[2]*b[2]),h=[1,0,0,0,0,b[2]/e,-b[1]/e,0,0,b[1]/e,b[2]/e,0,0,0,0,1],q=[1,0,0,0,0,b[2]/e,b[1]/e,0,0,-b[1]/e,b[2]/e,0,0,0,0,1],r=[e,0,-b[0],0,0,1,0,0,b[0],0,e,0,0,0,0,1],b=[e,0,b[0],0,0,1,0,0,-b[0],0,e,0,0,0,0,1],f=[c.cos(f),-c.sin(f),0,0,c.sin(f),c.cos(f),0,0,0,0,1,0,0,0,0,1],k=d.multiply(h,d.multiply(r,d.multiply(f,d.multiply(b,q,[]))));this.rotate=function(){return d.multiplyVec3(k,a)}};h.Tube=function(g,h,m){var j=g[0].lineSegments[0].length;
this.partitions=[];var l;this.ends=[];this.ends.push(g[0].lineSegments[0][0]);this.ends.push(g[g.length-2].lineSegments[0][0]);for(var n=[1,0,0],r=0,k=g.length-1;r<k;r++){if(!l||65E3<l.positionData.length)0<this.partitions.length&&r--,l={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(l);var v=g[r];l.count++;for(var x=Infinity,t=new a.Atom("",g[r+1].cp1.x,g[r+1].cp1.y,g[r+1].cp1.z),y=0;y<j;y++){var w=v.lineSegments[0][y],u;u=y===j-1?r===g.length-2?v.lineSegments[0][y-1]:g[r+
1].lineSegments[0][0]:v.lineSegments[0][y+1];u=[u.x-w.x,u.y-w.y,u.z-w.z];f.normalize(u);r===g.length-2&&y===j-1&&f.scale(u,-1);var p=vec3.cross(u,n,[]);f.normalize(p);f.scale(p,h/2);p=new q(p,u,2*Math.PI/m);u=0;for(var A=m;u<A;u++){var B=p.rotate();u===c.floor(m/4)&&(n=[B[0],B[1],B[2]]);l.normalData.push(B[0],B[1],B[2]);l.positionData.push(w.x+B[0],w.y+B[1],w.z+B[2])}t&&(u=w.distance3D(t),u<x&&(x=u,g[r+1].pPoint=w))}}n=0;for(v=this.partitions.length;n<v;n++){l=this.partitions[n];r=0;for(k=l.count-
1;r<k;r++){x=r*j*m;y=0;for(t=j;y<t;y++){w=x+y*m;for(u=0;u<m;u++)p=w+u,l.indexData.push(p),l.indexData.push(p+m),l.indexData.push(p+m+1),l.indexData.push(p),l.indexData.push(p+1),l.indexData.push(p+m+1)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);m=[new a.Point(2,0)];for(r=0;60>r;r++)j=r/60*c.PI,m.push(new a.Point(2*c.cos(j),-2*c.sin(j)));m.push(new a.Point(-2,0),new a.Point(-2,4),new a.Point(2,4));var D=new a.d3.Shape(m,1);this.render=
function(j,l){this.bindBuffers(j);j.material.setDiffuseColor(l.macro_colorByChain?this.chainColor:l.nucleics_tubeColor);j.drawElements(j.TRIANGLES,this.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0);if(this.partitions)for(var q=1,m=this.partitions.length;q<m;q++){var k=this.partitions[q],n=j,v=k;n.bindBuffer(n.ARRAY_BUFFER,v.vertexPositionBuffer);n.vertexAttribPointer(n.shader.vertexPositionAttribute,v.vertexPositionBuffer.itemSize,n.FLOAT,!1,0,0);n.bindBuffer(n.ARRAY_BUFFER,v.vertexNormalBuffer);
n.vertexAttribPointer(n.shader.vertexNormalAttribute,v.vertexNormalBuffer.itemSize,n.FLOAT,!1,0,0);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,v.vertexIndexBuffer);j.drawElements(j.TRIANGLES,k.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0)}j.sphereBuffer.bindBuffers(j);for(q=0;2>q;q++)k=this.ends[q],k=d.translate(j.modelViewMatrix,[k.x,k.y,k.z],[]),m=h/2,d.scale(k,[m,m,m]),j.setMatrixUniforms(k),j.drawElements(j.TRIANGLES,j.sphereBuffer.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0);j.cylinderBuffer.bindBuffers(j);
q=1;for(m=g.length-1;q<m;q++){var v=g[q],r=v.pPoint,p=new a.Atom("",v.cp2.x,v.cp2.y,v.cp2.z),k=1.001*r.distance3D(p),v=[h/4,k,h/4],k=d.translate(j.modelViewMatrix,[r.x,r.y,r.z],[]),t=[0,1,0],u=0,n=[p.x-r.x,p.y-r.y,p.z-r.z];r.x===p.x&&r.z===p.z?(t=[0,0,1],r.y<r.y&&(u=c.PI)):(u=b.vec3AngleFrom(t,n),t=f.cross(t,n,[]));0!==u&&d.rotate(k,u,t);d.scale(k,v);j.setMatrixUniforms(k);j.drawArrays(j.TRIANGLE_STRIP,0,j.cylinderBuffer.vertexPositionBuffer.numItems)}D.bindBuffers(j);!l.nucleics_useShapelyColors&&
!l.macro_colorByChain&&j.material.setDiffuseColor(l.nucleics_baseColor);q=1;for(m=g.length-1;q<m;q++)v=g[q],p=v.cp2,k=d.translate(j.modelViewMatrix,[p.x,p.y,p.z],[]),t=[0,1,0],u=0,r=v.cp3,n=[r.x-p.x,r.y-p.y,r.z-p.z],p.x===r.x&&p.z===r.z?(t=[0,0,1],p.y<p.y&&(u=c.PI)):(u=b.vec3AngleFrom(t,n),t=f.cross(t,n,[])),0!==u&&d.rotate(k,u,t),p=[1,0,0],u=d.rotate(d.identity([]),u,t),d.multiplyVec3(u,p),u=v.cp4,r=v.cp5,u.y===r.y&&u.z===r.z||(u=[r.x-u.x,r.y-u.y,r.z-u.z],r=b.vec3AngleFrom(p,u),0>f.dot(n,f.cross(p,
u))&&(r*=-1),d.rotateY(k,r)),l.nucleics_useShapelyColors&&!l.macro_colorByChain&&(e[v.name]?j.material.setDiffuseColor(e[v.name].shapelyColor):j.material.setDiffuseColor(e["*"].shapelyColor)),j.setMatrixUniforms(k),j.drawElements(j.TRIANGLES,D.vertexIndexBuffer.numItems,j.UNSIGNED_SHORT,0)};return!0};h.Tube.prototype=new h._Mesh})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,mat4,vec3);
(function(b){b.UnitCell=function(b){var a=[],h=[],c=function(b,c,d,e){a.push(b[0],b[1],b[2]);a.push(c[0],c[1],c[2]);a.push(d[0],d[1],d[2]);a.push(e[0],e[1],e[2]);for(b=0;4>b;b++)h.push(0,0,0)};c(b.o,b.x,b.xy,b.y);c(b.o,b.y,b.yz,b.z);c(b.o,b.z,b.xz,b.x);c(b.yz,b.y,b.xy,b.xyz);c(b.xyz,b.xz,b.z,b.yz);c(b.xy,b.x,b.xz,b.xyz);b=[];for(c=0;6>c;c++){var d=4*c;b.push(d,d+1,d+1,d+2,d+2,d+3,d+3,d)}this.storeData(a,h,b);return!0};b.UnitCell.prototype=new b._Mesh})(ChemDoodle.structures.d3,vec3);
(function(b,e,a){b.Plate=function(b){this.lanes=Array(b);i=0;for(ii=b;i<ii;i++)this.lanes[i]=[];this.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(a,b){return a-b})};this.draw=function(b){var d=b.canvas.width,f=b.canvas.height;this.origin=9*f/10;this.front=f/10;this.laneLength=this.origin-this.front;b.strokeStyle="#000000";b.beginPath();b.moveTo(0,this.front);e.contextHashTo(b,0,this.front,d,this.front,3,3);b.closePath();b.stroke();b.beginPath();b.moveTo(0,this.origin);
b.lineTo(d,this.origin);b.closePath();b.stroke();i=0;for(ii=this.lanes.length;i<ii;i++){f=(i+1)*d/(ii+1);b.beginPath();b.moveTo(f,this.origin);b.lineTo(f,this.origin+3);b.closePath();b.stroke();s=0;for(ss=this.lanes[i].length;s<ss;s++){var h=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":b.beginPath();b.arc(f,h,3,0,2*a.PI,!1);b.closePath();break;case "expanded":b.beginPath();b.arc(f,h,7,0,2*a.PI,!1);b.closePath();break;case "widened":e.contextOval(b,f-
18,h-10,36,10);break;case "cresent":b.beginPath(),b.arc(f,h,9,0,a.PI,!0),b.closePath()}switch(this.lanes[i][s].style){case "solid":b.fillStyle="#000000";b.fill();break;case "transparent":b.stroke()}}}};return!0};b.Plate.Spot=function(a,b,d){this.type=a;this.rf=b;this.style=d?d:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(b,e,a){b.default_backgroundColor="#FFFFFF";b.default_scale=1;b.default_rotateAngle=0;b.default_bondLength_2D=20;b.default_angstromsPerBondLength=1.25;b.default_lightDirection_3D=[-0.1,-0.1,-1];b.default_lightDiffuseColor_3D="#FFFFFF";b.default_lightSpecularColor_3D="#FFFFFF";b.default_projectionPerspective_3D=!0;b.default_projectionPerspectiveVerticalFieldOfView_3D=45;b.default_projectionOrthoWidth_3D=40;b.default_projectionWidthHeightRatio_3D=void 0;b.default_projectionFrontCulling_3D=
0.1;b.default_projectionBackCulling_3D=1E4;b.default_atoms_display=!0;b.default_atoms_color="#000000";b.default_atoms_font_size_2D=12;b.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"];b.default_atoms_font_bold_2D=!1;b.default_atoms_font_italic_2D=!1;b.default_atoms_circles_2D=!1;b.default_atoms_circleDiameter_2D=10;b.default_atoms_circleBorderWidth_2D=1;b.default_atoms_lonePairDistance_2D=8;b.default_atoms_lonePairSpread_2D=4;b.default_atoms_lonePairDiameter_2D=1;b.default_atoms_useJMOLColors=
!1;b.default_atoms_usePYMOLColors=!1;b.default_atoms_resolution_3D=60;b.default_atoms_sphereDiameter_3D=0.8;b.default_atoms_useVDWDiameters_3D=!1;b.default_atoms_vdwMultiplier_3D=1;b.default_atoms_materialAmbientColor_3D="#000000";b.default_atoms_materialSpecularColor_3D="#555555";b.default_atoms_materialShininess_3D=32;b.default_atoms_implicitHydrogens_2D=!0;b.default_atoms_displayTerminalCarbonLabels_2D=!1;b.default_atoms_showHiddenCarbons_2D=!0;b.default_atoms_displayAllCarbonLabels_2D=!1;b.default_atoms_nonBondedAsStars_3D=
!1;b.default_bonds_display=!0;b.default_bonds_color="#000000";b.default_bonds_width_2D=1;b.default_bonds_saturationWidth_2D=0.2;b.default_bonds_ends_2D="round";b.default_bonds_useJMOLColors=!1;b.default_bonds_usePYMOLColors=!1;b.default_bonds_colorGradient=!1;b.default_bonds_saturationAngle_2D=a.PI/3;b.default_bonds_symmetrical_2D=!1;b.default_bonds_clearOverlaps_2D=!1;b.default_bonds_overlapClearWidth_2D=0.5;b.default_bonds_atomLabelBuffer_2D=1;b.default_bonds_wedgeThickness_2D=0.22;b.default_bonds_hashWidth_2D=
1;b.default_bonds_hashSpacing_2D=2.5;b.default_bonds_showBondOrders_3D=!1;b.default_bonds_resolution_3D=60;b.default_bonds_renderAsLines_3D=!1;b.default_bonds_cylinderDiameter_3D=0.3;b.default_bonds_materialAmbientColor_3D="#222222";b.default_bonds_materialSpecularColor_3D="#555555";b.default_bonds_materialShininess_3D=32;b.default_proteins_displayRibbon=!0;b.default_proteins_displayBackbone=!1;b.default_proteins_backboneThickness=1.5;b.default_proteins_backboneColor="#CCCCCC";b.default_proteins_ribbonCartoonize=
!1;b.default_proteins_useShapelyColors=!1;b.default_proteins_useAminoColors=!1;b.default_proteins_usePolarityColors=!1;b.default_proteins_primaryColor="#FF0D0D";b.default_proteins_secondaryColor="#FFFF30";b.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740";b.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF";b.default_proteins_ribbonCartoonSheetColor="#E8BB99";b.default_proteins_ribbonThickness=0.2;b.default_proteins_verticalResolution=10;b.default_proteins_horizontalResolution=9;
b.default_proteins_materialAmbientColor_3D="#222222";b.default_proteins_materialSpecularColor_3D="#555555";b.default_proteins_materialShininess_3D=32;b.default_nucleics_display=!0;b.default_nucleics_tubeColor="#CCCCCC";b.default_nucleics_baseColor="#C10000";b.default_nucleics_useShapelyColors=!0;b.default_nucleics_tubeThickness=1.5;b.default_nucleics_tubeResolution_3D=60;b.default_nucleics_verticalResolution=10;b.default_nucleics_materialAmbientColor_3D="#222222";b.default_nucleics_materialSpecularColor_3D=
"#555555";b.default_nucleics_materialShininess_3D=32;b.default_macro_displayAtoms=!1;b.default_macro_displayBonds=!1;b.default_macro_atomToLigandDistance=-1;b.default_macro_showWater=!1;b.default_macro_colorByChain=!1;b.default_surfaces_display=!0;b.default_surfaces_style="Dot";b.default_surfaces_color="#E9B862";b.default_surfaces_materialAmbientColor_3D="#000000";b.default_surfaces_materialSpecularColor_3D="#000000";b.default_surfaces_materialShininess_3D=32;b.default_crystals_displayUnitCell=!0;
b.default_crystals_unitCellColor="green";b.default_crystals_unitCellLineWidth=1;b.default_plots_color="#000000";b.default_plots_width=1;b.default_plots_showIntegration=!1;b.default_plots_integrationColor="#c10000";b.default_plots_integrationLineWidth=1;b.default_plots_showGrid=!1;b.default_plots_gridColor="gray";b.default_plots_gridLineWidth=0.5;b.default_plots_showYAxis=!0;b.default_plots_flipXAxis=!1;b.default_text_font_size=12;b.default_text_font_families=["Helvetica","Arial","Dialog"];b.default_text_color=
"#000000";b.default_shapes_color="#000000";b.default_shapes_lineWidth_2D=1;b.default_shapes_arrowLength_2D=8;b.default_pusher_showElectron_2D=!0;e.VisualSpecifications=function(){this.backgroundColor=b.default_backgroundColor;this.scale=b.default_scale;this.rotateAngle=b.default_rotateAngle;this.bondLength=b.default_bondLength_2D;this.angstromsPerBondLength=b.default_angstromsPerBondLength;this.lightDirection_3D=b.default_lightDirection_3D;this.lightDiffuseColor_3D=b.default_lightDiffuseColor_3D;
this.lightSpecularColor_3D=b.default_lightSpecularColor_3D;this.projectionPerspective_3D=b.default_projectionPerspective_3D;this.projectionPerspectiveVerticalFieldOfView_3D=b.default_projectionPerspectiveVerticalFieldOfView_3D;this.projectionOrthoWidth_3D=b.default_projectionOrthoWidth_3D;this.projectionWidthHeightRatio_3D=b.default_projectionWidthHeightRatio_3D;this.projectionFrontCulling_3D=b.default_projectionFrontCulling_3D;this.projectionBackCulling_3D=b.default_projectionBackCulling_3D;this.atoms_display=
b.default_atoms_display;this.atoms_color=b.default_atoms_color;this.atoms_font_size_2D=b.default_atoms_font_size_2D;this.atoms_font_families_2D=[];for(var a=0,c=b.default_atoms_font_families_2D.length;a<c;a++)this.atoms_font_families_2D[a]=b.default_atoms_font_families_2D[a];this.atoms_font_bold_2D=b.default_atoms_font_bold_2D;this.atoms_font_italic_2D=b.default_atoms_font_italic_2D;this.atoms_circles_2D=b.default_atoms_circles_2D;this.atoms_circleDiameter_2D=b.default_atoms_circleDiameter_2D;this.atoms_circleBorderWidth_2D=
b.default_atoms_circleBorderWidth_2D;this.atoms_lonePairDistance_2D=b.default_atoms_lonePairDistance_2D;this.atoms_lonePairSpread_2D=b.default_atoms_lonePairSpread_2D;this.atoms_lonePairDiameter_2D=b.default_atoms_lonePairDiameter_2D;this.atoms_useJMOLColors=b.default_atoms_useJMOLColors;this.atoms_usePYMOLColors=b.default_atoms_usePYMOLColors;this.atoms_resolution_3D=b.default_atoms_resolution_3D;this.atoms_sphereDiameter_3D=b.default_atoms_sphereDiameter_3D;this.atoms_useVDWDiameters_3D=b.default_atoms_useVDWDiameters_3D;
this.atoms_vdwMultiplier_3D=b.default_atoms_vdwMultiplier_3D;this.atoms_materialAmbientColor_3D=b.default_atoms_materialAmbientColor_3D;this.atoms_materialSpecularColor_3D=b.default_atoms_materialSpecularColor_3D;this.atoms_materialShininess_3D=b.default_atoms_materialShininess_3D;this.atoms_implicitHydrogens_2D=b.default_atoms_implicitHydrogens_2D;this.atoms_displayTerminalCarbonLabels_2D=b.default_atoms_displayTerminalCarbonLabels_2D;this.atoms_showHiddenCarbons_2D=b.default_atoms_showHiddenCarbons_2D;
this.atoms_displayAllCarbonLabels_2D=b.default_atoms_displayAllCarbonLabels_2D;this.atoms_nonBondedAsStars_3D=b.default_atoms_nonBondedAsStars_3D;this.bonds_display=b.default_bonds_display;this.bonds_color=b.default_bonds_color;this.bonds_width_2D=b.default_bonds_width_2D;this.bonds_saturationWidth_2D=b.default_bonds_saturationWidth_2D;this.bonds_ends_2D=b.default_bonds_ends_2D;this.bonds_useJMOLColors=b.default_bonds_useJMOLColors;this.bonds_usePYMOLColors=b.default_bonds_usePYMOLColors;this.bonds_colorGradient=
b.default_bonds_colorGradient;this.bonds_saturationAngle_2D=b.default_bonds_saturationAngle_2D;this.bonds_symmetrical_2D=b.default_bonds_symmetrical_2D;this.bonds_clearOverlaps_2D=b.default_bonds_clearOverlaps_2D;this.bonds_overlapClearWidth_2D=b.default_bonds_overlapClearWidth_2D;this.bonds_atomLabelBuffer_2D=b.default_bonds_atomLabelBuffer_2D;this.bonds_wedgeThickness_2D=b.default_bonds_wedgeThickness_2D;this.bonds_hashWidth_2D=b.default_bonds_hashWidth_2D;this.bonds_hashSpacing_2D=b.default_bonds_hashSpacing_2D;
this.bonds_showBondOrders_3D=b.default_bonds_showBondOrders_3D;this.bonds_resolution_3D=b.default_bonds_resolution_3D;this.bonds_renderAsLines_3D=b.default_bonds_renderAsLines_3D;this.bonds_cylinderDiameter_3D=b.default_bonds_cylinderDiameter_3D;this.bonds_materialAmbientColor_3D=b.default_bonds_materialAmbientColor_3D;this.bonds_materialSpecularColor_3D=b.default_bonds_materialSpecularColor_3D;this.bonds_materialShininess_3D=b.default_bonds_materialShininess_3D;this.proteins_displayRibbon=b.default_proteins_displayRibbon;
this.proteins_displayBackbone=b.default_proteins_displayBackbone;this.proteins_backboneThickness=b.default_proteins_backboneThickness;this.proteins_backboneColor=b.default_proteins_backboneColor;this.proteins_ribbonCartoonize=b.default_proteins_ribbonCartoonize;this.proteins_useShapelyColors=b.default_proteins_useShapelyColors;this.proteins_useAminoColors=b.default_proteins_useAminoColors;this.proteins_usePolarityColors=b.default_proteins_usePolarityColors;this.proteins_primaryColor=b.default_proteins_primaryColor;
this.proteins_secondaryColor=b.default_proteins_secondaryColor;this.proteins_ribbonCartoonHelixPrimaryColor=b.default_proteins_ribbonCartoonHelixPrimaryColor;this.proteins_ribbonCartoonHelixSecondaryColor=b.default_proteins_ribbonCartoonHelixSecondaryColor;this.proteins_ribbonCartoonSheetColor=b.default_proteins_ribbonCartoonSheetColor;this.proteins_ribbonThickness=b.default_proteins_ribbonThickness;this.proteins_verticalResolution=b.default_proteins_verticalResolution;this.proteins_horizontalResolution=
b.default_proteins_horizontalResolution;this.proteins_materialAmbientColor_3D=b.default_proteins_materialAmbientColor_3D;this.proteins_materialSpecularColor_3D=b.default_proteins_materialSpecularColor_3D;this.proteins_materialShininess_3D=b.default_proteins_materialShininess_3D;this.macro_displayAtoms=b.default_macro_displayAtoms;this.macro_displayBonds=b.default_macro_displayBonds;this.macro_atomToLigandDistance=b.default_macro_atomToLigandDistance;this.nucleics_display=b.default_nucleics_display;
this.nucleics_tubeColor=b.default_nucleics_tubeColor;this.nucleics_baseColor=b.default_nucleics_baseColor;this.nucleics_useShapelyColors=b.default_nucleics_useShapelyColors;this.nucleics_tubeThickness=b.default_nucleics_tubeThickness;this.nucleics_tubeResolution_3D=b.default_nucleics_tubeResolution_3D;this.nucleics_verticalResolution=b.default_nucleics_verticalResolution;this.nucleics_materialAmbientColor_3D=b.default_nucleics_materialAmbientColor_3D;this.nucleics_materialSpecularColor_3D=b.default_nucleics_materialSpecularColor_3D;
this.nucleics_materialShininess_3D=b.default_nucleics_materialShininess_3D;this.macro_showWater=b.default_macro_showWater;this.macro_colorByChain=b.default_macro_colorByChain;this.surfaces_display=b.default_surfaces_display;this.surfaces_style=b.default_surfaces_style;this.surfaces_color=b.default_surfaces_color;this.surfaces_materialAmbientColor_3D=b.default_surfaces_materialAmbientColor_3D;this.surfaces_materialSpecularColor_3D=b.default_surfaces_materialSpecularColor_3D;this.surfaces_materialShininess_3D=
b.default_surfaces_materialShininess_3D;this.crystals_displayUnitCell=b.default_crystals_displayUnitCell;this.crystals_unitCellColor=b.default_crystals_unitCellColor;this.crystals_unitCellLineWidth=b.default_crystals_unitCellLineWidth;this.plots_color=b.default_plots_color;this.plots_width=b.default_plots_width;this.plots_showIntegration=b.default_plots_showIntegration;this.plots_integrationColor=b.default_plots_integrationColor;this.plots_integrationLineWidth=b.default_plots_integrationLineWidth;
this.plots_showGrid=b.default_plots_showGrid;this.plots_gridColor=b.default_plots_gridColor;this.plots_gridLineWidth=b.default_plots_gridLineWidth;this.plots_showYAxis=b.default_plots_showYAxis;this.plots_flipXAxis=b.default_plots_flipXAxis;this.text_font_size=b.default_text_font_size;this.text_font_families=[];a=0;for(c=b.default_text_font_families.length;a<c;a++)this.text_font_families[a]=b.default_text_font_families[a];this.text_color=b.default_text_color;this.shapes_color=b.default_shapes_color;
this.shapes_lineWidth_2D=b.default_shapes_lineWidth_2D;this.shapes_arrowLength_2D=b.default_shapes_arrowLength_2D;this.pusher_showElectron_2D=b.default_pusher_showElectron_2D;this.set3DRepresentation=function(a){this.bonds_display=this.atoms_display=!0;this.bonds_color="#777777";this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0;this.bonds_renderAsLines_3D=!1;"Ball and Stick"===a?(this.atoms_vdwMultiplier_3D=0.3,this.bonds_useJMOLColors=
!1,this.bonds_cylinderDiameter_3D=0.3,this.bonds_materialAmbientColor_3D=b.default_atoms_materialAmbientColor_3D):"van der Waals Spheres"===a?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===a?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=0.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===a?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=0.05,this.atoms_sphereDiameter_3D=
0.15,this.bonds_materialAmbientColor_3D=b.default_atoms_materialAmbientColor_3D):"Line"===a?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=0.05):alert('"'+a+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};this.getFontString=function(a,b,c,g){var e=[];c&&e.push("bold ");g&&e.push("italic ");e.push(a+"px ");a=0;for(c=b.length;a<c;a++)g=b[a],-1!==g.indexOf(" ")&&
(g='"'+g+'"'),e.push((0!==a?",":"")+g);return e.join("")}}})(ChemDoodle,ChemDoodle.structures,Math);
(function(b,e,a,h){a.getPointsPerAngstrom=function(){return b.default_bondLength_2D/b.default_angstromsPerBondLength};a.BondDeducer=function(){this.margin=1.1;this.deduceCovalentBonds=function(b,d){var f=a.getPointsPerAngstrom();d&&(f=d);for(var q=0,g=b.atoms.length;q<g;q++)for(var o=q+1;o<g;o++){var m=b.atoms[q],j=b.atoms[o];m.distance3D(j)<(e[m.label].covalentRadius+e[j.label].covalentRadius)*f*this.margin&&b.bonds.push(new h.Bond(m,j,1))}};return!0}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,
ChemDoodle.structures);(function(b){b.HydrogenDeducer=function(){this.removeHydrogens=function(b){for(var a=[],h=[],c=0,d=b.bonds.length;c<d;c++)"H"!==b.bonds[c].a1.label&&"H"!==b.bonds[c].a2.label&&h.push(b.bonds[c]);c=0;for(d=b.atoms.length;c<d;c++)"H"!==b.atoms[c].label&&a.push(b.atoms[c]);b.atoms=a;b.bonds=h};return!0}})(ChemDoodle.informatics);
(function(b,e,a){e.MolecularSurfaceGenerator=function(){this.generateSurface=function(b,c,d,f,e){return new a.MolecularSurface(b,c,d,f,e)};return!0}})(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures.d3);
(function(b,e){b.Splitter=function(){this.split=function(a){for(var b=[],c=0,d=a.atoms.length;c<d;c++)a.atoms[c].visited=!1;c=0;for(d=a.bonds.length;c<d;c++)a.bonds[c].visited=!1;c=0;for(d=a.atoms.length;c<d;c++){var f=a.atoms[c];if(!f.visited){var q=new e.Molecule;q.atoms.push(f);f.visited=!0;var g=new e.Queue;for(g.enqueue(f);!g.isEmpty();)for(var f=g.dequeue(),o=0,m=a.bonds.length;o<m;o++){var j=a.bonds[o];j.contains(f)&&!j.visited&&(j.visited=!0,q.bonds.push(j),j=j.getNeighbor(f),j.visited||(j.visited=
!0,q.atoms.push(j),g.enqueue(j)))}b.push(q)}}return b};return!0}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(b,e){b.StructureBuilder=function(){this.copy=function(a){for(var b=0,c=a.atoms.length;b<c;b++)a.atoms[b].metaID=b;for(var d=new e.Molecule,b=0,c=a.atoms.length;b<c;b++)d.atoms[b]=new e.Atom(a.atoms[b].label,a.atoms[b].x,a.atoms[b].y,a.atoms[b].z);b=0;for(c=a.bonds.length;b<c;b++)d.bonds[b]=new e.Bond(d.atoms[a.bonds[b].a1.metaID],d.atoms[a.bonds[b].a2.metaID],a.bonds[b].bondOrder);return d};return!0}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(b){b._Counter=function(){this.value=0;this.molecule=void 0;this.setMolecule=function(b){this.value=0;this.molecule=b;this.innerCalculate&&this.innerCalculate()};return!0}})(ChemDoodle.informatics);(function(b){b.FrerejacqueNumberCounter=function(b){this.setMolecule(b);return!0};b.FrerejacqueNumberCounter.prototype=new b._Counter;b.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new b.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(b,e){e.NumberOfMoleculesCounter=function(a){this.setMolecule(a);return!0};e.NumberOfMoleculesCounter.prototype=new e._Counter;e.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var a=0,e=this.molecule.atoms.length;a<e;a++)this.molecule.atoms[a].visited=!1;a=0;for(e=this.molecule.atoms.length;a<e;a++)if(!this.molecule.atoms[a].visited){this.value++;var c=new b.Queue;this.molecule.atoms[a].visited=!0;for(c.enqueue(this.molecule.atoms[a]);!c.isEmpty();)for(var d=c.dequeue(),
f=0,q=this.molecule.bonds.length;f<q;f++){var g=this.molecule.bonds[f];g.contains(d)&&(g=g.getNeighbor(d),g.visited||(g.visited=!0,c.enqueue(g)))}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(b,e){b._RingFinder=function(){this.rings=this.bonds=this.atoms=void 0;this.reduce=function(a){for(var b=0,c=a.atoms.length;b<c;b++)a.atoms[b].visited=!1;b=0;for(c=a.bonds.length;b<c;b++)a.bonds[b].visited=!1;for(var d=!0;d;){d=!1;b=0;for(c=a.atoms.length;b<c;b++){for(var f=0,e,g=0,o=a.bonds.length;g<o;g++)if(a.bonds[g].contains(a.atoms[b])&&!a.bonds[g].visited){f++;if(2===f)break;e=a.bonds[g]}1===f&&(d=!0,e.visited=!0,a.atoms[b].visited=!0)}}b=0;for(c=a.atoms.length;b<c;b++)a.atoms[b].visited||
this.atoms.push(a.atoms[b]);b=0;for(c=a.bonds.length;b<c;b++)a.bonds[b].visited||this.bonds.push(a.bonds[b]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])};this.setMolecule=function(a){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(a);2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()};this.fuse=function(){for(var a=0,b=this.rings.length;a<b;a++)for(var c=0,d=this.bonds.length;c<d;c++)-1!==e(this.bonds[c].a1,this.rings[a].atoms)&&-1!==e(this.bonds[c].a2,this.rings[a].atoms)&&
this.rings[a].bonds.push(this.bonds[c])};return!0}})(ChemDoodle.informatics,jQuery.inArray);
(function(b,e,a){function h(b,d){this.atoms=[];if(d)for(var f=0,q=d.atoms.length;f<q;f++)this.atoms[f]=d.atoms[f];this.atoms.push(b);this.grow=function(b,c){for(var d=this.atoms[this.atoms.length-1],f=[],e=0,q=b.length;e<q;e++)if(b[e].contains(d)){var r=b[e].getNeighbor(d);-1===a(r,c)&&f.push(r)}d=[];e=0;for(q=f.length;e<q;e++)d.push(new h(f[e],this));return d};this.check=function(b,c,d){for(var f=0,h=c.atoms.length-1;f<h;f++)if(-1!==a(c.atoms[f],this.atoms))return;var q;if(c.atoms[c.atoms.length-
1]===this.atoms[this.atoms.length-1]){q=new e.Ring;q.atoms[0]=d;f=0;for(h=this.atoms.length;f<h;f++)q.atoms.push(this.atoms[f]);for(f=c.atoms.length-2;0<=f;f--)q.atoms.push(c.atoms[f])}else{for(var r=[],f=0,h=b.length;f<h;f++)b[f].contains(c.atoms[c.atoms.length-1])&&r.push(b[f]);f=0;for(h=r.length;f<h;f++)if((1===c.atoms.length||!r[f].contains(c.atoms[c.atoms.length-2]))&&r[f].contains(this.atoms[this.atoms.length-1])){q=new e.Ring;q.atoms[0]=d;b=0;for(d=this.atoms.length;b<d;b++)q.atoms.push(this.atoms[b]);
for(b=c.atoms.length-1;0<=b;b--)q.atoms.push(c.atoms[b]);break}}return q};return!0}b.EulerFacetRingFinder=function(a){this.fingerBreak=5;this.setMolecule(a);return!0};b.EulerFacetRingFinder.prototype=new b._RingFinder;b.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var b=0,d=this.atoms.length;b<d;b++){for(var f=[],e=0,g=this.bonds.length;e<g;e++)this.bonds[e].contains(this.atoms[b])&&f.push(this.bonds[e].getNeighbor(this.atoms[b]));e=0;for(g=f.length;e<g;e++)for(var o=e+1;o<f.length;o++){var m=
[];m[0]=new h(f[e]);m[1]=new h(f[o]);var j=[];j[0]=this.atoms[b];for(var l=0,n=f.length;l<n;l++)l!==e&&l!==o&&j.push(f[l]);var r=[];for((l=m[0].check(this.bonds,m[1],this.atoms[b]))&&(r[0]=l);0===r.length&&0<m.length&&m[0].atoms.length<this.fingerBreak;){for(var k=[],l=0,n=m.length;l<n;l++)for(var v=m[l].grow(this.bonds,j),x=0,t=v.length;x<t;x++)k.push(v[x]);m=k;l=0;for(n=m.length;l<n;l++)for(x=l+1;x<n;x++)(t=m[l].check(this.bonds,m[x],this.atoms[b]))&&r.push(t);if(0===r.length){k=[];l=0;for(n=j.length;l<
n;l++){x=0;for(t=this.bonds.length;x<t;x++)this.bonds[x].contains(j[l])&&(f=this.bonds[x].getNeighbor(j[l]),-1===a(f,j)&&-1===a(f,k)&&k.push(f))}l=0;for(n=k.length;l<n;l++)j.push(k[l])}}if(0<r.length){m=void 0;l=0;for(n=r.length;l<n;l++)if(!m||m.atoms.length>r[l].atoms.length)m=r[l];r=!1;l=0;for(n=this.rings.length;l<n;l++){j=!0;x=0;for(t=m.atoms.length;x<t;x++)if(-1===a(m.atoms[x],this.rings[l].atoms)){j=!1;break}if(j){r=!0;break}}r||this.rings.push(m)}}}this.fuse()}})(ChemDoodle.informatics,ChemDoodle.structures,
jQuery.inArray);
(function(b){b.SSSRFinder=function(e){this.rings=[];if(0<e.atoms.length){var a=(new b.FrerejacqueNumberCounter(e)).value,h=(new b.EulerFacetRingFinder(e)).rings;h.sort(function(a,b){return a.atoms.length-b.atoms.length});for(var c=0,d=e.bonds.length;c<d;c++)e.bonds[c].visited=!1;c=0;for(d=h.length;c<d;c++){for(var e=!1,f=0,q=h[c].bonds.length;f<q;f++)if(!h[c].bonds[f].visited){e=!0;break}if(e){f=0;for(q=h[c].bonds.length;f<q;f++)h[c].bonds[f].visited=!0;this.rings.push(h[c])}if(this.rings.length===a)break}}return!0}})(ChemDoodle.informatics);
(function(b){b._Interpreter=function(){};b._Interpreter.prototype.fit=function(b,a,h){for(var c=b.length,d=[],f=0;f<a-c;f++)d.push(" ");return h?b+d.join(""):d.join("")+b}})(ChemDoodle.io);
(function(b,e,a,h,c,d,f,q){var g=/\s+/g,o=/\(|\)|\s+/g,m=/\'|\s+/g,j=/,|\'|\s+/g,l=/^\s+/,n=/[0-9]/g,r=/[0-9]|\+|\-/g,k=function(a){return 0!==a.length},v={P:[],A:[[0,0.5,0.5]],B:[[0.5,0,0.5]],C:[[0.5,0.5,0]],I:[[0.5,0.5,0.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,0.5,0.5],[0.5,0,0.5],[0.5,0.5,0]]},x=function(a){var b=0,c=0,d=0,f=0,e=a.indexOf("x"),g=a.indexOf("y"),j=a.indexOf("z");-1!==e&&(c++,0<e&&"+"!==a.charAt(e-1)&&(c*=-1));-1!==
g&&(d++,0<g&&"+"!==a.charAt(g-1)&&(d*=-1));-1!==j&&(f++,0<j&&"+"!==a.charAt(j-1)&&(f*=-1));if(2<a.length){e="+";g=0;for(j=a.length;g<j;g++){var h=a.charAt(g);if(("-"===h||"/"===h)&&(g===a.length-1||a.charAt(g+1).match(n)))e=h;h.match(n)&&("+"===e?b+=parseInt(h):"-"===e?b-=parseInt(h):"/"===e&&(b/=parseInt(h)))}}return[b,c,d,f]};a.CIFInterpreter=function(){this.read=function(a,f,n,p){var f=f?f:1,n=n?n:1,p=p?p:1,t=new h.Molecule;if(!a)return t;for(var B=a.split("\n"),D=0,G=0,F=0,C=a=0,E=0,I="P",L,H,
K,z,N=!0;0<B.length;)if(N?z=B.shift():N=!0,0<z.length)if(e.stringStartsWith(z,"_cell_length_a"))D=parseFloat(z.split(o)[1]);else if(e.stringStartsWith(z,"_cell_length_b"))G=parseFloat(z.split(o)[1]);else if(e.stringStartsWith(z,"_cell_length_c"))F=parseFloat(z.split(o)[1]);else if(e.stringStartsWith(z,"_cell_angle_alpha"))a=c.PI*parseFloat(z.split(o)[1])/180;else if(e.stringStartsWith(z,"_cell_angle_beta"))C=c.PI*parseFloat(z.split(o)[1])/180;else if(e.stringStartsWith(z,"_cell_angle_gamma"))E=c.PI*
parseFloat(z.split(o)[1])/180;else if(e.stringStartsWith(z,"_symmetry_space_group_name_H-M"))I=z.split(m)[1];else if(e.stringStartsWith(z,"loop_")){for(var J={fields:[],lines:[]},P=!1;void 0!==(z=B.shift())&&!e.stringStartsWith(z=z.replace(l,""),"loop_")&&0<z.length;)if(e.stringStartsWith(z,"_")){if(P)break;J.fields=J.fields.concat(z.split(g).filter(k))}else P=!0,J.lines.push(z);if(0!==B.length&&(e.stringStartsWith(z,"loop_")||e.stringStartsWith(z,"_")))N=!1;-1!==q("_symmetry_equiv_pos_as_xyz",J.fields)||
-1!==q("_space_group_symop_operation_xyz",J.fields)?L=J:-1!==q("_atom_site_label",J.fields)?H=J:-1!==q("_geom_bond_atom_site_label_1",J.fields)&&(K=J)}z=D;a=(c.cos(a)-c.cos(E)*c.cos(C))/c.sin(E);a=[z,0,0,0,G*c.cos(E),G*c.sin(E),0,0,F*c.cos(C),F*a,F*c.sqrt(1-c.pow(c.cos(C),2)-a*a),0,0,0,0,1];if(H){J=N=D=B=F=-1;E=0;for(C=H.fields.length;E<C;E++)z=H.fields[E],"_atom_site_type_symbol"===z?F=E:"_atom_site_label"===z?B=E:"_atom_site_fract_x"===z?D=E:"_atom_site_fract_y"===z?N=E:"_atom_site_fract_z"===z&&
(J=E);E=0;for(C=H.lines.length;E<C;E++)z=H.lines[E],G=z.split(g).filter(k),z=new h.Atom(G[-1===F?B:F].split(r)[0],parseFloat(G[D]),parseFloat(G[N]),parseFloat(G[J])),t.atoms.push(z),-1!==B&&(z.cifId=G[B],z.cifPart=0)}if(L&&!K){E=G=0;for(C=L.fields.length;E<C;E++)if(z=L.fields[E],"_symmetry_equiv_pos_as_xyz"===z||"_space_group_symop_operation_xyz"===z)G=E;N=v[I];B=[];E=0;for(C=L.lines.length;E<C;E++){z=L.lines[E].split(j).filter(k);for(var J=x(z[G]),P=x(z[G+1]),M=x(z[G+2]),I=0,D=t.atoms.length;I<D;I++){z=
t.atoms[I];var Q=z.x*J[1]+z.y*J[2]+z.z*J[3]+J[0],S=z.x*P[1]+z.y*P[2]+z.z*P[3]+P[0],R=z.x*M[1]+z.y*M[2]+z.z*M[3]+M[0];H=new h.Atom(z.label,Q,S,R);B.push(H);void 0!==z.cifId&&(H.cifId=z.cifId,H.cifPart=E+1);if(N){H=0;for(F=N.length;H<F;H++){var O=N[H],O=new h.Atom(z.label,Q+O[0],S+O[1],R+O[2]);B.push(O);void 0!==z.cifId&&(O.cifId=z.cifId,O.cifPart=E+1)}}}}E=0;for(C=B.length;E<C;E++){for(z=B[E];1<=z.x;)z.x--;for(;0>z.x;)z.x++;for(;1<=z.y;)z.y--;for(;0>z.y;)z.y++;for(;1<=z.z;)z.z--;for(;0>z.z;)z.z++}H=
[];E=0;for(C=B.length;E<C;E++){F=!1;z=B[E];I=0;for(D=t.atoms.length;I<D;I++)if(1.0E-4>t.atoms[I].distance3D(z)){F=!0;break}if(!F){I=0;for(D=H.length;I<D;I++)if(1.0E-4>H[I].distance3D(z)){F=!0;break}F||H.push(z)}}t.atoms=t.atoms.concat(H)}C=[];for(E=0;E<f;E++)for(I=0;I<n;I++)for(H=0;H<p;H++)if(!(0===E&&0===I&&0===H)){F=0;for(G=t.atoms.length;F<G;F++)z=t.atoms[F],B=new h.Atom(z.label,z.x+E,z.y+I,z.z+H),C.push(B),void 0!==z.cifId&&(B.cifId=z.cifId,B.cifPart=z.cifPart+(L?L.lines.length:0)+E+10*I+100*
H)}t.atoms=t.atoms.concat(C);E=0;for(C=t.atoms.length;E<C;E++)z=t.atoms[E],L=d.multiplyVec3(a,[z.x,z.y,z.z]),z.x=L[0],z.y=L[1],z.z=L[2];if(K){B=L=-1;E=0;for(C=K.fields.length;E<C;E++)z=K.fields[E],"_geom_bond_atom_site_label_1"===z?L=E:"_geom_bond_atom_site_label_2"===z&&(B=E);H=0;for(F=K.lines.length;H<F;H++){G=K.lines[H].split(g).filter(k);z=G[L];G=G[B];E=0;for(C=t.atoms.length;E<C;E++)for(I=E+1;I<C;I++){D=t.atoms[E];N=t.atoms[I];if(D.cifPart!==N.cifPart)break;(D.cifId===z&&N.cifId===G||D.cifId===
G&&N.cifId===z)&&t.bonds.push(new h.Bond(D,N))}}}else(new b.informatics.BondDeducer).deduceCovalentBonds(t,1);f=[-f/2,-n/2,-p/2];t.unitCellVectors={o:d.multiplyVec3(a,f,[]),x:d.multiplyVec3(a,[f[0]+1,f[1],f[2]]),y:d.multiplyVec3(a,[f[0],f[1]+1,f[2]]),z:d.multiplyVec3(a,[f[0],f[1],f[2]+1]),xy:d.multiplyVec3(a,[f[0]+1,f[1]+1,f[2]]),xz:d.multiplyVec3(a,[f[0]+1,f[1],f[2]+1]),yz:d.multiplyVec3(a,[f[0],f[1]+1,f[2]+1]),xyz:d.multiplyVec3(a,[f[0]+1,f[1]+1,f[2]+1])};return t}};a.CIFInterpreter.prototype=new a._Interpreter;
var t=new a.CIFInterpreter;b.readCIF=function(a,b,c,d){return t.read(a,b,c,d)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3,jQuery.inArray);
(function(b,e,a,h,c){a.MOLInterpreter=function(){this.read=function(a,c){c||(c=b.default_bondLength_2D);var d=new h.Molecule;if(!a)return d;for(var o=a.split("\n"),m=o[3],j=parseInt(m.substring(0,3)),m=parseInt(m.substring(3,6)),l=0;l<j;l++){var n=o[4+l];d.atoms[l]=new h.Atom(n.substring(31,34),parseFloat(n.substring(0,10))*c,(1===c?1:-1)*parseFloat(n.substring(10,20))*c,parseFloat(n.substring(20,30))*c);var r=parseInt(n.substring(34,36));0!==r&&e[d.atoms[l].label]&&(d.atoms[l].mass=e[d.atoms[l].label].mass+
r);switch(parseInt(n.substring(36,39))){case 1:d.atoms[l].charge=3;break;case 2:d.atoms[l].charge=2;break;case 3:d.atoms[l].charge=1;break;case 5:d.atoms[l].charge=-1;break;case 6:d.atoms[l].charge=-2;break;case 7:d.atoms[l].charge=-3}}for(l=0;l<m;l++){var n=o[4+j+l],k=parseInt(n.substring(6,9)),r=parseInt(n.substring(9,12));if(3<k)switch(k){case 4:k=1.5;break;default:k=1}n=new h.Bond(d.atoms[parseInt(n.substring(0,3))-1],d.atoms[parseInt(n.substring(3,6))-1],k);switch(r){case 3:n.stereo=h.Bond.STEREO_AMBIGUOUS;
break;case 1:n.stereo=h.Bond.STEREO_PROTRUDING;break;case 6:n.stereo=h.Bond.STEREO_RECESSED}d.bonds[l]=n}return d};this.write=function(a){var d=[];d.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");d.push(this.fit(a.atoms.length.toString(),3));d.push(this.fit(a.bonds.length.toString(),3));d.push("  0  0  0  0            999 v2000\n");for(var g=a.getCenter(),o=0,m=a.atoms.length;o<m;o++){var j=a.atoms[o],l=" 0";if(-1!==j.mass&&e[j.label]){var n=j.mass-e[j.label].mass;5>
n&&-4<n&&(l=(-1<n?" ":"")+n)}n="  0";if(0!==j.charge)switch(j.charge){case 3:n="  1";break;case 2:n="  2";break;case 1:n="  3";break;case -1:n="  5";break;case -2:n="  6";break;case -3:n="  7"}d.push(this.fit(((j.x-g.x)/b.default_bondLength_2D).toFixed(4),10));d.push(this.fit((-(j.y-g.y)/b.default_bondLength_2D).toFixed(4),10));d.push(this.fit((j.z/b.default_bondLength_2D).toFixed(4),10));d.push(" ");d.push(this.fit(j.label,3,!0));d.push(l);d.push(n);d.push("  0  0  0  0\n")}o=0;for(m=a.bonds.length;o<
m;o++)g=a.bonds[o],j=0,g.stereo===h.Bond.STEREO_AMBIGUOUS?j=3:g.stereo===h.Bond.STEREO_PROTRUDING?j=1:g.stereo===h.Bond.STEREO_RECESSED&&(j=6),d.push(this.fit((c(g.a1,a.atoms)+1).toString(),3)),d.push(this.fit((c(g.a2,a.atoms)+1).toString(),3)),d.push(this.fit(g.bondOrder.toString(),3)),d.push("  "),d.push(j),d.push("     0  0\n");d.push("M  END");return d.join("")}};a.MOLInterpreter.prototype=new a._Interpreter;var d=new a.MOLInterpreter;b.readMOL=function(a,b){return d.read(a,b)};b.writeMOL=function(a){return d.write(a)}})(ChemDoodle,
ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
(function(b,e,a,h,c,d,f){a.PDBInterpreter=function(){function a(b,c,d,f,e){for(var g=0,h=c.length;g<h;g++){var q=c[g];if(q.id===d&&f>=q.start&&f<=q.end){e?b.helix=!0:b.sheet=!0;f+1===q.end&&(b.arrow=!0);break}}}this.deduceResidueBonds=this.calculateRibbonDistances=!1;this.read=function(q,m){var j=new h.Molecule;j.chains=[];if(!q)return j;var l=q.split("\n");m||(m=1);for(var n=[],r=[],k,v=[],x=[],t=[],y=0,w=l.length;y<w;y++){var u=l[y];if(e.stringStartsWith(u,"HELIX"))n.push({id:u.substring(19,20),
start:parseInt(u.substring(21,25)),end:parseInt(u.substring(33,37))});else if(e.stringStartsWith(u,"SHEET"))r.push({id:u.substring(21,22),start:parseInt(u.substring(22,26)),end:parseInt(u.substring(33,37))});else if(e.stringStartsWith(u,"ATOM")){var p=u.substring(16,17);if(" "===p||"A"===p){p=d(u.substring(76,78));if(0===p.length){var A=d(u.substring(12,14));"HD"===A?p="H":0<A.length&&(p=1<A.length?A.charAt(0)+A.substring(1).toLowerCase():A)}A=new h.Atom(p,parseFloat(u.substring(30,38))*m,parseFloat(u.substring(38,
46))*m,parseFloat(u.substring(46,54))*m);A.hetatm=!1;x.push(A);var B=parseInt(u.substring(22,26));if(0===v.length)for(p=0;2>p;p++){var D=new h.Residue(-1);D.cp1=A;D.cp2=A;v.push(D)}B!==Number.NaN&&v[v.length-1].resSeq!==B&&(p=new h.Residue(B),p.name=d(u.substring(17,20)),3===p.name.length?p.name=p.name.substring(0,1)+p.name.substring(1).toLowerCase():2===p.name.length&&"D"===p.name.charAt(0)&&(p.name=p.name.substring(1)),v.push(p),D=u.substring(21,22),a(p,n,D,B,!0),a(p,r,D,B,!1));u=d(u.substring(12,
16));p=v[v.length-1];if("CA"===u||"P"===u||"O5'"===u)p.cp1||(p.cp1=A);else if("N3"===u&&("C"===p.name||"U"===p.name||"T"===p.name)||"N1"===u&&("A"===p.name||"G"===p.name))p.cp3=A;else if("C2"===u)p.cp4=A;else if("C4"===u&&("C"===p.name||"U"===p.name||"T"===p.name)||"C6"===u&&("A"===p.name||"G"===p.name))p.cp5=A;else if("O"===u||"C6"===u&&("C"===p.name||"U"===p.name||"T"===p.name)||"N9"===u){if(!v[v.length-1].cp2){if("C6"===u||"N9"===u)k=A;p.cp2=A}}else"C"===u&&(k=A)}}else if(e.stringStartsWith(u,
"HETATM"))p=d(u.substring(76,78)),0===p.length&&(p=d(u.substring(12,16))),1<p.length&&(p=p.substring(0,1)+p.substring(1).toLowerCase()),p=new h.Atom(p,parseFloat(u.substring(30,38))*m,parseFloat(u.substring(38,46))*m,parseFloat(u.substring(46,54))*m),p.hetatm=!0,"HOH"===d(u.substring(17,20))&&(p.isWater=!0),j.atoms.push(p),t[parseInt(d(u.substring(6,11)))]=p;else if(e.stringStartsWith(u,"CONECT")){if(p=parseInt(d(u.substring(6,11))),t[p]){A=t[p];for(B=0;4>B;B++)if(p=d(u.substring(11+5*B,16+5*B)),
0!==p.length&&(p=parseInt(p),t[p])){for(var D=t[p],G=!1,p=0,F=j.bonds.length;p<F;p++){var C=j.bonds[p];if(C.a1===A&&C.a2===D||C.a1===D&&C.a2===A){G=!0;break}}G||j.bonds.push(new h.Bond(A,D))}}}else if(e.stringStartsWith(u,"TER"))this.endChain(j,v,k,x),v=[];else if(e.stringStartsWith(u,"ENDMDL"))break}this.endChain(j,v,k,x);0===j.bonds.size&&(new b.informatics.BondDeducer).deduceCovalentBonds(j,m);if(this.deduceResidueBonds){y=0;for(w=x.length;y<w;y++){l=f.min(w,y+20);for(p=y+1;p<l;p++)n=x[y],r=x[p],
n.distance3D(r)<1.1*(c[n.label].covalentRadius+c[r.label].covalentRadius)&&j.bonds.push(new h.Bond(n,r,1))}}j.atoms=j.atoms.concat(x);this.calculateRibbonDistances&&this.calculateDistances(j,x);return j};this.endChain=function(a,b,c,d){if(0<b.length){var f=b[b.length-1];f.cp1||(f.cp1=d[d.length-2]);f.cp2||(f.cp2=d[d.length-1]);for(d=0;4>d;d++)f=new h.Residue(-1),f.cp1=c,f.cp2=b[b.length-1].cp2,b.push(f);a.chains.push(b)}};this.calculateDistances=function(a,b){for(var c=[],d=0,f=a.atoms.length;d<f;d++){var e=
a.atoms[d];e.hetatm&&(e.isWater||c.push(e))}d=0;for(f=b.length;d<f;d++)if(e=b[d],e.closestDistance=Number.POSITIVE_INFINITY,0===c.length)e.closestDistance=0;else for(var g=0,h=c.length;g<h;g++)e.closestDistance=Math.min(e.closestDistance,e.distance3D(c[g]))}};a.PDBInterpreter.prototype=new a._Interpreter;var q=new a.PDBInterpreter;b.readPDB=function(a,b){return q.read(a,b)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,jQuery.trim,Math);
(function(b,e,a,h,c,d){var f={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},q={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},g={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};a.JCAMPInterpreter=function(){this.convertHZ2PPM=!1;this.read=function(a){this.isBreak=function(a){return void 0!==f[a]||void 0!==q[a]||void 0!==g[a]||" "===a||"-"===a||"+"===a};this.getValue=function(a,b){var c=a.charAt(0),d=a.substring(1);return void 0!==
f[c]?parseFloat(f[c]+d):void 0!==q[c]?parseFloat(q[c]+d)+b:parseFloat(d)};var b=new h.Spectrum;if(void 0===a||0===a.length)return b;for(var a=a.split("\n"),l=[],n,o,k,v,x=1,t=1,y=1,w=-1,u=-1,p=-1,A=!0,B=!1,D=0,G=a.length;D<G;D++){var F=d(a[D]),C=c.inArray("$$",F);-1!==C&&(F=F.substring(0,C));if(0===l.length||!e.stringStartsWith(a[D],"##"))0!==l.length&&l.push("\n"),l.push(d(F));else if(C=l.join(""),A&&100>C.length&&b.metadata.push(C),l=[F],e.stringStartsWith(C,"##TITLE="))b.title=d(C.substring(8));
else if(e.stringStartsWith(C,"##XUNITS="))b.xUnit=d(C.substring(9)),this.convertHZ2PPM&&"HZ"===b.xUnit.toUpperCase()&&(b.xUnit="PPM",B=!0);else if(e.stringStartsWith(C,"##YUNITS="))b.yUnit=d(C.substring(9));else if(!e.stringStartsWith(C,"##XYPAIRS="))if(e.stringStartsWith(C,"##FIRSTX="))o=parseFloat(d(C.substring(9)));else if(e.stringStartsWith(C,"##LASTX="))n=parseFloat(d(C.substring(8)));else if(e.stringStartsWith(C,"##FIRSTY="))k=parseFloat(d(C.substring(9)));else if(e.stringStartsWith(C,"##NPOINTS="))v=
parseFloat(d(C.substring(10)));else if(e.stringStartsWith(C,"##XFACTOR="))x=parseFloat(d(C.substring(10)));else if(e.stringStartsWith(C,"##YFACTOR="))t=parseFloat(d(C.substring(10)));else if(e.stringStartsWith(C,"##DELTAX="))w=parseFloat(d(C.substring(9)));else if(e.stringStartsWith(C,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(y=parseFloat(d(C.substring(21))));else if(e.stringStartsWith(C,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(p=C.substring(19).split(","),u=parseInt(d(p[2])),p=parseFloat(d(p[3])));
else if(e.stringStartsWith(C,"##XYDATA=")){B||(y=1);var F=A=!1,C=C.split("\n"),E=(n-o)/(v-1);if(-1!==w)for(var I=1,L=C.length;I<L;I++)if("|"===C[I].charAt(0)){E=w;break}for(var H=o-E,K=k,z=0,N,I=1,L=C.length;I<L;I++){for(var J=[],H=d(C[I]),l=[],P=!1,M=0,Q=H.length;M<Q;M++)this.isBreak(H.charAt(M))?(0<l.length&&!(1===l.length&&" "===l[0])&&J.push(l.join("")),l=[H.charAt(M)]):"|"===H.charAt(M)?P=!0:l.push(H.charAt(M));J.push(l.join(""));H=parseFloat(J[0])*x-E;M=1;for(Q=J.length;M<Q;M++)if(K=J[M],void 0!==
g[K.charAt(0)])for(var S=parseInt(g[K.charAt(0)]+K.substring(1))-1,R=0;R<S;R++)H+=E,z=this.getValue(N,z),K=z*t,O++,b.data[b.data.length-1]=new h.Point(H/y,K);else void 0!==f[K.charAt(0)]&&F?(K=this.getValue(K,z)*t,P&&(H+=E,b.data.push(new h.Point(H/y,K)))):(F=void 0!==q[K.charAt(0)],N=K,H+=E,z=this.getValue(K,z),K=z*t,O++,b.data.push(new h.Point(H/y,K)))}if(-1!==u){F=p-b.data[u-1].x;D=0;for(G=b.data.length;D<G;D++)b.data[D].x+=F}}else if(e.stringStartsWith(C,"##PEAK TABLE=")){A=!1;b.continuous=!1;
for(var C=C.split("\n"),O=0,I=1,L=C.length;I<L;I++){F=C[I].split(/[\s,]+/);O+=F.length/2;M=0;for(Q=F.length;M+1<Q;M+=2)b.data.push(new h.Point(parseFloat(d(F[M])),parseFloat(d(F[M+1]))))}}}b.setup();return b}};a.JCAMPInterpreter.prototype=new a._Interpreter;var o=new a.JCAMPInterpreter;o.convertHZ2PPM=!0;b.readJCAMP=function(a){return o.read(a)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim);
(function(b,e,a,h){b.JSONInterpreter=function(){this.contentTo=function(a,b){for(var f=0,e=0,g=0,h=a.length;g<h;g++){for(var m=a[g],j=0,l=m.atoms.length;j<l;j++)m.atoms[j].tmpid="a"+f++;j=0;for(l=m.bonds.length;j<l;j++)m.bonds[j].tmpid="b"+e++}g=f=0;for(h=b.length;g<h;g++)b[g].tmpid="s"+f++;f={};if(a&&0<a.length){f.m=[];g=0;for(h=a.length;g<h;g++)f.m.push(this.molTo(a[g]))}if(b&&0<b.length){f.s=[];g=0;for(h=b.length;g<h;g++)f.s.push(this.shapeTo(b[g]))}g=0;for(h=a.length;g<h;g++){m=a[g];j=0;for(l=
m.atoms.length;j<l;j++)m.atoms[j].tmpid=void 0;j=0;for(l=m.bonds.length;j<l;j++)m.bonds[j].tmpid=void 0}g=0;for(h=b.length;g<h;g++)b[g].tmpid=void 0;return f};this.contentFrom=function(a){var b={molecules:[],shapes:[]};if(a.m)for(var f=0,e=a.m.length;f<e;f++)b.molecules.push(this.molFrom(a.m[f]));if(a.s){f=0;for(e=a.s.length;f<e;f++)b.shapes.push(this.shapeFrom(a.s[f],b.molecules))}f=0;for(e=b.molecules.length;f<e;f++){for(var a=b.molecules[f],g=0,h=a.atoms.length;g<h;g++)a.atoms[g].tmpid=void 0;
g=0;for(h=a.bonds.length;g<h;g++)a.bonds[g].tmpid=void 0}f=0;for(e=b.shapes.length;f<e;f++)b.shapes[f].tmpid=void 0;return b};this.molTo=function(a){for(var b={a:[],b:[]},f=0,q=a.atoms.length;f<q;f++){var g=a.atoms[f],o={x:g.x,y:g.y};g.tmpid&&(o.i=g.tmpid);"C"!==g.label&&(o.l=g.label);0!==g.z&&(o.z=g.z);0!==g.charge&&(o.c=g.charge);-1!==g.mass&&(o.m=g.mass);0!==g.numRadical&&(o.r=g.numRadical);0!==g.numLonePair&&(o.p=g.numLonePair);g.any&&(o.q=!0);-1!==g.rgroup&&(o.rg=g.rgroup);b.a.push(o)}f=0;for(q=
a.bonds.length;f<q;f++)g=a.bonds[f],o={b:h(g.a1,a.atoms),e:h(g.a2,a.atoms)},g.tmpid&&(o.i=g.tmpid),1!==g.bondOrder&&(o.o=g.bondOrder),g.stereo!==e.Bond.STEREO_NONE&&(o.s=g.stereo),b.b.push(o);return b};this.molFrom=function(a){for(var b=new e.Molecule,f=0,h=a.a.length;f<h;f++){var g=a.a[f],o=new e.Atom(g.l?g.l:"C",g.x,g.y);g.i&&(o.tmpid=g.i);g.z&&(o.z=g.z);g.c&&(o.charge=g.c);g.m&&(o.mass=g.m);g.r&&(o.numRadical=g.r);g.p&&(o.numLonePair=g.p);g.q&&(o.any=!0);g.rg&&(o.rgroup=g.rg);void 0!==g.p_h&&(o.hetatm=
g.p_h);void 0!==g.p_w&&(o.isWater=g.p_w);void 0!==g.p_d&&(o.closestDistance=g.p_d);b.atoms.push(o)}f=0;for(h=a.b.length;f<h;f++)g=a.b[f],o=new e.Bond(b.atoms[g.b],b.atoms[g.e],g.o?g.o:1),g.i&&(o.tmpid=g.i),g.s&&(o.stereo=g.s),b.bonds.push(o);return b};this.shapeTo=function(b){var d={};b.tmpid&&(d.i=b.tmpid);b instanceof a.Line?(d.t="Line",d.x1=b.p1.x,d.y1=b.p1.y,d.x2=b.p2.x,d.y2=b.p2.y,d.a=b.arrowType):b instanceof a.Pusher&&(d.t="Pusher",d.o1=b.o1.tmpid,d.o2=b.o2.tmpid,1!==b.numElectron&&(d.e=b.numElectron));
return d};this.shapeFrom=function(b,d){var f;if("Line"===b.t)f=new a.Line(new e.Point(b.x1,b.y1),new e.Point(b.x2,b.y2)),f.arrowType=b.a;else if("Pusher"===b.t){var h,g;f=0;for(var o=d.length;f<o;f++){for(var m=d[f],j=0,l=m.atoms.length;j<l;j++){var n=m.atoms[j];n.tmpid===b.o1?h=n:n.tmpid===b.o2&&(g=n)}j=0;for(l=m.bonds.length;j<l;j++)n=m.bonds[j],n.tmpid===b.o1?h=n:n.tmpid===b.o2&&(g=n)}f=new a.Pusher(h,g);b.e&&(f.numElectron=b.e)}return f};this.pdbFrom=function(a){var b=this.molFrom(a.mol);b.findRings=
!1;b.fromJSON=!0;b.chains=this.chainsFrom(a.ribbons);return b};this.chainsFrom=function(a){for(var b=[],f=0,h=a.cs.length;f<h;f++){for(var g=a.cs[f],o=[],m=0,j=g.length;m<j;m++){var l=g[m],n=new e.Residue;n.name=l.n;n.cp1=new e.Atom("",l.x1,l.y1,l.z1);n.cp2=new e.Atom("",l.x2,l.y2,l.z2);l.x3&&(n.cp3=new e.Atom("",l.x3,l.y3,l.z3),n.cp4=new e.Atom("",l.x4,l.y4,l.z4),n.cp5=new e.Atom("",l.x5,l.y5,l.z5));n.helix=l.h;n.sheet=l.s;n.arrow=l.a;o.push(n)}b.push(o)}return b}}})(ChemDoodle.io,ChemDoodle.structures,
ChemDoodle.structures.d2,jQuery.inArray);
(function(b,e,a){e.RXNInterpreter=function(){this.read=function(c,d){d||(d=b.default_bondLength_2D);var f=[],e;if(c){e=c.split("$MOL\n");for(var g=e[0].split("\n")[4],h=parseInt(g.substring(0,3)),g=parseInt(g.substring(3,6)),m=1,j=0,l=0,n=h+g;l<n;l++){f[l]=b.readMOL(e[m],d);var r=f[l].getBounds(),r=r.maxX-r.minX,j=j-(r+40);m++}l=0;for(n=h;l<n;l++){var r=f[l].getBounds(),r=r.maxX-r.minX,m=f[l].getCenter(),k=0;for(e=f[l].atoms.length;k<e;k++){var v=f[l].atoms[k];v.x+=j+r/2-m.x;v.y-=m.y}j+=r+40}e=new a.d2.Line(new a.Point(j,
0),new a.Point(j+40,0));j+=80;l=h;for(n=h+g;l<n;l++){r=f[l].getBounds();r=r.maxX-r.minX;m=f[l].getCenter();for(k=0;k<f[l].atoms.length;k++)v=f[l].atoms[k],v.x+=j+r/2-m.x,v.y-=m.y;j+=r+40}}else f.push(new a.Molecule),e=new a.d2.Line(new a.Point(-20,0),new a.Point(20,0));e.arrowType=a.d2.Line.ARROW_SYNTHETIC;return{molecules:f,shapes:[e]}};this.write=function(c,d){var f=[[],[]],e=void 0;if(c&&d){g=0;for(h=d.length;g<h;g++)if(d[g]instanceof a.d2.Line){e=d[g].getPoints();break}if(!e)return"";for(var g=
0,h=c.length;g<h;g++)c[g].getCenter().x<e[0].x?f[0].push(c[g]):f[1].push(c[g]);e=[];e.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");e.push(this.fit(f[0].length.toString(),3));e.push(this.fit(f[1].length.toString(),3));e.push("\n");for(g=0;2>g;g++)for(var h=0,m=f[g].length;h<m;h++)e.push("$MOL\n"),e.push(b.writeMOL(f[g][h])),e.push("\n");return e.join("")}}};e.RXNInterpreter.prototype=new e._Interpreter;var h=new e.RXNInterpreter;b.readRXN=function(a,b){return h.read(a,
b)};b.writeRXN=function(a,b){return h.write(a,b)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(b,e,a,h,c,d){h.XYZInterpreter=function(){this.deduceCovalentBonds=!0;this.read=function(f){var e=new c.Molecule;if(!f)return e;for(var f=f.split("\n"),h=parseInt(d(f[0])),m=0;m<h;m++){var j=f[m+2].split(/\s+/g);e.atoms[m]=new c.Atom(isNaN(j[0])?j[0]:a[parseInt(j[0])-1],parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3]))}this.deduceCovalentBonds&&(new b.informatics.BondDeducer).deduceCovalentBonds(e,1);return e}};h.XYZInterpreter.prototype=new h._Interpreter;var f=new h.XYZInterpreter;b.readXYZ=
function(a){return f.read(a)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
ChemDoodle.monitor=function(b,e,a){var h={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};b.supports_touch()||e(a).ready(function(){e(a).mousemove(function(a){h.CANVAS_DRAGGING&&h.CANVAS_DRAGGING.drag&&(h.CANVAS_DRAGGING.prehandleEvent(a),h.CANVAS_DRAGGING.drag(a))});e(a).mouseup(function(a){h.CANVAS_DRAGGING&&h.CANVAS_DRAGGING!==h.CANVAS_OVER&&h.CANVAS_DRAGGING.mouseup&&(h.CANVAS_DRAGGING.prehandleEvent(a),h.CANVAS_DRAGGING.mouseup(a));h.CANVAS_DRAGGING=void 0});e(a).keydown(function(a){h.SHIFT=
a.shiftKey;h.ALT=a.altKey;h.META=a.metaKey;var b=h.CANVAS_OVER;h.CANVAS_DRAGGING&&(b=h.CANVAS_DRAGGING);b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))});e(a).keypress(function(a){var b=h.CANVAS_OVER;h.CANVAS_DRAGGING&&(b=h.CANVAS_DRAGGING);b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))});e(a).keyup(function(a){h.SHIFT=a.shiftKey;h.ALT=a.altKey;h.META=a.metaKey;var b=h.CANVAS_OVER;h.CANVAS_DRAGGING&&(b=h.CANVAS_DRAGGING);b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})});return h}(ChemDoodle.featureDetection,
jQuery,document);
(function(b,e,a,h,c,d,f,q,g,o,m){b._Canvas=function(){this.image=this.emptyMessage=this.shapes=this.molecules=void 0;return!0};b._Canvas.prototype.repaint=function(){if(!this.test){var a=o.getElementById(this.id);if(a.getContext){var b=a.getContext("2d");1!==this.pixelRatio&&a.width===this.width&&(a.width=this.width*this.pixelRatio,a.height=this.height*this.pixelRatio,b.scale(this.pixelRatio,this.pixelRatio));this.image?b.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==a.style.backgroundColor&&
(a.style.backgroundColor=this.specs.backgroundColor,this.bgCache=a.style.backgroundColor),b.fillStyle=this.specs.backgroundColor,b.fillRect(0,0,this.width,this.height));if(this.innerRepaint)this.innerRepaint(b);else if(0!==this.molecules.length||0!==this.shapes.length){b.save();b.translate(this.width/2,this.height/2);b.rotate(this.specs.rotateAngle);b.scale(this.specs.scale,this.specs.scale);b.translate(-this.width/2,-this.height/2);for(var a=0,c=this.molecules.length;a<c;a++)this.molecules[a].check(!0),
this.molecules[a].draw(b,this.specs);a=0;for(c=this.shapes.length;a<c;a++)this.shapes[a].draw(b,this.specs);b.restore()}else this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(b)}}};b._Canvas.prototype.resize=function(a,b){var c=d("#"+this.id);c.attr({width:a,height:b});c.css("width",a);c.css("height",b);this.width=
a;this.height=b;if(this instanceof ChemDoodle._Canvas3D)this.gl.viewport(0,0,a,b),this.setupScene();else if(0<this.molecules.length){this.center();for(var c=0,f=this.molecules.length;c<f;c++)this.molecules[c].check()}this.repaint()};b._Canvas.prototype.setBackgroundImage=function(a){this.image=new Image;var b=this;this.image.onload=function(){b.repaint()};this.image.src=a};b._Canvas.prototype.loadMolecule=function(a){this.clear();this.molecules.push(a);this.center();this instanceof ChemDoodle._Canvas3D||
a.check();this.afterLoadContent&&this.afterLoadContent();this.repaint()};b._Canvas.prototype.loadContent=function(a,b){this.molecules=a;this.shapes=b;this.center();if(!(this instanceof ChemDoodle._Canvas3D))for(var c=0,d=this.molecules.length;c<d;c++)this.molecules[c].check();this.afterLoadContent&&this.afterLoadContent();this.repaint()};b._Canvas.prototype.addMolecule=function(a){this.molecules.push(a);this instanceof ChemDoodle._Canvas3D||a.check();this.repaint()};b._Canvas.prototype.removeMolecule=
function(a){this.molecules=d.grep(this.molecules,function(b){return b!==a});this.repaint()};b._Canvas.prototype.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0};b._Canvas.prototype.getMolecules=function(){return this.molecules};b._Canvas.prototype.addShape=function(a){this.shapes.push(a);this.repaint()};b._Canvas.prototype.removeShape=function(a){this.shapes=d.grep(this.shapes,function(b){return b!==a});this.repaint()};b._Canvas.prototype.getShapes=function(){return this.shapes};
b._Canvas.prototype.clear=function(){this.molecules=[];this.shapes=[];this.specs.scale=1;this.repaint()};b._Canvas.prototype.center=function(){for(var a=this.getContentBounds(),b=new c.Point((this.width-a.minX-a.maxX)/2,(this.height-a.minY-a.maxY)/2),d=0,f=this.molecules.length;d<f;d++)for(var e=this.molecules[d],h=0,m=e.atoms.length;h<m;h++)e.atoms[h].add(b);d=0;for(f=this.shapes.length;d<f;d++){e=this.shapes[d].getPoints();h=0;for(m=e.length;h<m;h++)e[h].add(b)}this.specs.scale=1;b=a.maxX-a.minX;
a=a.maxY-a.minY;if(b>this.width||a>this.height)this.specs.scale=0.85*g.min(this.width/b,this.height/a)};b._Canvas.prototype.bondExists=function(a,b){for(var c=0,d=this.molecules.length;c<d;c++)for(var f=this.molecules[c],e=0,g=f.bonds.length;e<g;e++){var h=f.bonds[e];if(h.contains(a)&&h.contains(b))return!0}return!1};b._Canvas.prototype.getBond=function(a,b){for(var c=0,d=this.molecules.length;c<d;c++)for(var f=this.molecules[c],e=0,g=f.bonds.length;e<g;e++){var h=f.bonds[e];if(h.contains(a)&&h.contains(b))return h}};
b._Canvas.prototype.getMoleculeByAtom=function(a){for(var b=0,c=this.molecules.length;b<c;b++){var d=this.molecules[b];if(-1!==q(a,d.atoms))return d}};b._Canvas.prototype.getAllAtoms=function(){for(var a=[],b=0,c=this.molecules.length;b<c;b++)a=a.concat(this.molecules[b].atoms);return a};b._Canvas.prototype.getAllPoints=function(){for(var a=[],b=0,c=this.molecules.length;b<c;b++)a=a.concat(this.molecules[b].atoms);b=0;for(c=this.shapes.length;b<c;b++)a=a.concat(this.shapes[b].getPoints());return a};
b._Canvas.prototype.getContentBounds=function(){for(var b=new a.Bounds,c=0,d=this.molecules.length;c<d;c++)b.expand(this.molecules[c].getBounds());c=0;for(d=this.shapes.length;c<d;c++)b.expand(this.shapes[c].getBounds());return b};b._Canvas.prototype.create=function(a,l,q){this.id=a;this.width=l;this.height=q;this.molecules=[];this.shapes=[];if(o.getElementById(a)){var r=d("#"+a);l?r.attr("width",l):this.width=r.attr("width");q?r.attr("height",q):this.height=r.attr("height");r.attr("class","ChemDoodleWebComponent")}else{if(!b.featureDetection.supports_canvas_text()&&
f.msie&&"6"<=f.version){o.writeln('<div style="border: 1px solid black;" width="'+l+'" height="'+q+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');return}o.writeln('<canvas class="ChemDoodleWebComponent" id="'+a+'" width="'+l+'" height="'+q+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}a=d("#"+a);a.css("width",this.width);a.css("height",this.height);this.pixelRatio=m.devicePixelRatio?
m.devicePixelRatio:1;this.specs=new c.VisualSpecifications;var k=this;e.supports_touch()?(a.bind("touchstart",function(a){var b=(new Date).getTime();if(!e.supports_gesture()&&2===a.originalEvent.touches.length){var d=a.originalEvent.touches,f=new c.Point(d[0].pageX,d[0].pageY),d=new c.Point(d[1].pageX,d[1].pageY);k.implementedGestureDist=f.distance(d);k.implementedGestureAngle=f.angle(d);k.gesturestart&&(k.prehandleEvent(a),k.gesturestart(a))}k.lastTouch&&1===a.originalEvent.touches.length&&500>b-
k.lastTouch?k.dbltap?(k.prehandleEvent(a),k.dbltap(a)):k.dblclick?(k.prehandleEvent(a),k.dblclick(a)):k.touchstart?(k.prehandleEvent(a),k.touchstart(a)):k.mousedown&&(k.prehandleEvent(a),k.mousedown(a)):k.touchstart?(k.prehandleEvent(a),k.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){k.touchhold(a)},1E3))):k.mousedown&&(k.prehandleEvent(a),k.mousedown(a));k.lastTouch=b}),a.bind("touchmove",function(a){this.hold&&(clearTimeout(this.hold),this.hold=
void 0);if(!e.supports_gesture()&&2===a.originalEvent.touches.length&&k.gesturechange){var b=a.originalEvent.touches,d=new c.Point(b[0].pageX,b[0].pageY),f=new c.Point(b[1].pageX,b[1].pageY),b=d.distance(f),d=d.angle(f);a.originalEvent.scale=b/k.implementedGestureDist;a.originalEvent.rotation=180*(k.implementedGestureAngle-d)/g.PI;k.prehandleEvent(a);k.gesturechange(a)}if(1<a.originalEvent.touches.length&&k.multitouchmove){d=a.originalEvent.touches.length;k.prehandleEvent(a);b=new c.Point(-a.offset.left*
d,-a.offset.top*d);for(f=0;f<d;f++)b.x+=a.originalEvent.changedTouches[f].pageX,b.y+=a.originalEvent.changedTouches[f].pageY;b.x/=d;b.y/=d;a.p=b;k.multitouchmove(a,d)}else k.touchmove?(k.prehandleEvent(a),k.touchmove(a)):k.drag&&(k.prehandleEvent(a),k.drag(a))}),a.bind("touchend",function(a){this.hold&&(clearTimeout(this.hold),this.hold=void 0);!e.supports_gesture()&&k.implementedGestureDist&&(k.implementedGestureDist=void 0,k.implementedGestureAngle=void 0,k.gestureend&&(k.prehandleEvent(a),k.gestureend(a)));
k.touchend?(k.prehandleEvent(a),k.touchend(a)):k.mouseup&&(k.prehandleEvent(a),k.mouseup(a));250>(new Date).getTime()-k.lastTouch&&(k.tap?(k.prehandleEvent(a),k.tap(a)):k.click&&(k.prehandleEvent(a),k.click(a)))}),a.bind("gesturestart",function(a){k.gesturestart&&(k.prehandleEvent(a),k.gesturestart(a))}),a.bind("gesturechange",function(a){k.gesturechange&&(k.prehandleEvent(a),k.gesturechange(a))}),a.bind("gestureend",function(a){k.gestureend&&(k.prehandleEvent(a),k.gestureend(a))})):(a.click(function(a){switch(a.which){case 1:k.click&&
(k.prehandleEvent(a),k.click(a));break;case 2:k.middleclick&&(k.prehandleEvent(a),k.middleclick(a));break;case 3:k.rightclick&&(k.prehandleEvent(a),k.rightclick(a))}}),a.dblclick(function(a){k.dblclick&&(k.prehandleEvent(a),k.dblclick(a))}),a.mousedown(function(a){switch(a.which){case 1:h.CANVAS_DRAGGING=k;k.mousedown&&(k.prehandleEvent(a),k.mousedown(a));break;case 2:k.middlemousedown&&(k.prehandleEvent(a),k.middlemousedown(a));break;case 3:k.rightmousedown&&(k.prehandleEvent(a),k.rightmousedown(a))}}),
a.mousemove(function(a){!h.CANVAS_DRAGGING&&k.mousemove&&(k.prehandleEvent(a),k.mousemove(a))}),a.mouseout(function(a){h.CANVAS_OVER=void 0;k.mouseout&&(k.prehandleEvent(a),k.mouseout(a))}),a.mouseover(function(a){h.CANVAS_OVER=k;k.mouseover&&(k.prehandleEvent(a),k.mouseover(a))}),a.mouseup(function(a){switch(a.which){case 1:k.mouseup&&(k.prehandleEvent(a),k.mouseup(a));break;case 2:k.middlemouseup&&(k.prehandleEvent(a),k.middlemouseup(a));break;case 3:k.rightmouseup&&(k.prehandleEvent(a),k.rightmouseup(a))}}),
a.mousewheel(function(a,b){k.mousewheel&&(k.prehandleEvent(a),k.mousewheel(a,b))}));this.subCreate&&this.subCreate()};b._Canvas.prototype.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY);a.preventDefault();a.offset=d("#"+this.id).offset();a.p=new c.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,
jQuery,jQuery.browser,jQuery.inArray,Math,document,window);
(function(b){b._AnimatorCanvas=function(b,a,h){b&&this.create(b,a,h);this.timeout=33;return!0};b._AnimatorCanvas.prototype=new b._Canvas;b._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var b=this;this.nextFrame&&(this.handle=setInterval(function(){var a=(new Date).getTime();b.nextFrame(a-b.lastTime);b.repaint();b.lastTime=a},this.timeout))};b._AnimatorCanvas.prototype.stopAnimation=function(){this.handle&&(clearInterval(this.handle),this.handle=
void 0)};b._AnimatorCanvas.prototype.isRunning=function(){return void 0!==this.handle}})(ChemDoodle);
(function(b,e){b.FileCanvas=function(a,b,c,d){a&&this.create(a,b,c);e.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+d+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+a+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+a+"', "+a+')"></iframe>');this.emptyMessage="Click below to load file";this.repaint();return!0};
b.FileCanvas.prototype=new b._Canvas})(ChemDoodle,document);
(function(b){b.HyperlinkCanvas=function(b,a,h,c,d,f){b&&this.create(b,a,h);this.urlOrFunction=c;this.color=d?d:"blue";this.size=f?f:2;this.openInNewWindow=!0;this.e=this.hoverImage=void 0;return!0};b.HyperlinkCanvas.prototype=new b._Canvas;b.HyperlinkCanvas.prototype.drawChildExtras=function(b){this.e&&(this.hoverImage?b.drawImage(this.hoverImage,0,0):(b.strokeStyle=this.color,b.lineWidth=2*this.size,b.strokeRect(0,0,this.width,this.height)))};b.HyperlinkCanvas.prototype.setHoverImage=function(b){this.hoverImage=
new Image;this.hoverImage.src=b};b.HyperlinkCanvas.prototype.click=function(){this.e=void 0;this.repaint();this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction};b.HyperlinkCanvas.prototype.mouseout=function(){this.e=void 0;this.repaint()};b.HyperlinkCanvas.prototype.mouseover=function(b){this.e=b;this.repaint()}})(ChemDoodle);
(function(b,e,a,h){b.MolGrabberCanvas=function(b,d,f){b&&this.create(b,d,f);d=[];d.push('<br><input type="text" id="');d.push(b);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(b);d.push('_select">');d.push('<option value="chemexper">ChemExper');d.push('<option value="chemspider">ChemSpider');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button id="');d.push(b);d.push('_submit">Show Molecule</button>');d.push("</nobr>");
h.getElementById(b);a("#"+b).after(d.join(""));var e=this;a("#"+b+"_submit").click(function(){e.search()});a("#"+b+"_query").keypress(function(a){13===a.which&&e.search()});this.emptyMessage="Enter search term below";this.repaint();return!0};b.MolGrabberCanvas.prototype=new b._Canvas;b.MolGrabberCanvas.prototype.setSearchTerm=function(b){a("#"+this.id+"_query").val(b);this.search()};b.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...";this.clear();var b=this;e.getMoleculeFromDatabase(a("#"+
this.id+"_query").val(),{database:a("#"+this.id+"_select").val()},function(a){b.loadMolecule(a)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(b,e,a){var h=[],c=[1,0,0],d=[0,1,0],f=[0,0,1];b.RotatorCanvas=function(a,b,c,d){a&&this.create(a,b,c);this.rotate3D=d;this.zIncrement=this.yIncrement=this.xIncrement=a=e.PI/15;return!0};b.RotatorCanvas.prototype=new b._AnimatorCanvas;b.RotatorCanvas.prototype.nextFrame=function(b){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(b/=1E3,this.rotate3D){a.identity(h);a.rotate(h,this.xIncrement*b,c);a.rotate(h,this.yIncrement*b,d);a.rotate(h,this.zIncrement*
b,f);for(var b=0,e=this.molecules.length;b<e;b++){for(var o=this.molecules[b],m=0,j=o.atoms.length;m<j;m++){var l=o.atoms[m],n=[l.x-this.width/2,l.y-this.height/2,l.z];a.multiplyVec3(h,n);l.x=n[0]+this.width/2;l.y=n[1]+this.height/2;l.z=n[2]}m=0;for(j=o.rings.length;m<j;m++)o.rings[m].center=o.rings[m].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&o.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&o.sortBondsByZ()}b=0;for(e=this.shapes.length;b<e;b++){o=
this.shapes[b].getPoints();m=0;for(j=o.length;m<j;m++)l=o[m],n=[l.x-this.width/2,l.y-this.height/2,0],a.multiplyVec3(h,n),l.x=n[0]+this.width/2,l.y=n[1]+this.height/2}}else this.specs.rotateAngle+=this.zIncrement*b};b.RotatorCanvas.prototype.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,mat4);
(function(b,e){b.SlideshowCanvas=function(a,b,c){a&&this.create(a,b,c);this.frames=[];this.curIndex=0;this.timeout=5E3;this.alpha=0;this.innerHandle=void 0;this.phase=0;return!0};b.SlideshowCanvas.prototype=new b._AnimatorCanvas;b.SlideshowCanvas.prototype.drawChildExtras=function(a){var b=e.getRGB(this.specs.backgroundColor,255);a.fillStyle="rgba("+b[0]+", "+b[1]+", "+b[2]+", "+this.alpha+")";a.fillRect(0,0,this.width,this.height)};b.SlideshowCanvas.prototype.nextFrame=function(){if(0===this.frames.length)this.stopAnimation();
else{this.phase=0;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=b/15;a.repaint();15===b&&a.breakInnerHandle();b++},33)}};b.SlideshowCanvas.prototype.breakInnerHandle=function(){this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0);if(0===this.phase){this.curIndex++;this.curIndex>this.frames.length-1&&(this.curIndex=0);this.alpha=1;var a=this.frames[this.curIndex];this.loadContent(a.mols,a.shapes);this.phase=1;var b=this,c=1;this.innerHandle=setInterval(function(){b.alpha=
(15-c)/15;b.repaint();c===15&&b.breakInnerHandle();c++},33)}else 1===this.phase&&(this.alpha=0,this.repaint())};b.SlideshowCanvas.prototype.addFrame=function(a,b){0===this.frames.length&&this.loadContent(a,b);this.frames.push({mols:a,shapes:b})}})(ChemDoodle,ChemDoodle.math);
(function(b,e,a,h,c){b.TransformCanvas=function(a,b,c,e){a&&this.create(a,b,c);this.lastPoint=void 0;this.rotate3D=e;this.rotationMultMod=1.3;this.lastPinchScale=1;this.lastGestureRotate=0;return!0};b.TransformCanvas.prototype=new b._Canvas;b.TransformCanvas.prototype.mousedown=function(a){this.lastPoint=a.p};b.TransformCanvas.prototype.dblclick=function(){this.center();this.repaint()};b.TransformCanvas.prototype.drag=function(b){if(!this.lastPoint.multi){if(e.ALT){var f=new a.Point(b.p.x,b.p.y);
f.sub(this.lastPoint);for(var q=0,g=this.molecules.length;q<g;q++){for(var o=this.molecules[q],m=0,j=o.atoms.length;m<j;m++)o.atoms[m].add(f);o.check()}q=0;for(g=this.shapes.length;q<g;q++){o=this.shapes[q].getPoints();m=0;for(j=o.length;m<j;m++)o[m].add(f)}this.lastPoint=b.p}else if(!0===this.rotate3D){j=h.max(this.width/4,this.height/4);m=(b.p.x-this.lastPoint.x)/j*this.rotationMultMod;j=-(b.p.y-this.lastPoint.y)/j*this.rotationMultMod;f=[];c.identity(f);c.rotate(f,j,[1,0,0]);c.rotate(f,m,[0,1,
0]);q=0;for(g=this.molecules.length;q<g;q++){o=this.molecules[q];m=0;for(j=o.atoms.length;m<j;m++)q=o.atoms[m],g=[q.x-this.width/2,q.y-this.height/2,q.z],c.multiplyVec3(f,g),q.x=g[0]+this.width/2,q.y=g[1]+this.height/2,q.z=g[2];q=0;for(g=o.rings.length;q<g;q++)o.rings[q].center=o.rings[q].getCenter();this.lastPoint=b.p;this.specs.atoms_display&&this.specs.atoms_circles_2D&&o.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&o.sortBondsByZ()}}else m=new a.Point(this.width/
2,this.height/2),j=m.angle(this.lastPoint),this.specs.rotateAngle-=m.angle(b.p)-j,this.lastPoint=b.p;this.repaint()}};b.TransformCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10;0.01>this.specs.scale&&(this.specs.scale=0.01);this.repaint()};b.TransformCanvas.prototype.multitouchmove=function(b,c){if(2===c)if(this.lastPoint.multi){var e=new a.Point(b.p.x,b.p.y);e.sub(this.lastPoint);for(var g=0,h=this.molecules.length;g<h;g++){for(var m=this.molecules[g],j=0,l=m.atoms.length;j<l;j++)m.atoms[j].add(e);
m.check()}g=0;for(h=this.shapes.length;g<h;g++){m=this.shapes[g].getPoints();j=0;for(l=m.length;j<l;j++)m[j].add(e)}this.lastPoint=b.p;this.lastPoint.multi=!0;this.repaint()}else this.lastPoint=b.p,this.lastPoint.multi=!0};b.TransformCanvas.prototype.gesturechange=function(b){0!==b.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=b.originalEvent.scale/this.lastPinchScale,0.01>this.specs.scale&&(this.specs.scale=0.01),this.lastPinchScale=b.originalEvent.scale);if(0!==this.lastGestureRotate-
b.originalEvent.rotation){for(var c=(this.lastGestureRotate-b.originalEvent.rotation)/180*m.PI,e=new a.Point(this.width/2,this.height/2),g=0,h=this.molecules.length;g<h;g++){for(var m=this.molecules[g],j=0,l=m.atoms.length;j<l;j++){var n=m.atoms[j],r=e.distance(n),k=e.angle(n)+c;n.x=e.x+r*m.cos(k);n.y=e.y-r*m.sin(k)}m.check()}this.lastGestureRotate=b.originalEvent.rotation}this.repaint()};b.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,
ChemDoodle.monitor,ChemDoodle.structures,Math,mat4);(function(b){b.ViewerCanvas=function(b,a,h){b&&this.create(b,a,h);return!0};b.ViewerCanvas.prototype=new b._Canvas})(ChemDoodle);
(function(b){b._SpectrumCanvas=function(b,a,h){b&&this.create(b,a,h);this.spectrum=void 0;this.emptyMessage="No Spectrum Loaded or Recognized";this.getMolecule=this.loadMolecule=void 0;return!0};b._SpectrumCanvas.prototype=new b._Canvas;b._SpectrumCanvas.prototype.innerRepaint=function(b){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(b,this.specs,this.width,this.height):this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",
b.fillText(this.emptyMessage,this.width/2,this.height/2))};b._SpectrumCanvas.prototype.loadSpectrum=function(b){this.spectrum=b;this.repaint()};b._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum};b._SpectrumCanvas.prototype.getSpectrumCoordinates=function(b,a){return spectrum.getInternalCoordinates(b,a,this.width,this.height)}})(ChemDoodle,document);(function(b){b.ObserverCanvas=function(b,a,h){b&&this.create(b,a,h);return!0};b.ObserverCanvas.prototype=new b._SpectrumCanvas})(ChemDoodle);
(function(b){b.OverlayCanvas=function(b,a,h){b&&this.create(b,a,h);this.overlaySpectra=[];return!0};b.OverlayCanvas.prototype=new b._SpectrumCanvas;b.OverlayCanvas.prototype.superRepaint=b.OverlayCanvas.prototype.innerRepaint;b.OverlayCanvas.prototype.innerRepaint=function(b){this.superRepaint(b);if(this.spectrum&&0<this.spectrum.data.length)for(var a=0,h=this.overlaySpectra.length;a<h;a++){var c=this.overlaySpectra[a];c&&0<c.data.length&&(c.minX=this.spectrum.minX,c.maxX=this.spectrum.maxX,c.drawPlot(b,
this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}};b.OverlayCanvas.prototype.addSpectrum=function(b){this.spectrum?this.overlaySpectra.push(b):this.spectrum=b}})(ChemDoodle);
(function(b,e,a){b.PerspectiveCanvas=function(a,b,d){a&&this.create(a,b,d);this.dragRange=void 0;this.rescaleYAxisOnZoom=!0;this.lastPinchScale=1;return!0};b.PerspectiveCanvas.prototype=new b._SpectrumCanvas;b.PerspectiveCanvas.prototype.mousedown=function(a){this.dragRange=new b.structures.Point(a.p.x,a.p.x)};b.PerspectiveCanvas.prototype.mouseup=function(a){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(a=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),
this.rescaleYAxisOnZoom&&(this.specs.scale=a)),this.dragRange=void 0,this.repaint())};b.PerspectiveCanvas.prototype.drag=function(a){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(e.SHIFT&&(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x),this.dragRange.y=a.p.x),this.repaint())};b.PerspectiveCanvas.prototype.drawChildExtras=function(b){if(this.dragRange){var c=a.min(this.dragRange.x,this.dragRange.y),d=a.max(this.dragRange.x,this.dragRange.y);b.strokeStyle=
"gray";b.lineStyle=1;b.beginPath();for(b.moveTo(c,this.height/2);c<=d;c++)5>c%10?b.lineTo(c,a.round(this.height/2)):b.moveTo(c,a.round(this.height/2));b.stroke()}};b.PerspectiveCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10;0.01>this.specs.scale&&(this.specs.scale=0.01);this.repaint()};b.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup();this.specs.scale=1;this.repaint()};b.PerspectiveCanvas.prototype.multitouchmove=function(a,c){2===c&&(!this.dragRange||!this.dragRange.multi?
(this.dragRange=new b.structures.Point(a.p.x,a.p.x),this.dragRange.multi=!0):(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x,this.dragRange.y=a.p.x,this.repaint()))};b.PerspectiveCanvas.prototype.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale;0.01>this.specs.scale&&(this.specs.scale=0.01);this.lastPinchScale=a.originalEvent.scale;this.repaint()};b.PerspectiveCanvas.prototype.gestureend=function(){this.lastPinchScale=1}})(ChemDoodle,
ChemDoodle.monitor,Math);
(function(b,e){b.SeekerCanvas=function(a,b,c,d){a&&this.create(a,b,c);this.seekType=d;this.p=void 0;return!0};b.SeekerCanvas.prototype=new b._SpectrumCanvas;b.SeekerCanvas.prototype.superRepaint=b.SeekerCanvas.prototype.innerRepaint;b.SeekerCanvas.prototype.innerRepaint=function(a){this.superRepaint(a);if(this.spectrum&&0<this.spectrum.data.length&&this.p){var h,c;if(this.seekType===b.SeekerCanvas.SEEK_POINTER)h=this.p,c=this.spectrum.getInternalCoordinates(h.x,h.y);else if(this.seekType===b.SeekerCanvas.SEEK_PLOT||
this.seekType===b.SeekerCanvas.SEEK_PEAK){c=this.seekType===b.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x);if(!c)return;h={x:this.spectrum.getTransformedX(c.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(c.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}a.fillStyle="white";a.strokeStyle=this.specs.plots_color;a.lineWidth=
this.specs.plots_width;a.beginPath();a.arc(h.x,h.y,3,0,2*e.PI,!1);a.fill();a.stroke();a.font=this.specs.getFontString(this.specs.text_font_size,this.specs.text_font_families);a.textAlign="left";a.textBaseline="bottom";c="x:"+c.x.toFixed(3)+", y:"+c.y.toFixed(3);var d=h.x+3,f=a.measureText(c).width;d+f>this.width-2&&(d-=6+f);h=h.y;0>h-this.specs.text_font_size-2&&(h+=this.specs.text_font_size);a.fillRect(d,h-this.specs.text_font_size,f,this.specs.text_font_size);a.fillStyle="black";a.fillText(c,d,
h)}};b.SeekerCanvas.prototype.mouseout=function(){this.p=void 0;this.repaint()};b.SeekerCanvas.prototype.mousemove=function(a){this.p={x:a.p.x-2,y:a.p.y-3};this.repaint()};b.SeekerCanvas.prototype.touchstart=function(a){this.mousemove(a)};b.SeekerCanvas.prototype.touchmove=function(a){this.mousemove(a)};b.SeekerCanvas.prototype.touchend=function(a){this.mouseout(a)};b.SeekerCanvas.SEEK_POINTER="pointer";b.SeekerCanvas.SEEK_PLOT="plot";b.SeekerCanvas.SEEK_PEAK="peak"})(ChemDoodle,Math);
(function(b,e,a,h,c,d,f,q,g,o,m){b._Canvas3D=function(a,b,c){a&&this.create(a,b,c);this.rotationMatrix=g.identity([]);this.translationMatrix=g.identity([]);this.lastPoint=void 0;this.emptyMessage="WebGL is Unavailable!";return!0};b._Canvas3D.prototype=new b._Canvas;b._Canvas3D.prototype.afterLoadContent=function(){for(var b=new a.Bounds,c=0,d=this.molecules.length;c<d;c++)b.expand(this.molecules[c].getBounds());this.maxDimension=f.max(b.maxX-b.minX,b.maxY-b.minY);this.translationMatrix=g.translate(g.identity([]),
[0,0,-this.maxDimension-10]);this.setupScene()};b._Canvas3D.prototype.setViewDistance=function(a){this.translationMatrix=g.translate(g.identity([]),[0,0,-a])};b._Canvas3D.prototype.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.modelViewMatrix=g.multiply(this.translationMatrix,this.rotationMatrix,[]);this.gl.rotationMatrix=this.rotationMatrix;for(var a=0,b=this.molecules.length;a<b;a++)this.molecules[a].render(this.gl,this.specs);a=0;for(b=
this.shapes.length;a<b;a++)this.shapes[a].render(this.gl,this.specs);this.gl.flush()}};b._Canvas3D.prototype.center=function(){q.getElementById(this.id);for(var a=new h.Atom,b=0,c=this.molecules.length;b<c;b++){var d=this.molecules[b];a.add3D(d.getCenter3D())}a.x/=this.molecules.length;a.y/=this.molecules.length;b=0;for(c=this.molecules.length;b<c;b++){for(var d=this.molecules[b],f=0,e=d.atoms.length;f<e;f++)d.atoms[f].sub3D(a);if(d.chains&&d.fromJSON){f=0;for(e=d.chains.length;f<e;f++)for(var g=
d.chains[f],m=0,o=g.length;m<o;m++){var w=g[m];w.cp1.sub3D(a);w.cp2.sub3D(a);w.cp3&&(w.cp3.sub3D(a),w.cp4.sub3D(a),w.cp5.sub3D(a))}}}};b._Canvas3D.prototype.subCreate=function(){try{var a=q.getElementById(this.id);this.gl=a.getContext("webgl");this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?(this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new c.Shader,this.gl.shader.init(this.gl),this.setupScene()):this.displayMessage()};
b._Canvas.prototype.displayMessage=function(){var a=q.getElementById(this.id);if(a.getContext&&(a=a.getContext("2d"),this.specs.backgroundColor&&(a.fillStyle=this.specs.backgroundColor,a.fillRect(0,0,this.width,this.height)),this.emptyMessage))a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2)};b._Canvas3D.prototype.setupScene=function(){if(this.gl){var b=a.getRGB(this.specs.backgroundColor,
1);this.gl.clearColor(b[0],b[1],b[2],1);this.gl.clearDepth(1);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.sphereBuffer=new c.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D);this.gl.starBuffer=new c.Star;this.gl.cylinderBuffer=new c.Cylinder(1,1,this.specs.bonds_resolution_3D);this.gl.lineBuffer=new c.Line;for(var b=0,h=this.molecules.length;b<h;b++){var q=this.molecules[b];q.unitCellVectors&&(q.unitCell=new c.UnitCell(q.unitCellVectors));if(q.chains){q.ribbons=
[];q.cartoons=[];q.tubes=[];for(var r=0,k=q.chains.length;r<k;r++){var v=q.chains[r],x=2<v.length&&d[v[2].name]&&"#BEA06E"===d[v[2].name].aminoColor;if(0<v.length&&!v[0].lineSegments){for(var t=0,y=v.length-1;t<y;t++)v[t].setup(v[t+1].cp1,x?1:this.specs.proteins_horizontalResolution);if(!x){t=1;for(y=v.length-1;t<y;t++)e.vec3AngleFrom(v[t-1].D,v[t].D)>f.PI/2&&(v[t].guidePointsSmall.reverse(),v[t].guidePointsLarge.reverse(),m.scale(v[t].D,-1))}t=1;for(y=v.length-3;t<y;t++)v[t].computeLineSegments(v[t-
1],v[t+1],v[t+2],!x,x?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);v.pop();v.pop();v.pop();v.shift()}var w=a.hsl2rgb(1===k?0.5:r/k,1,0.5),w="rgb("+w[0]+","+w[1]+","+w[2]+")";v.chainColor=w;if(x)v=new c.Tube(v,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D),v.chainColor=w,q.tubes.push(v);else{x={front:new c.Ribbon(v,this.specs.proteins_ribbonThickness,!1),back:new c.Ribbon(v,-this.specs.proteins_ribbonThickness,!1)};x.front.chainColor=w;x.back.chainColor=
w;t=0;for(y=x.front.segments.length;t<y;t++)x.front.segments[t].chainColor=w;t=0;for(y=x.back.segments.length;t<y;t++)x.back.segments[t].chainColor=w;q.ribbons.push(x);v={front:new c.Ribbon(v,this.specs.proteins_ribbonThickness,!0),back:new c.Ribbon(v,-this.specs.proteins_ribbonThickness,!0)};v.front.chainColor=w;v.back.chainColor=w;t=0;for(y=v.front.segments.length;t<y;t++)v.front.segments[t].chainColor=w;t=0;for(y=v.back.segments.length;t<y;t++)v.back.segments[t].chainColor=w;t=0;for(y=v.front.cartoonSegments.length;t<
y;t++)v.front.cartoonSegments[t].chainColor=w;t=0;for(y=v.back.cartoonSegments.length;t<y;t++)v.back.cartoonSegments[t].chainColor=w;q.cartoons.push(v)}}}}this.gl.lighting=new c.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D);this.gl.lighting.lightScene(this.gl);this.gl.material=new c.Material(this.gl);b=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(b=this.specs.projectionWidthHeightRatio_3D);this.gl.projectionMatrix=this.specs.projectionPerspective_3D?
g.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,b,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):g.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/b,this.specs.projectionOrthoWidth_3D/2/b,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),!1,this.gl.projectionMatrix);
var u=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),p=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(u,false,a);a=o.transpose(g.toInverseMat3(a,[]));this.uniformMatrix3fv(p,false,a)}}};b._Canvas3D.prototype.mousedown=function(a){this.lastPoint=a.p};b._Canvas3D.prototype.rightmousedown=function(a){this.lastPoint=a.p};b._Canvas3D.prototype.drag=function(a){if(b.monitor.ALT){var c=new h.Point(a.p.x,a.p.y);
c.sub(this.lastPoint);g.translate(this.translationMatrix,[c.x/20,-c.y/20,0])}else{var d=a.p.x-this.lastPoint.x,c=a.p.y-this.lastPoint.y,d=g.rotate(g.identity([]),d*f.PI/180,[0,1,0]);g.rotate(d,c*f.PI/180,[1,0,0]);this.rotationMatrix=g.multiply(d,this.rotationMatrix)}this.lastPoint=a.p;this.repaint()};b._Canvas3D.prototype.mousewheel=function(a,b){var c=b*this.maxDimension/8;this.specs.projectionPerspective_3D?g.translate(this.translationMatrix,[0,0,c]):(this.specs.projectionOrthoWidth_3D-=c,this.setupScene());
this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,mat4,mat3,vec3,window);
(function(b,e,a,h){b.MolGrabberCanvas3D=function(b,d,f){b&&this.create(b,d,f);d=[];d.push('<br><input type="text" id="');d.push(b);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(b);d.push('_select">');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button id="');d.push(b);d.push('_submit">Show Molecule</button>');d.push("</nobr>");h.writeln(d.join(""));var e=this;a("#"+b+"_submit").click(function(){e.search()});a("#"+b+"_query").keypress(function(a){13===
a.which&&e.search()});return!0};b.MolGrabberCanvas3D.prototype=new b._Canvas3D;b.MolGrabberCanvas3D.prototype.setSearchTerm=function(b){a("#"+this.id+"_query").val(b);this.search()};b.MolGrabberCanvas3D.prototype.search=function(){var b=this;e.getMoleculeFromDatabase(a("#"+this.id+"_query").val(),{database:a("#"+this.id+"_select").val(),dimension:3},function(a){b.loadMolecule(a)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(b,e){b.MovieCanvas3D=function(a,b,c){a&&this.create(a,b,c);this.timeout=50;this.frames=[];this.frameNumber=0;this.playMode=2;this.reverse=!1;return!0};b.MovieCanvas3D.PLAY_ONCE=0;b.MovieCanvas3D.PLAY_LOOP=1;b.MovieCanvas3D.PLAY_SPRING=2;b.MovieCanvas3D.prototype=new b._Canvas3D;b.MovieCanvas3D.prototype.startAnimation=b._AnimatorCanvas.prototype.startAnimation;b.MovieCanvas3D.prototype.stopAnimation=b._AnimatorCanvas.prototype.stopAnimation;b.MovieCanvas3D.prototype.isRunning=b._AnimatorCanvas.prototype.isRunning;
b.MovieCanvas3D.prototype.dblclick=b.RotatorCanvas.prototype.dblclick;b.MovieCanvas3D.prototype.nextFrame=function(){var a=this.frames[this.frameNumber];this.molecules=a.mols;this.shapes=a.shapes;2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))};b.MovieCanvas3D.prototype.center=
function(){for(var a=new e.Atom,b=this.frames[0],c=0,d=b.mols.length;c<d;c++)a.add3D(b.mols[c].getCenter3D());a.x/=b.mols.length;a.y/=b.mols.length;b=new e.Atom;b.sub3D(a);for(var a=0,f=this.frames.length;a<f;a++)for(var q=this.frames[a],c=0,d=q.mols.length;c<d;c++)for(var g=q.mols[c],o=0,m=g.atoms.length;o<m;o++)g.atoms[o].add3D(b)};b.MovieCanvas3D.prototype.addFrame=function(a,b){this.frames.push({mols:a,shapes:b})}})(ChemDoodle,ChemDoodle.structures);
(function(b,e,a){var h=[],c=[1,0,0],d=[0,1,0],f=[0,0,1];b.RotatorCanvas3D=function(a,b,c){a&&this.create(a,b,c);this.timeout=33;this.zIncrement=this.yIncrement=this.xIncrement=a=e.PI/15;return!0};b.RotatorCanvas3D.prototype=new b._Canvas3D;b.RotatorCanvas3D.prototype.startAnimation=b._AnimatorCanvas.prototype.startAnimation;b.RotatorCanvas3D.prototype.stopAnimation=b._AnimatorCanvas.prototype.stopAnimation;b.RotatorCanvas3D.prototype.isRunning=b._AnimatorCanvas.prototype.isRunning;b.RotatorCanvas3D.prototype.dblclick=
b.RotatorCanvas.prototype.dblclick;b.RotatorCanvas3D.prototype.mousedown=void 0;b.RotatorCanvas3D.prototype.rightmousedown=void 0;b.RotatorCanvas3D.prototype.drag=void 0;b.RotatorCanvas3D.prototype.mousewheel=void 0;b.RotatorCanvas3D.prototype.nextFrame=function(b){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(a.identity(h),b/=1E3,a.rotate(h,this.xIncrement*b,c),a.rotate(h,this.yIncrement*b,d),a.rotate(h,this.zIncrement*b,f),a.multiply(this.rotationMatrix,h))}})(ChemDoodle,
Math,mat4);(function(b){b.TransformCanvas3D=function(b,a,h){b&&this.create(b,a,h);return!0};b.TransformCanvas3D.prototype=new b._Canvas3D})(ChemDoodle);(function(b){b.ViewerCanvas3D=function(b,a,h){b&&this.create(b,a,h);return!0};b.ViewerCanvas3D.prototype=new b._Canvas3D;b.ViewerCanvas3D.prototype.mousedown=void 0;b.ViewerCanvas3D.prototype.rightmousedown=void 0;b.ViewerCanvas3D.prototype.drag=void 0;b.ViewerCanvas3D.prototype.mousewheel=void 0})(ChemDoodle);
(function(b,e,a){function h(a,b,f,e){this.element=a;this.x=b;this.y=f;this.dimension=e}b.PeriodicTableCanvas=function(a,b){this.padding=5;a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding);this.getMolecule=this.loadMolecule=void 0;this.cellDimension=b?b:20;this.setupTable();this.repaint();return!0};b.PeriodicTableCanvas.prototype=new b._Canvas;b.PeriodicTableCanvas.prototype.getHoveredElement=function(){if(this.hovered)return this.hovered.element};b.PeriodicTableCanvas.prototype.innerRepaint=
function(a){for(var b=0,f=this.cells.length;b<f;b++)this.drawCell(a,this.specs,this.cells[b]);this.hovered&&this.drawCell(a,this.specs,this.hovered);this.selected&&this.drawCell(a,this.specs,this.selected)};b.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var a=this.padding,d=this.padding,f=0,e=0,g=b.SYMBOLS.length;e<g;e++){18===f&&(f=0,d+=this.cellDimension,a=this.padding);var o=b.ELEMENT[b.SYMBOLS[e]];if(2===o.atomicNumber)a+=16*this.cellDimension,f+=16;else if(5===o.atomicNumber||
13===o.atomicNumber)a+=10*this.cellDimension,f+=10;if((58>o.atomicNumber||71<o.atomicNumber&&90>o.atomicNumber||103<o.atomicNumber)&&113>o.atomicNumber)this.cells.push(new h(o,a,d,this.cellDimension)),a+=this.cellDimension,f++}d+=2*this.cellDimension;a=3*this.cellDimension+this.padding;for(e=57;104>e;e++)if(o=b.ELEMENT[b.SYMBOLS[e]],90===o.atomicNumber&&(d+=this.cellDimension,a=3*this.cellDimension+this.padding),58<=o.atomicNumber&&71>=o.atomicNumber||90<=o.atomicNumber&&103>=o.atomicNumber)this.cells.push(new h(o,
a,d,this.cellDimension)),a+=this.cellDimension};b.PeriodicTableCanvas.prototype.drawCell=function(a,b,f){var h=a.createRadialGradient(f.x+f.dimension/3,f.y+f.dimension/3,1.5*f.dimension,f.x+f.dimension/3,f.y+f.dimension/3,f.dimension/10);h.addColorStop(0,"#000000");h.addColorStop(0.7,f.element.jmolColor);h.addColorStop(1,"#FFFFFF");a.fillStyle=h;e.contextRoundRect(a,f.x,f.y,f.dimension,f.dimension,f.dimension/8);if(f===this.hovered||f===this.selected)a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),
a.fillStyle="white";a.fill();a.font=b.getFontString(b.text_font_size,b.text_font_families);a.fillStyle=b.text_color;a.textAlign="center";a.textBaseline="middle";a.fillText(f.element.symbol,f.x+f.dimension/2,f.y+f.dimension/2)};b.PeriodicTableCanvas.prototype.click=function(){this.hovered&&(this.selected=this.hovered,this.repaint())};b.PeriodicTableCanvas.prototype.mousemove=function(b){var d=b.p.x,b=b.p.y;this.hovered=void 0;for(var f=0,e=this.cells.length;f<e;f++){var g=this.cells[f];if(a.isBetween(d,
g.x,g.x+g.dimension)&&a.isBetween(b,g.y,g.y+g.dimension)){this.hovered=g;break}}this.repaint()};b.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=void 0;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);(function(b,e){b._Layout=function(){return!0};b._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()};b._Layout.prototype.create=function(a){this.name=a;this.specs=new e.VisualSpecifications}})(ChemDoodle,ChemDoodle.structures);
(function(b,e,a){b.SimpleReactionLayout=function(a){this.reactants=[];this.products=[];this.textBelow=this.textAbove=void 0;this.arrow="&rarr;";this.plus="+";this.create(a);return!0};b.SimpleReactionLayout.prototype=new b._Layout;b.SimpleReactionLayout.prototype.addReactant=function(a){this.reactants.push(a)};b.SimpleReactionLayout.prototype.addProduct=function(a){this.products.push(a)};b.SimpleReactionLayout.prototype.innerLayout=function(){var b=[];b.push("<table><tr>");for(var c=0,d=this.reactants.length;c<
d;c++){0<c&&(b.push("<td>"),b.push('<span style="font-size:25px;">'),b.push(this.plus),b.push("</span></td>"));b.push("<td>");var f=this.reactants[c].getDimension();b.push('<canvas class="ChemDoodleWebComponent" id="');b.push(this.name);b.push("_reactant");b.push(c);b.push('" width="');b.push(f.x+60);b.push('" height="');b.push(f.y+60);b.push('"></canvas>');b.push("</td>")}b.push("<td>");b.push("<table>");b.push("<tr><td>");this.textAbove?(b.push("<center>"),b.push(this.textAbove),b.push("</center>")):
b.push("&nbsp;");b.push("</td></tr>");b.push("<tr><td><center>");b.push('<span style="font-size:25px;">');b.push(this.arrow);b.push("</span></center></td></tr>");b.push("<tr><td>");this.textBelow?(b.push("<center>"),b.push(this.textBelow),b.push("</center>")):b.push("&nbsp;");b.push("</td></tr>");b.push("</table>");b.push("</td>");c=0;for(d=this.products.length;c<d;c++)0<c&&(b.push("<td>"),b.push('<span style="font-size:25px;">'),b.push(this.plus),b.push("</td>")),b.push("<td>"),f=this.products[c].getDimension(),
b.push('<canvas class="ChemDoodleWebComponent" id="'),b.push(this.name),b.push("_product"),b.push(c),b.push('" width="'),b.push(f.x+60),b.push('" height="'),b.push(f.y+60),b.push('"></canvas>'),b.push("</td>");b.push("</tr></table>");a.getElementById(this.name)?e("#"+this.name).append(b.join("")):a.writeln(b.join(""));c=0;for(d=this.reactants.length;c<d;c++)b=new ChemDoodle.ViewerCanvas(this.name+"_reactant"+c),this.specs.backgroundColor||e("#"+this.name+"_reactant"+c).css("border","0px"),b.specs=
this.specs,b.loadMolecule(this.reactants[c]);c=0;for(d=this.products.length;c<d;c++)b=new ChemDoodle.ViewerCanvas(this.name+"_product"+c),this.specs.backgroundColor||e("#"+this.name+"_product"+c).css("border","0px"),b.specs=this.specs,b.loadMolecule(this.products[c])}})(ChemDoodle,jQuery,document);(function(b,e,a){b.png={};b.png.create=function(b){a.open(e.getElementById(b.id).toDataURL("image/png"))}})(ChemDoodle.io,document,window);
(function(b,e){b.file={};b.file.content=function(a,b){e.get(a,"",b)}})(ChemDoodle.io,jQuery);
(function(b,e,a,h,c){e.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/icl_cdc_v050000/WebHQ";e.inRelay=!1;e.asynchronous=!0;e.INFO={userAgent:navigator.userAgent,v_cwc:b.getVersion(),v_jQuery:c.version,v_jQuery_ui:c.ui?c.ui.version:"N/A"};var d=new a.JSONInterpreter;e._contactServer=function(a,b,d,h,m){this.inRelay?alert("Already connecting to the server, please wait for the first request to finish."):(e.inRelay=!0,c.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:b,options:d,
info:e.INFO}),url:this.SERVER_URL,success:function(a){e.inRelay=!1;a=JSON.parse(a);a.message&&alert(a.message);h&&a.content&&!a.stop&&h(a.content);a.stop&&m&&m()},error:function(){e.inRelay=!1;alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support.");m&&m()},xhrFields:{withCredentials:!0},async:e.asynchronous}))};e.authenticate=function(a,b,c,d){this._contactServer("authenticate",{credential:a},b,function(a){c(a)},d)};e.calculate=function(a,
b,c,e){this._contactServer("calculate",{mol:d.molTo(a)},b,function(a){c(a)},e)};e.generateImage=function(a,b,c,e){this._contactServer("generateImage",{mol:d.molTo(a)},b,function(a){c(a.link)},e)};e.getAd=function(a,b){this._contactServer("getAd",{},{},function(b){a(b.image_url,b.target_url)},b)};e.getMoleculeFromContent=function(a,b,c,e){this._contactServer("getMoleculeFromContent",{content:a},b,function(a){for(var b=!1,f=0,e=a.mol.a.length;f<e;f++)if(0!==a.mol.a[f].z){b=!0;break}if(b){f=0;for(e=
a.mol.a.length;f<e;f++)a.mol.a[f].x/=20,a.mol.a[f].y/=20,a.mol.a[f].z/=20}c(d.molFrom(a.mol))},e)};e.getMoleculeFromDatabase=function(a,b,c,e){this._contactServer("getMoleculeFromDatabase",{query:a},b,function(a){if(3===b.dimension)for(var f=0,e=a.mol.a.length;f<e;f++)a.mol.a[f].x/=20,a.mol.a[f].y/=-20,a.mol.a[f].z/=20;c(d.molFrom(a.mol))},e)};e.getOptimizedPDBStructure=function(a,b,c,e){this._contactServer("getOptimizedPDBStructure",{id:a},b,function(a){var b;b=a.mol?d.molFrom(a.mol):new h.Molecule;
b.chains=d.chainsFrom(a.ribbons);b.fromJSON=!0;c(b)},e)};e.getZeoliteFromIZA=function(a,b,c,d){this._contactServer("getZeoliteFromIZA",{query:a},b,function(a){c(ChemDoodle.readCIF(a.cif,b.xSuper,b.ySuper,b.zSuper))},d)};e.isGraphIsomorphism=function(a,b,c,e,h){this._contactServer("isGraphIsomorphism",{arrow:d.molTo(a),target:d.molTo(b)},c,function(a){e(a.value)},h)};e.isSubgraphIsomorphism=function(a,b,c,e,h){this._contactServer("isSubgraphIsomorphism",{arrow:d.molTo(a),target:d.molTo(b)},c,function(a){e(a.value)},
h)};e.kekulize=function(a,b,c,e){this._contactServer("kekulize",{mol:d.molTo(a)},b,function(a){c(d.molFrom(a.mol))},e)};e.optimize=function(a,b,c,e){this._contactServer("optimize",{mol:d.molTo(a)},b,function(e){e=d.molFrom(e.mol);if(2===b.dimension){for(var h=0,l=e.atoms.length;h<l;h++)a.atoms[h].x=e.atoms[h].x,a.atoms[h].y=e.atoms[h].y;c()}else if(3===b.dimension){h=0;for(l=e.atoms.length;h<l;h++)e.atoms[h].x/=20,e.atoms[h].y/=-20,e.atoms[h].z/=20;c(e)}},e)};e.readIUPACName=function(a,b,c,e){this._contactServer("readIUPACName",
{iupac:a},b,function(a){c(d.molFrom(a.mol))},e)};e.readSMILES=function(a,b,c,e){this._contactServer("readSMILES",{smiles:a},b,function(a){c(d.molFrom(a.mol))},e)};e.saveFile=function(a,b,c,e){this._contactServer("saveFile",{mol:d.molTo(a)},b,function(a){c(a.link)},e)};e.simulate13CNMR=function(a,c,e,h){c.nucleus="C";c.isotope=13;this._contactServer("simulateNMR",{mol:d.molTo(a)},c,function(a){e(b.readJCAMP(a.jcamp))},h)};e.simulate1HNMR=function(a,c,e,h){c.nucleus="H";c.isotope=1;this._contactServer("simulateNMR",
{mol:d.molTo(a)},c,function(a){e(b.readJCAMP(a.jcamp))},h)};e.simulateMassParentPeak=function(a,c,e,h){this._contactServer("simulateMassParentPeak",{mol:d.molTo(a)},c,function(a){e(b.readJCAMP(a.jcamp))},h)};e.writeSMILES=function(a,b,c,e){this._contactServer("writeSMILES",{mol:d.molTo(a)},b,function(a){c(a.smiles)},e)}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery);
